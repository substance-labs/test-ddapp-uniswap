import{createSlice as u}from"./redux-toolkit.esm-BnRUBto_.js";function l(e){var r;return`${e.address??""}:${((r=e.topics)===null||r===void 0?void 0:r.map(o=>o?Array.isArray(o)?o.join(";"):o:"\0").join("-"))??""}:${e.fromBlock??""}:${e.toBlock??""}`}function g(e){const r=e.split(":"),o=r[0],t=r[1].split("-").map(i=>{if(i==="\0")return null;const c=i.split(";");return c.length===1?c[0]:c}),n=r[2],s=r[3];return{address:o.length===0?void 0:o,topics:t,fromBlock:n.length===0?void 0:n,toBlock:s.length===0?void 0:s}}function d(e,r){if(!e.toBlock)return!1;let o=e.toBlock;return typeof o=="string"&&(o=Number.parseInt(o)),o<=r}const f=u({name:"logs",initialState:{},reducers:{addListener(e,{payload:{chainId:r,filter:o}}){e[r]||(e[r]={});const t=l(o);e[r][t]?e[r][t].listeners++:e[r][t]={listeners:1}},fetchingLogs(e,{payload:{chainId:r,filters:o,blockNumber:t}}){if(e[r])for(const n of o){const s=l(n);e[r][s]&&(e[r][s].fetchingBlockNumber=t)}},fetchedLogs(e,{payload:{chainId:r,filter:o,results:t}}){if(!e[r])return;const n=l(o),s=e[r][n];!s||s.results&&s.results.blockNumber>t.blockNumber||(s.results=t)},fetchedLogsError(e,{payload:{chainId:r,filter:o,blockNumber:t}}){if(!e[r])return;const n=l(o),s=e[r][n];!s||s.results&&s.results.blockNumber>t||(s.results={blockNumber:t,error:!0})},removeListener(e,{payload:{chainId:r,filter:o}}){if(!e[r])return;const t=l(o);e[r][t]&&e[r][t].listeners--}}});var p=f.reducer;const{fetchedLogs:y,fetchedLogsError:m,fetchingLogs:a}=f.actions;export{y as fetchedLogs,m as fetchedLogsError,a as fetchingLogs,d as isHistoricalLog,g as keyToFilter,p as slice_default};
