import{__toESM as N}from"./chunk-DgAfPHQg.js";import{require_react as je}from"./react-CNoFhWkx.js";import{StyleSheet_default as Be,TextInputState_default as R,accessibilityProps as We,clickProps as qe,createElement_default as Ge,defaultProps as Ue,focusProps as Je,getButtonSized as ee,getFontSized as te,getLocaleDirection as Qe,getSpace as M,keyboardProps as Xe,mouseProps as Ye,pick as Ze,registerFocusable as Ne,styleProps as et,touchProps as tt,useElementLayout as nt,useEvent as ot,useLayoutEffect_default as rt,useLocaleContext as lt,useMergeRefs as at,usePlatformMethods as ut,useResponderEvents as it}from"./src-DOOtfpHS.js";import{require_jsx_runtime as ct}from"./jsx-runtime-D7bMTQeG.js";import{composeRefs as dt,getVariableValue as st,isWeb as ne,styled as ft,useComposedRefs as ht,useTheme as vt}from"./Loader-D83W8G1W.js";var d=N(je()),St=(e,n)=>{var o=e.selectionEnd,a=e.selectionStart,r=n.start,h=n.end;return r!==a||h!==o},Y=(e,n)=>{if(St(e,n)){var o=n.start,a=n.end;try{e.setSelectionRange(o,a||o)}catch{}}},mt=Object.assign({},Ue,We,qe,Je,Xe,Ye,tt,et,{autoCapitalize:!0,autoComplete:!0,autoCorrect:!0,autoFocus:!0,defaultValue:!0,disabled:!0,lang:!0,maxLength:!0,onChange:!0,onScroll:!0,placeholder:!0,pointerEvents:!0,readOnly:!0,rows:!0,spellCheck:!0,value:!0,type:!0}),Ct=e=>Ze(e,mt);function bt(e){return e.isComposing||e.keyCode===229}var w=null,L=d.forwardRef((e,n)=>{var o=e.autoCapitalize,a=o===void 0?"sentences":o,r=e.autoComplete,h=e.autoCompleteType,S=e.autoCorrect,f=S===void 0?!0:S,c=e.blurOnSubmit,E=e.caretHidden,k=e.clearTextOnFocus,i=e.dir,y=e.editable,oe=e.enterKeyHint,b=e.inputMode,H=e.keyboardType,I=e.multiline,m=I===void 0?!1:I,re=e.numberOfLines,D=e.onBlur,K=e.onChange,V=e.onChangeText,F=e.onContentSizeChange,A=e.onFocus,j=e.onKeyPress,le=e.onLayout,ae=e.onMoveShouldSetResponder,ue=e.onMoveShouldSetResponderCapture,ie=e.onResponderEnd,ce=e.onResponderGrant,de=e.onResponderMove,se=e.onResponderReject,fe=e.onResponderRelease,he=e.onResponderStart,ve=e.onResponderTerminate,Se=e.onResponderTerminationRequest,me=e.onScrollShouldSetResponder,Ce=e.onScrollShouldSetResponderCapture,B=e.onSelectionChange,be=e.onSelectionChangeShouldSetResponder,ge=e.onSelectionChangeShouldSetResponderCapture,ye=e.onStartShouldSetResponder,pe=e.onStartShouldSetResponderCapture,W=e.onSubmitEditing,Re=e.placeholderTextColor,q=e.readOnly,xe=q===void 0?!1:q,Te=e.returnKeyType,G=e.rows,U=e.secureTextEntry,x=U===void 0?!1:U,_=e.selection,Ee=e.selectTextOnFocus,ke=e.showSoftInputOnFocus,J=e.spellCheck,s,T;if(b!=null)T=b,b==="email"?s="email":b==="tel"?s="tel":b==="search"?s="search":b==="url"?s="url":s="text";else if(H!=null)switch(H){case"email-address":s="email";break;case"number-pad":case"numeric":T="numeric";break;case"decimal-pad":T="decimal";break;case"phone-pad":s="tel";break;case"search":case"web-search":s="search";break;case"url":s="url";break;default:s="text"}x&&(s="password");var g=d.useRef({height:null,width:null}),C=d.useRef(null),z=d.useRef(null),Q=d.useRef(!1);d.useEffect(()=>{C.current&&z.current&&Y(C.current,z.current),Q.current=x},[x]);var O=d.useCallback(t=>{if(m&&F&&t!=null){var u=t.scrollHeight,v=t.scrollWidth;(u!==g.current.height||v!==g.current.width)&&(g.current.height=u,g.current.width=v,F({nativeEvent:{contentSize:{height:g.current.height,width:g.current.width}}}))}},[m,F]),Fe=d.useMemo(()=>t=>{t!=null&&(t.clear=function(){t!=null&&(t.value="")},t.isFocused=function(){return t!=null&&R.currentlyFocusedField()===t},O(t))},[O]);function _e(t){R._currentlyFocusedNode=null,D&&(t.nativeEvent.text=t.target.value,D(t))}function ze(t){var u=t.target,v=u.value;t.nativeEvent.text=v,O(u),K&&K(t),V&&V(v)}function Oe(t){var u=t.target;A&&(t.nativeEvent.text=u.value,A(t)),u!=null&&(R._currentlyFocusedNode=u,k&&(u.value=""),Ee&&(w!=null&&clearTimeout(w),w=setTimeout(()=>{u!=null&&document.activeElement===u&&u.select()},0)))}function $e(t){var u=t.target;t.stopPropagation();var v=!m,$=c??v,p=t.nativeEvent,X=bt(p);j&&j(t),t.key==="Enter"&&!t.shiftKey&&!X&&!t.isDefaultPrevented()&&((c||!m)&&W&&(t.preventDefault(),p.text=t.target.value,W(t)),$&&u!=null&&setTimeout(()=>u.blur(),0))}function we(t){try{var u=t.target,v=u.selectionStart,$=u.selectionEnd,p={start:v,end:$};B&&(t.nativeEvent.selection=p,t.nativeEvent.text=t.target.value,B(t)),Q.current===x&&(z.current=p)}catch{}}rt(()=>{var t=C.current;t!=null&&_!=null&&Y(t,_),document.activeElement===t&&(R._currentlyFocusedNode=t)},[C,_]);var Pe=m?"textarea":"input";nt(C,le),it(C,{onMoveShouldSetResponder:ae,onMoveShouldSetResponderCapture:ue,onResponderEnd:ie,onResponderGrant:ce,onResponderMove:de,onResponderReject:se,onResponderRelease:fe,onResponderStart:he,onResponderTerminate:ve,onResponderTerminationRequest:Se,onScrollShouldSetResponder:me,onScrollShouldSetResponderCapture:Ce,onSelectionChangeShouldSetResponder:be,onSelectionChangeShouldSetResponderCapture:ge,onStartShouldSetResponder:ye,onStartShouldSetResponderCapture:pe});var Me=lt(),Le=Me.direction,l=Ct(e);l.autoCapitalize=a,l.autoComplete=r||h||"on",l.autoCorrect=f?"on":"off",l.dir=i!==void 0?i:"auto",l.enterKeyHint=oe||Te,l.inputMode=T,l.onBlur=_e,l.onChange=ze,l.onFocus=Oe,l.onKeyDown=$e,l.onSelect=we,l.readOnly=xe===!0||y===!1,l.rows=m?G??re:1,l.spellCheck=J??f,l.style=[{"--placeholderTextColor":Re},P.textinput$raw,P.placeholder,e.style,E&&P.caretHidden],l.type=m?void 0:s,l.virtualkeyboardpolicy=ke===!1?"manual":"auto";var He=ut(l),Ie=at(C,He,Fe,n);l.ref=Ie;var De=e.lang!=null?Qe(e.lang):null,Ke=e.dir||De,Ve=Ke||Le,Ae=Ge(Pe,l,{writingDirection:Ve});return Ae});L.displayName="TextInput";L.State=R;var P=Be.create({textinput$raw:{MozAppearance:"textfield",WebkitAppearance:"none",backgroundColor:"transparent",border:"0 solid black",borderRadius:0,boxSizing:"border-box",font:"14px System",margin:0,padding:0,resize:"none"},placeholder:{placeholderTextColor:"var(--placeholderTextColor)"},caretHidden:{caretColor:"transparent"}}),gt=L;function yt({isInput:e,props:n,ref:o}){const{id:a,onChangeText:r,value:h,defaultValue:S}=n,f=d.useRef(h||S||""),c=d.useRef(),E=d.useCallback(i=>{var y;a&&i&&((y=c.current)===null||y===void 0||y.call(c),c.current=Ne(a,{focus:i.focus,...e&&{focusAndSelect(){i.focus(),i.setSelection&&typeof f.current=="string"&&i.setSelection(0,f.current.length)}}}))},[e,a]),k=dt(o,E);return d.useEffect(()=>()=>{var i;(i=c.current)===null||i===void 0||i.call(c)},[]),{ref:k,onChangeText:ot(i=>{f.current=i,r==null||r(i)})}}const pt=(e="$true",n)=>{if(n.props.multiline||n.props.numberOfLines>1)return Rt(e,n);const o=ee(e,n),a=M(e,{shift:-1,bounds:[2]}),r=te(e,n);return!ne&&r&&delete r.lineHeight,{...r,...o,paddingHorizontal:a}},Rt=(e="$true",n)=>{const{props:o}=n,a=ee(e,n),r=te(e,n),h=o.rows??o.numberOfLines,S=typeof h=="number"?h*st(r.lineHeight):"auto",f=M(e,{shift:-2,bounds:[2]}),c=M(e,{shift:-1,bounds:[2]});return{...a,...r,paddingVertical:f,paddingHorizontal:c,height:S}};var xt=N(ct(),1);const Tt={size:"$true",fontFamily:"$body",borderWidth:1,outlineWidth:0,color:"$color",...ne?{tabIndex:0}:{focusable:!0},borderColor:"$borderColor",backgroundColor:"$background",minWidth:0,hoverStyle:{borderColor:"$borderColorHover"},focusStyle:{borderColor:"$borderColorFocus"},focusVisibleStyle:{outlineColor:"$outlineColor",outlineWidth:2,outlineStyle:"solid"}},Z=ft(gt,{name:"Input",variants:{unstyled:{false:Tt},size:{"...size":pt},disabled:{true:{}}},defaultVariants:{unstyled:{}.TAMAGUI_HEADLESS==="1"}},{isInput:!0,accept:{placeholderTextColor:"color",selectionColor:"color"}}),$t=Z.styleable((e,n)=>{const o=d.useRef(null),a=ht(n,o),r=Et(e,a);return(0,xt.jsx)(Z,{...r})});function Et(e,n){var o,a;const r=vt(),{onChangeText:h,ref:S}=yt({props:e,ref:n,isInput:!0}),f=e.placeholderTextColor,c=((o=r[f])===null||o===void 0?void 0:o.get())??f??((a=r.placeholderColor)===null||a===void 0?void 0:a.get());return{ref:S,readOnly:e.disabled,...e,placeholderTextColor:c,onChangeText:h}}export{$t as Input};
