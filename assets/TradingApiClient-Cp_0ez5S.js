import{__toESM as V}from"./chunk-DgAfPHQg.js";import{require_react as dt}from"./react-CNoFhWkx.js";import{isInterface as mt}from"./index.web-BqgtOHN3.js";import{logger as C}from"./hooks-BXO4d1DJ.js";import{CurrencyAmount as _,Percent as N,Price as B,Token as lt,UniverseChainId as P,getChainInfo as Z,init_sdk_core_esm as F,isUniverseChainId as ht}from"./utils-BX1Fu73x.js";import{BigNumber as Q,init_lib$5 as At}from"./lib-DPFIyRke.js";import{areAddressesEqual as b,currencyAddress as J,currencyId as K}from"./currencyId-Ci6selsx.js";import{config as ft}from"./config-C4KrHqHG.js";import{Pool as gt,PriorityOrderTrade as vt,Route as wt,V2DutchOrderTrade as _t,V3DutchOrderTrade as Ot,init_v4_sdk_esm as Tt,require_dist$1 as j}from"./V3DutchOrderTrade-Cl7yELmp.js";import{Pool as Et,Route as It,init_v3_sdk_esm as Pt}from"./v3-sdk.esm-CHH6GWR1.js";import{Pair as St,Route as yt,init_v2_sdk_esm as Rt}from"./v2-sdk.esm-CIiDMO7F.js";import{ValueType as O,getCurrencyAmount as T}from"./getCurrencyAmount-vvZpAzIm.js";import{DynamicConfigs as Nt,SwapConfigKey as bt}from"./configs-B4dDdw82.js";import{FeatureFlags as I,getDynamicConfigValue as qt,getFeatureFlag as S}from"./hooks-Bp0VtWbX.js";import{nativeOnChain as q}from"./objects-DlLkJwrJ.js";import{ProtocolItems as f}from"./ProtocolItems-DhZWSiXS.js";import{Routing as l,isClassic as Vt,isWrap as Ct}from"./selectors-BwkayGDl.js";import{uniswapUrls as m}from"./urls-kwiZbYPW.js";import{createApiClient as Ft}from"./createApiClient-BjXZMbEB.js";import{require_ethers as kt}from"./ethers-D2SIY1xg.js";import{createGetSupportedChainId as Ut,useSupportedChainId as Dt}from"./useSupportedChainId-DskHoisQ.js";let xt=(function(t){return t.DEFAULT="DEFAULT",t})({}),Lt=(function(t){return t[t._1=1]="_1",t[t._10=10]="_10",t[t._56=56]="_56",t[t._130=130]="_130",t[t._137=137]="_137",t[t._324=324]="_324",t[t._480=480]="_480",t[t._1868=1868]="_1868",t[t._8453=8453]="_8453",t[t._10143=10143]="_10143",t[t._42161=42161]="_42161",t[t._42220=42220]="_42220",t[t._43114=43114]="_43114",t[t._81457=81457]="_81457",t[t._7777777=7777777]="_7777777",t[t._1301=1301]="_1301",t[t._84532=84532]="_84532",t[t._11155111=11155111]="_11155111",t})({}),L=(function(t){return t.V4_HOOKS_INCLUSIVE="V4_HOOKS_INCLUSIVE",t.V4_HOOKS_ONLY="V4_HOOKS_ONLY",t.V4_NO_HOOKS="V4_NO_HOOKS",t})({}),z=(function(t){return t.BEST_PRICE="BEST_PRICE",t.FASTEST="FASTEST",t.CLASSIC="CLASSIC",t.UNISWAPX="UNISWAPX",t.BEST_PRICE_V2="BEST_PRICE_V2",t.UNISWAPX_V2="UNISWAPX_V2",t.V3_ONLY="V3_ONLY",t.V2_ONLY="V2_ONLY",t})({}),Bt=(function(t){return t._1_2="1.2",t._2_0="2.0",t})({}),Wt=(function(t){return t.NORMAL="normal",t.FAST="fast",t.URGENT="urgent",t})({});function Mt(t,e){const n=performance.mark(t);if(n)return n.startTime;if(e)return Date.now()-e}let Be=(function(t){return t.FirstSwapAction="FIRST_SWAP_ACTION",t.FirstQuoteFetchStarted="FIRST_QUOTE_FETCH_STARTED",t.FirstSwapSuccess="FIRST_SWAP_SUCCESS",t})({});var Xt=class ${constructor(){this.createdAt=Date.now(),this.timestamps=new Map}static getInstance(){return this._instance||(this._instance=new $),this._instance}hasTimestamp(e){return this.timestamps.has(e)}setElapsedTime(e){if(this.timestamps.has(e))return;const n=Mt(e,this.createdAt);return n&&this.timestamps.set(e,n),this.timestamps.get(e)}getElapsedTime(e,n){const i=this.timestamps.get(e);if(!i)return;let o=0;return n&&(o=this.timestamps.get(n)??0),i-o}};const We=Xt.getInstance(),Ht=5.5,Me=100,Xe=20,He=2,Ge=30,Qe=60,Je=4320;F();function R(t){if(!t||Ct(t))return;const{quote:e}=t,n="aggregatedOutputs"in e?e.aggregatedOutputs:void 0,i="swapper"in e?e.swapper:void 0;if(!n||!i)return!e.portionAmount||!e.portionBips?void 0:{recipient:e.portionRecipient,percent:new N(e.portionBips,"10000"),amount:e.portionAmount};const o=n.filter(u=>u.recipient!==i);o.length>1&&C.error(new Error("Multiple UL fees found in quote"),{tags:{file:"getSwapFee.ts",function:"getSwapFee"},extra:{ulFees:o,quote:e}});const r=o[0];if(!(!(r!=null&&r.bps)||!r.amount))return{recipient:r.recipient,percent:new N(r.bps,"10000"),amount:r.amount}}F();const Gt=t=>{const e=Math.round(t*100);return new N(e,1e4)};var v=V(j());F();var p=V(kt());function k(t,e){var n;return t?((n=t.quote.aggregatedOutputs)===null||n===void 0?void 0:n.reduce((i,o)=>i.add(_.fromRawAmount(e,o.amount??"0")),_.fromRawAmount(e,"0")))??_.fromRawAmount(e,"0"):_.fromRawAmount(e,"0")}function U({quote:t,outputCurrency:e,recipient:n}){var i;if(!t||!n)return _.fromRawAmount(e,"0");const o=(i=t.quote.aggregatedOutputs)===null||i===void 0?void 0:i.find(r=>r.recipient===n);return o?_.fromRawAmount(e,o.minAmount??"0"):_.fromRawAmount(e,"0")}var Qt=class extends _t{constructor({quote:t,currencyIn:e,currencyOut:n,tradeType:i}){const o=Zt(t.quote.orderInfo);super({currencyIn:e,currenciesOut:[n],orderInfo:o,tradeType:i}),this.routing=l.DUTCH_V2,this.indicative=!1,this.quote=t,this.slippageTolerance=this.quote.quote.slippageTolerance??0,this.swapFee=R(t),this.maxAmountIn=this.maximumAmountIn(),this.minAmountOut=this.minimumAmountOut()}maximumAmountIn(){return super.maximumAmountIn()}minimumAmountOut(){return super.minimumAmountOut()}get deadline(){return this.order.info.deadline}get inputTax(){return v.ZERO_PERCENT}get outputTax(){return v.ZERO_PERCENT}get quoteOutputAmount(){return k(this.quote,this.outputAmount.currency)}get quoteOutputAmountUserWillReceive(){return U({quote:this.quote,outputCurrency:this.outputAmount.currency,recipient:this.quote.quote.orderInfo.swapper})}},Jt=class extends Ot{constructor({quote:t,currencyIn:e,currencyOut:n,tradeType:i}){const o=jt(t.quote.orderInfo),{expectedAmountIn:r,expectedAmountOut:u}=t.quote,a=r&&u?{expectedAmountIn:r,expectedAmountOut:u}:void 0;super({currencyIn:e,currenciesOut:[n],orderInfo:o,tradeType:i,expectedAmounts:a}),this.routing=l.DUTCH_V3,this.indicative=!1,this.quote=t,this.slippageTolerance=this.quote.quote.slippageTolerance??0,this.swapFee=R(t),this.maxAmountIn=this.maximumAmountIn(),this.minAmountOut=this.minimumAmountOut()}maximumAmountIn(){return super.maximumAmountIn()}minimumAmountOut(){return super.minimumAmountOut()}get deadline(){return this.order.info.deadline}get inputTax(){return v.ZERO_PERCENT}get outputTax(){return v.ZERO_PERCENT}get quoteOutputAmount(){return k(this.quote,this.outputAmount.currency)}get quoteOutputAmountUserWillReceive(){return U({quote:this.quote,outputCurrency:this.outputAmount.currency,recipient:this.quote.quote.orderInfo.swapper})}},Kt=class extends vt{constructor({quote:t,currencyIn:e,currencyOut:n,tradeType:i}){const o=zt(t.quote.orderInfo),{expectedAmountIn:r,expectedAmountOut:u}=t.quote,a=r&&u?{expectedAmountIn:r,expectedAmountOut:u}:void 0;super({currencyIn:e,currenciesOut:[n],orderInfo:o,tradeType:i,expectedAmounts:a}),this.routing=l.PRIORITY,this.indicative=!1,this.quote=t,this.slippageTolerance=this.quote.quote.slippageTolerance??0,this.swapFee=R(t),this.maxAmountIn=this.maximumAmountIn(),this.minAmountOut=this.minimumAmountOut()}maximumAmountIn(){return super.maximumAmountIn()}minimumAmountOut(){return super.minimumAmountOut()}get deadline(){return this.order.info.deadline}get inputTax(){return v.ZERO_PERCENT}get outputTax(){return v.ZERO_PERCENT}get quoteOutputAmount(){return k(this.quote,this.outputAmount.currency)}get quoteOutputAmountUserWillReceive(){return U({quote:this.quote,outputCurrency:this.outputAmount.currency,recipient:this.quote.quote.orderInfo.swapper})}},Yt=class extends v.Trade{constructor({quote:t,deadline:e,...n}){super(n),this.routing=l.CLASSIC,this.indicative=!1,this.quote=t,this.deadline=e,this.slippageTolerance=t.quote.slippage??Ht,this.swapFee=R(t);const i=Gt(this.slippageTolerance);this.maxAmountIn=this.maximumAmountIn(i),this.minAmountOut=this.minimumAmountOut(i)}maximumAmountIn(t){return super.maximumAmountIn(t)}minimumAmountOut(t){return super.minimumAmountOut(t)}get priceImpact(){if(!this._cachedPriceImpact){const t=this.quote.quote.priceImpact;this._cachedPriceImpact=t?new N(Math.round(t*100),1e4):super.priceImpact}return this._cachedPriceImpact}get quoteOutputAmount(){return k(this.quote,this.outputAmount.currency)}get quoteOutputAmountUserWillReceive(){return U({quote:this.quote,outputCurrency:this.outputAmount.currency,recipient:this.quote.quote.swapper})}};let Ke=(function(t){return t.None="none",t.Permit2Approve="permit2-approve",t.RevokeAndPermit2Approve="revoke-and-permit2-approve",t.Unknown="unknown",t})({});function Zt(t){return{...t,nonce:p.BigNumber.from(t.nonce),additionalValidationContract:t.additionalValidationContract??"",additionalValidationData:t.additionalValidationData??"",input:{token:t.input.token??"",startAmount:p.BigNumber.from(t.input.startAmount),endAmount:p.BigNumber.from(t.input.endAmount)},outputs:t.outputs.map(e=>({token:e.token,startAmount:p.BigNumber.from(e.startAmount),endAmount:p.BigNumber.from(e.endAmount),recipient:e.recipient})),cosigner:t.cosigner??""}}function jt(t){var e;return{...t,startingBaseFee:p.BigNumber.from(0),nonce:p.BigNumber.from(t.nonce),additionalValidationContract:t.additionalValidationContract??"",additionalValidationData:t.additionalValidationData??"",input:{token:t.input.token,startAmount:p.BigNumber.from(t.input.startAmount),curve:{relativeBlocks:t.input.curve.relativeBlocks??[],relativeAmounts:((e=t.input.curve.relativeAmounts)===null||e===void 0?void 0:e.map(n=>BigInt(n)))??[]},maxAmount:p.BigNumber.from(t.input.maxAmount),adjustmentPerGweiBaseFee:p.BigNumber.from(t.input.adjustmentPerGweiBaseFee)},outputs:t.outputs.map(n=>{var i;return{token:n.token,startAmount:p.BigNumber.from(n.startAmount),curve:{relativeBlocks:n.curve.relativeBlocks??[],relativeAmounts:((i=n.curve.relativeAmounts)===null||i===void 0?void 0:i.map(o=>BigInt(o)))??[]},minAmount:p.BigNumber.from(n.minAmount),adjustmentPerGweiBaseFee:p.BigNumber.from(n.adjustmentPerGweiBaseFee),recipient:n.recipient}}),cosigner:t.cosigner??""}}function zt(t){return{...t,nonce:p.BigNumber.from(t.nonce),additionalValidationContract:t.additionalValidationContract??"",additionalValidationData:t.additionalValidationData??"",input:{token:t.input.token,amount:p.BigNumber.from(t.input.amount),mpsPerPriorityFeeWei:p.BigNumber.from(t.input.mpsPerPriorityFeeWei)},outputs:t.outputs.map(e=>({token:e.token,amount:p.BigNumber.from(e.amount),mpsPerPriorityFeeWei:p.BigNumber.from(e.mpsPerPriorityFeeWei),recipient:e.recipient})),baselinePriorityFeeWei:p.BigNumber.from(t.baselinePriorityFeeWei),auctionStartBlock:p.BigNumber.from(t.auctionStartBlock)}}function Ye(t){if("input"in t.quote&&"output"in t.quote){const e=t.quote.input,n=t.quote.output;if(!e||!n)return;if(e.amount&&e.token&&n.amount&&n.token&&n.recipient)return{...t,input:{amount:e.amount,token:e.token},output:{amount:n.amount,token:n.token,recipient:n.recipient}}}}var Ze=class{constructor({quote:t,currencyIn:e,currencyOut:n,slippageTolerance:i}){this.indicative=!0,this.quote=t;const o=T({value:this.quote.input.amount,valueType:O.Raw,currency:e}),r=T({value:this.quote.output.amount,valueType:O.Raw,currency:n});if(!o||!r)throw new Error("Error parsing indicative quote currency amounts");this.inputAmount=o,this.outputAmount=r,this.executionPrice=new B(e,n,this.quote.input.amount,this.quote.output.amount),this.slippageTolerance=i}get quoteOutputAmount(){return this.outputAmount}get quoteOutputAmountUserWillReceive(){return this.outputAmount}},$t=class{constructor({quote:t,currencyIn:e,currencyOut:n,tradeType:i}){var o,r;this.routing=l.BRIDGE,this.indicative=!1,this.inputTax=v.ZERO_PERCENT,this.outputTax=v.ZERO_PERCENT,this.quote=t,this.swapFee=R(t);const u=(o=t.quote.input)===null||o===void 0?void 0:o.amount,a=(r=t.quote.output)===null||r===void 0?void 0:r.amount;if(!u||!a)throw new Error("Error parsing bridge quote currency amounts");const s=T({value:u,valueType:O.Raw,currency:e}),d=T({value:a,valueType:O.Raw,currency:n});if(!s||!d)throw new Error("Error parsing bridge quote currency amounts");this.inputAmount=s,this.outputAmount=d,this.executionPrice=new B(e,n,u,a),this.tradeType=i,this.maxAmountIn=this.inputAmount,this.minAmountOut=this.outputAmount}get quoteOutputAmount(){return this.outputAmount}get quoteOutputAmountUserWillReceive(){const t=this.swapFee?T({value:this.swapFee.amount,valueType:O.Raw,currency:this.outputAmount.currency}):void 0;return t?this.outputAmount.add(t):this.outputAmount}},tt=class{constructor({quote:t,currencyIn:e,currencyOut:n,tradeType:i}){var o,r;this.indicative=!1,this.inputTax=v.ZERO_PERCENT,this.outputTax=v.ZERO_PERCENT,this.slippageTolerance=0,this.quote=t;const u=(o=t.quote.input)===null||o===void 0?void 0:o.amount,a=(r=t.quote.output)===null||r===void 0?void 0:r.amount;if(!u||!a)throw new Error("Error parsing wrap/unwrap quote currency amounts");const s=T({value:u,valueType:O.Raw,currency:e}),d=T({value:a,valueType:O.Raw,currency:n});if(!s||!d)throw new Error("Error parsing wrap/unwrap quote currency amounts");this.inputAmount=s,this.outputAmount=d,this.executionPrice=new B(e,n,1,1),this.tradeType=i,this.maxAmountIn=this.inputAmount,this.minAmountOut=this.outputAmount}get quoteOutputAmount(){return this.outputAmount}get quoteOutputAmountUserWillReceive(){return this.outputAmount}},te=class extends tt{constructor(...t){super(...t),this.routing=l.WRAP}},ee=class extends tt{constructor(...t){super(...t),this.routing=l.UNWRAP}};function je(t){const e=Dt(t);return et({getSupportedChainId:()=>e})(t)}function et(t){function e(n){const i=t.getSupportedChainId(n);return i?Z(i).supportsV4:!1}return e}var ze=V(dt());const $e=[f.UNISWAPX_V2,f.V4,f.V3,f.V2],ne=[P.Mainnet];function ie(t){return function(n,i){const o=t.getUniswapXEnabled(),r=t.getIsUniswapXSupported?t.getIsUniswapXSupported(i):!0,u=o&&r,a=t.getPriorityOrderFlag(i),s=i===P.ArbitrumOne&&t.getArbitrumDutchV3Enabled(),d=t.getV4Enabled(i),g=i&&ne.includes(i)||a||s;let c=[...n];return(!g||!u)&&(c=c.filter(w=>w!==f.UNISWAPX_V2)),s&&(c=c.map(w=>w===f.UNISWAPX_V2?f.UNISWAPX_V3:w)),d||(c=c.filter(w=>w!==f.V4)),c}}function tn(t){return t?nt(t):!1}function en(t){const e=S(I.UniswapX),n=S(I.ArbitrumDutchV3),i=et({getSupportedChainId:Ut({getChains:()=>t.getEnabledChains()}).getSupportedChainId});return ie({getUniswapXEnabled:()=>e,getIsUniswapXSupported:t.getIsUniswapXSupported,getPriorityOrderFlag:nt,getV4Enabled:i,getArbitrumDutchV3Enabled:()=>n})}function re(t){return e=>{if(!e)return!1;switch(e){case P.Base:return t.getFeatureFlag(I.UniswapXPriorityOrdersBase);case P.Optimism:return t.getFeatureFlag(I.UniswapXPriorityOrdersOptimism);case P.Unichain:return t.getFeatureFlag(I.UniswapXPriorityOrdersUnichain);default:return!1}}}const nt=re({getFeatureFlag:S});At();var oe=V(j());F();Rt();Pt();Tt();const y="0x0000000000000000000000000000000000000000",nn=mt?Wt.NORMAL:void 0;function rn(t){const{currencyIn:e,currencyOut:n,tradeType:i,deadline:o,data:r}=t;switch(r==null?void 0:r.routing){case l.CLASSIC:{const a=ue({tokenInIsNative:e.isNative,tokenOutIsNative:n.isNative,quoteResponse:r});return!a||!o?null:new Yt({quote:r,deadline:o,v2Routes:a.flatMap(s=>s.routev2?{...s,routev2:s.routev2}:[]),v3Routes:a.flatMap(s=>s.routev3?{...s,routev3:s.routev3}:[]),v4Routes:a.flatMap(s=>s.routev4?{...s,routev4:s.routev4}:[]),mixedRoutes:a.flatMap(s=>s.mixedRoute?{...s,mixedRoute:s.mixedRoute}:[]),tradeType:i})}case l.PRIORITY:case l.DUTCH_V3:case l.DUTCH_V2:{var u;const{quote:a}=r;return!b({addressInput1:{address:e.wrapped.address,chainId:e.chainId},addressInput2:{address:a.orderInfo.input.token,chainId:e.chainId}})||!b({addressInput1:{address:de(n),chainId:n.chainId},addressInput2:{address:(u=a.orderInfo.outputs[0])===null||u===void 0?void 0:u.token,chainId:n.chainId}})?null:r.routing===l.PRIORITY?new Kt({quote:r,currencyIn:e,currencyOut:n,tradeType:i}):r.routing===l.DUTCH_V2?new Qt({quote:r,currencyIn:e,currencyOut:n,tradeType:i}):new Jt({quote:r,currencyIn:e,currencyOut:n,tradeType:i})}case l.BRIDGE:return new $t({quote:r,currencyIn:e,currencyOut:n,tradeType:i});case l.WRAP:return new te({quote:r,currencyIn:e,currencyOut:n,tradeType:i});case l.UNWRAP:return new ee({quote:r,currencyIn:e,currencyOut:n,tradeType:i});default:return null}}function ue({tokenInIsNative:t,tokenOutIsNative:e,quoteResponse:n}){var i,o,r;if(!n)return;const{quote:u}=n;if(!u.route||u.route.length===0)return;const a=(i=u.route[0])===null||i===void 0||(i=i[0])===null||i===void 0?void 0:i.tokenIn,s=(o=u.route[0])===null||o===void 0||(o=o[((r=u.route[0])===null||r===void 0?void 0:r.length)-1])===null||o===void 0?void 0:o.tokenOut;if(!a||!s)throw new Error("Expected both tokenIn and tokenOut to be present");if(!a.chainId||s.chainId===void 0||!a.address||!s.address||!a.decimals||!s.decimals)throw new Error("Expected all token properties to be present");const d=t?q(a.chainId):E(a),g=e?q(s.chainId):E(s);try{return u.route.map(c=>{var w,x;if(c.length===0)throw new Error("Expected route to have at least one pair or pool");const W=T({value:(w=c[0])===null||w===void 0?void 0:w.amountIn,valueType:O.Raw,currency:d}),M=T({value:(x=c[c.length-1])===null||x===void 0?void 0:x.amountOut,valueType:O.Raw,currency:g});if(!W||!M)throw new Error("Expected both amountIn and amountOut to be present");const X=se(c),H=ce(c),G=pe(c),ct=c.filter(pt=>pt.type==="v4-pool");return{routev4:G?new wt(ct.map(it),d,g):null,routev3:H?new It(c.map(rt),d,g):null,routev2:X?new yt(c.map(ot),d,g):null,mixedRoute:!H&&!X&&!G?new oe.MixedRouteSDK(c.map(ae),d,g):null,inputAmount:W,outputAmount:M}})}catch(c){C.error(c,{tags:{file:"tradingApi.ts",function:"computeRoutes"},extra:{input:J(d),output:J(g),inputChainId:d.chainId,outputChainId:g.chainId}});return}}function E(t){const{address:e,chainId:n,decimals:i,symbol:o,buyFeeBps:r,sellFeeBps:u}=t;if(!n||!e||!i||!o)throw new Error("Expected token to have chainId, address, decimals, and symbol");if(e===y)throw new Error("Cannot parse native currency as an erc20 Token");return new lt(n,e,parseInt(i.toString(),10),o,void 0,!1,r?Q.from(r):void 0,u?Q.from(u):void 0)}function it({fee:t,sqrtRatioX96:e,liquidity:n,tickCurrent:i,tickSpacing:o,hooks:r,tokenIn:u,tokenOut:a}){if(!u.address||!a.address||!u.chainId||!a.chainId)throw new Error("Expected V4 route to have defined addresses and chainIds");const s=u.address===y,d=a.address===y,g=s?q(u.chainId):E(u),c=d?q(a.chainId):E(a);return new gt(g,c,Number(t),Number(o),r,e,n,Number(i))}function rt({fee:t,sqrtRatioX96:e,liquidity:n,tickCurrent:i,tokenIn:o,tokenOut:r}){if(!o||!r||!t||!e||!n||!i)throw new Error("Expected pool values to be present");return new Et(E(o),E(r),parseInt(t,10),e,n,parseInt(i,10))}function ot({reserve0:t,reserve1:e}){if(!(t!=null&&t.token)||!(e!=null&&e.token)||!t.quotient||!e.quotient)throw new Error("Expected pool values to be present");return new St(_.fromRawAmount(E(t.token),t.quotient),_.fromRawAmount(E(e.token),e.quotient))}function ae(t){if(ut(t))return ot(t);if(at(t))return rt(t);if(st(t))return it(t);throw new Error("Invalid pool type")}function ut(t){return t.type==="v2-pool"}function at(t){return t.type==="v3-pool"}function st(t){return t.type==="v4-pool"}function se(t){return t.every(ut)}function ce(t){return t.every(at)}function pe(t){return t.every(st)}function on(t,e){return t===Z(e).nativeCurrency.address?y:t}function de(t){if(t)return t.isNative?y:t.address}const me=Object.values(Lt).filter(t=>typeof t=="number");function le(t){return t?Object.values(me).includes(t):!1}function un(t){if(!(!t||!le(t)))return t}function an(t){if(t&&Vt(t))return t.quote}function sn({trade:t,currencyIn:e,currencyOut:n,exactAmount:i,exactCurrencyField:o}){if(!t||!e||!n||!i)return null;const r=b({addressInput1:{address:e.wrapped.address,chainId:e.chainId},addressInput2:{address:t.inputAmount.currency.wrapped.address,chainId:t.inputAmount.currency.chainId}}),u=b({addressInput1:{address:n.wrapped.address,chainId:n.chainId},addressInput2:{address:t.outputAmount.currency.wrapped.address,chainId:t.outputAmount.currency.chainId}});return r&&u?t:(C.error(new Error("Mismatched address in swap trade"),{tags:{file:"tradingApi/utils",function:"validateTrade"},extra:{formState:{currencyIdIn:K(e),currencyIdOut:K(n),exactAmount:i.toExact(),exactCurrencyField:o},tradeProperties:t}}),null)}function cn(t){return e=>{const{isUSDQuote:n,tokenInChainId:i,tokenOutChainId:o}=e;if(n)return{protocols:[f.V2,f.V3,f.V4]};if(i!==o)return{routingPreference:z.BEST_PRICE};const r=t.getProtocols();let u=[...r],a;return t.getIsV4HookPoolsEnabled()?r.includes(f.V4)?a=L.V4_HOOKS_INCLUSIVE:(u=[...r,f.V4],a=L.V4_HOOKS_ONLY):a=L.V4_NO_HOOKS,{protocols:u,hooksOptions:a}}}const he=2.5;function pn(){return qt({config:Nt.Swap,key:bt.MinAutoSlippageToleranceL2,defaultValue:he})}function dn(t){return function(n){const{tokenInChainId:i,tokenOutChainId:o,isUSDQuote:r}=n,u=t.getCustomSlippageTolerance();if(u)return{slippageTolerance:u};if(!(i!==o||r))return t.getIsL2ChainId(i)?{slippageTolerance:t.getMinAutoSlippageToleranceL2()}:{autoSlippage:xt.DEFAULT}}}function mn(t){if(!t)return;const e=Number(t);return ht(e)?e:void 0}const h=Ft({baseUrl:m.tradingApiUrl,additionalHeaders:{"x-api-key":ft.tradingApiKey}}),D={"x-universal-router-version":Bt._2_0},A=()=>{const t=S(I.UniquoteEnabled),e=S(I.ViemProviderEnabled);return{"x-uniquote-enabled":t?"true":"false","x-viem-provider-enabled":e?"true":"false"}};async function Ae({isUSDQuote:t,...e}){return await h.post(m.tradingApiPaths.quote,{body:JSON.stringify(e),headers:{...D,...A()},on404:()=>{C.warn("TradingApiClient","fetchQuote","Quote 404",{chainIdIn:e.tokenInChainId,chainIdOut:e.tokenOutChainId,tradeType:e.type,isBridging:e.tokenInChainId!==e.tokenOutChainId})}})}async function ln(t){const e={...t,routingPreference:z.FASTEST};return Ae(e)}async function hn({...t}){return await h.post(m.tradingApiPaths.swap,{body:JSON.stringify(t),headers:{...D,...A()}})}async function An({...t}){return await h.post(m.tradingApiPaths.swap5792,{body:JSON.stringify(t),headers:{...D,...A()}})}async function fn({...t}){return await h.post(m.tradingApiPaths.swap7702,{body:JSON.stringify(t),headers:{...D,...A()}})}async function gn(t){return await h.post(m.tradingApiPaths.approval,{body:JSON.stringify(t),headers:{...A()}})}async function vn(t){return await h.post(m.tradingApiPaths.order,{body:JSON.stringify(t),headers:{...A()}})}async function wn(t){return await h.get(m.tradingApiPaths.swappableTokens,{params:{tokenIn:t.tokenIn,tokenInChainId:t.tokenInChainId},headers:{...A()}})}async function _n(t){return await h.post(m.tradingApiPaths.createLp,{body:JSON.stringify({...t}),headers:{...A()}})}async function On(t){return await h.post(m.tradingApiPaths.decreaseLp,{body:JSON.stringify({...t}),headers:{...A()}})}async function Tn(t){return await h.post(m.tradingApiPaths.increaseLp,{body:JSON.stringify({...t}),headers:{...A()}})}async function En(t,e){return await h.post(m.tradingApiPaths.lpApproval,{body:JSON.stringify({...t}),headers:{...A(),...e}})}async function In(t){return await h.post(m.tradingApiPaths.claimLpFees,{body:JSON.stringify({...t}),headers:{...A()}})}async function Pn(t){return await h.get(m.tradingApiPaths.swaps,{params:{txHashes:t.txHashes.join(","),chainId:t.chainId},headers:{...A()}})}async function Sn(t){return await h.post(m.tradingApiPaths.migrate,{body:JSON.stringify({...t}),headers:{...A()}})}async function yn(t){return await h.post(m.tradingApiPaths.claimRewards,{body:JSON.stringify({...t}),headers:{...A()}})}const fe=140;function ge(t){const{walletAddresses:e,chainIds:n,batchThreshold:i}=t;if(e.length*n.length<=i)return[e];const r=Math.floor(i/n.length),u=[];for(let a=0;a<e.length;a+=r)u.push(e.slice(a,a+r));return u}async function Y(t){return await h.post(m.tradingApiPaths.wallet.checkDelegation,{body:JSON.stringify({...t}),headers:{...A()}})}function ve(t){if(t.length===0)throw new Error("No responses to merge");const e=t[0];if(!e)throw new Error("First response is undefined");if(t.length===1)return e;const n={};for(const i of t)for(const[o,r]of Object.entries(i.delegationDetails))n[o]=r;return{requestId:e.requestId,delegationDetails:n}}async function Rn(t,e=fe){const{walletAddresses:n,chainIds:i}=t;if(!n||n.length===0)return{requestId:"",delegationDetails:{}};const o=Math.max(e,i.length);if(n.length*i.length<=o)return await Y(t);const a=ge({walletAddresses:n,chainIds:i,batchThreshold:o}).map(d=>Y({walletAddresses:d,chainIds:i})),s=await Promise.all(a);return ve(s)}export{Ke as ApprovalAction,$t as BridgeTrade,Lt as ChainId,Yt as ClassicTrade,Ge as DEFAULT_CUSTOM_DEADLINE,$e as DEFAULT_PROTOCOL_OPTIONS,Ze as IndicativeTrade,Ht as MAX_AUTO_SLIPPAGE_TOLERANCE,Je as MAX_CUSTOM_DEADLINE,Me as MAX_CUSTOM_SLIPPAGE_TOLERANCE,He as MAX_FIAT_INPUT_DECIMALS,y as NATIVE_ADDRESS_FOR_TRADING_API,Kt as PriorityOrderTrade,z as RoutingPreference,Xe as SLIPPAGE_CRITICAL_TOLERANCE,nn as SWAP_GAS_URGENCY_OVERRIDE,Be as SwapEventType,Qt as UniswapXV2Trade,Jt as UniswapXV3Trade,Bt as UniversalRouterVersion,Qe as WARNING_DEADLINE_TOLERANCE,En as checkLpApproval,Rn as checkWalletDelegation,In as claimLpFees,en as createGetProtocolsForChain,cn as createGetQuoteRoutingParams,dn as createGetQuoteSlippageParams,_n as createLpPosition,On as decreaseLpPosition,gn as fetchCheckApproval,yn as fetchClaimLpIncentiveRewards,ln as fetchIndicativeQuote,Ae as fetchQuote,hn as fetchSwap,An as fetchSwap5792,fn as fetchSwap7702,wn as fetchSwappableTokens,Pn as fetchSwaps,an as getClassicQuoteFromResponse,pn as getMinAutoSlippageToleranceL2,de as getTokenAddressForApi,on as getTokenAddressFromChainForTradingApi,Tn as increaseLpPosition,Sn as migrateLpPosition,Gt as slippageToleranceToPercent,vn as submitOrder,We as timestampTracker,un as toTradingApiSupportedChainId,mn as tradingApiToUniverseChainId,rn as transformTradingApiResponseToTrade,tn as useUniswapXPriorityOrderFlag,je as useV4SwapEnabled,Ye as validateIndicativeQuoteResponse,sn as validateTrade};
