import{Fraction as f,Percent as m,init_sdk_core_esm as p}from"./utils-BX1Fu73x.js";import{ALLOWED_PRICE_IMPACT_HIGH as I,ALLOWED_PRICE_IMPACT_LOW as R,ALLOWED_PRICE_IMPACT_MEDIUM as T,BIPS_BASE as d,BLOCKED_PRICE_IMPACT_NON_EXPERT as A,ONE_HUNDRED_PERCENT as r,ZERO_PERCENT as C}from"./misc-BMnlqqV4.js";import{FeeAmount as v,init_v3_sdk_esm as L}from"./v3-sdk.esm-CHH6GWR1.js";import{Pair as E,init_v2_sdk_esm as M}from"./v2-sdk.esm-CIiDMO7F.js";p();M();L();const w=new m(30,d),O=r.subtract(w);function b(e){const t=F(e);return e.priceImpact.subtract(t)}function F(e){let t;if(e.swaps[0].route.pools instanceof E)t=r.subtract(e.swaps.reduce(n=>n.multiply(O),r));else{t=C;for(const n of e.swaps){const{numerator:l,denominator:s}=n.inputAmount.divide(e.inputAmount),c=new m(l,s).multiply(r.subtract(n.route.pools.reduce((_,u)=>{const o=u instanceof E?v.MEDIUM:u.fee;return _.multiply(r.subtract(new f(o,1e6)))},r)));t=t.add(c)}}return new m(t.numerator,t.denominator)}const P=[A,I,T,R];function g(e){if(!e||e.lessThan(0))return 0;let t=P.length;for(const n of P){if(n.lessThan(e))return t;t--}return 0}function q(e){if(e.length<4)return e;const t=e.map(o=>o.value).sort((o,i)=>o-i),n=Math.floor(t.length*.25),l=Math.floor(t.length*.75),s=t[n],a=t[l],c=a-s,_=s-1.5*c,u=a+1.5*c;return e.filter(o=>{const i=o.value;return i>=_&&i<=u})}export{b as computeRealizedPriceImpact,q as removeOutliers,g as warningSeverity};
