import{__commonJS as z}from"./chunk-DgAfPHQg.js";import{require__u64 as Y,require_utils as K}from"./_u64-XHsHocZf.js";var Z=z({"../../node_modules/@noble/hashes/_md.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SHA512_IV=e.SHA384_IV=e.SHA224_IV=e.SHA256_IV=e.HashMD=void 0,e.setBigUint64=i,e.Chi=H,e.Maj=M;const s=K();function i(r,_,S,g){if(typeof r.setBigUint64=="function")return r.setBigUint64(_,S,g);const C=BigInt(32),u=BigInt(4294967295),w=Number(S>>C&u),x=Number(S&u),P=g?4:0,y=g?0:4;r.setUint32(_+P,w,g),r.setUint32(_+y,x,g)}function H(r,_,S){return r&_^~r&S}function M(r,_,S){return r&_^r&S^_&S}var G=class extends s.Hash{constructor(r,_,S,g){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=r,this.outputLen=_,this.padOffset=S,this.isLE=g,this.buffer=new Uint8Array(r),this.view=(0,s.createView)(this.buffer)}update(r){(0,s.aexists)(this),r=(0,s.toBytes)(r),(0,s.abytes)(r);const{view:_,buffer:S,blockLen:g}=this,C=r.length;for(let u=0;u<C;){const w=Math.min(g-this.pos,C-u);if(w===g){const x=(0,s.createView)(r);for(;g<=C-u;u+=g)this.process(x,u);continue}S.set(r.subarray(u,u+w),this.pos),this.pos+=w,u+=w,this.pos===g&&(this.process(_,0),this.pos=0)}return this.length+=r.length,this.roundClean(),this}digestInto(r){(0,s.aexists)(this),(0,s.aoutput)(r,this),this.finished=!0;const{buffer:_,view:S,blockLen:g,isLE:C}=this;let{pos:u}=this;_[u++]=128,(0,s.clean)(this.buffer.subarray(u)),this.padOffset>g-u&&(this.process(S,0),u=0);for(let d=u;d<g;d++)_[d]=0;i(S,g-8,BigInt(this.length*8),C),this.process(S,0);const w=(0,s.createView)(r),x=this.outputLen;if(x%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const P=x/4,y=this.get();if(P>y.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<P;d++)w.setUint32(4*d,y[d],C)}digest(){const{buffer:r,outputLen:_}=this;this.digestInto(r);const S=r.slice(0,_);return this.destroy(),S}_cloneInto(r){r||(r=new this.constructor),r.set(...this.get());const{blockLen:_,buffer:S,length:g,finished:C,destroyed:u,pos:w}=this;return r.destroyed=u,r.finished=C,r.length=g,r.pos=w,g%_&&r.buffer.set(S),r}clone(){return this._cloneInto()}};e.HashMD=G,e.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),e.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),e.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),e.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])}}),st=z({"../../node_modules/@noble/hashes/sha2.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sha512_224=e.sha512_256=e.sha384=e.sha512=e.sha224=e.sha256=e.SHA512_256=e.SHA512_224=e.SHA384=e.SHA512=e.SHA224=e.SHA256=void 0;const s=Z(),i=Y(),H=K(),M=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),G=new Uint32Array(64);var r=class extends s.HashMD{constructor(E=32){super(64,E,8,!1),this.A=s.SHA256_IV[0]|0,this.B=s.SHA256_IV[1]|0,this.C=s.SHA256_IV[2]|0,this.D=s.SHA256_IV[3]|0,this.E=s.SHA256_IV[4]|0,this.F=s.SHA256_IV[5]|0,this.G=s.SHA256_IV[6]|0,this.H=s.SHA256_IV[7]|0}get(){const{A:E,B:v,C:l,D:b,E:m,F:V,G:A,H:I}=this;return[E,v,l,b,m,V,A,I]}set(E,v,l,b,m,V,A,I){this.A=E|0,this.B=v|0,this.C=l|0,this.D=b|0,this.E=m|0,this.F=V|0,this.G=A|0,this.H=I|0}process(E,v){for(let t=0;t<16;t++,v+=4)G[t]=E.getUint32(v,!1);for(let t=16;t<64;t++){const n=G[t-15],h=G[t-2],o=(0,H.rotr)(n,7)^(0,H.rotr)(n,18)^n>>>3,c=(0,H.rotr)(h,17)^(0,H.rotr)(h,19)^h>>>10;G[t]=c+G[t-7]+o+G[t-16]|0}let{A:l,B:b,C:m,D:V,E:A,F:I,G:T,H:U}=this;for(let t=0;t<64;t++){const n=(0,H.rotr)(A,6)^(0,H.rotr)(A,11)^(0,H.rotr)(A,25),h=U+n+(0,s.Chi)(A,I,T)+M[t]+G[t]|0,c=((0,H.rotr)(l,2)^(0,H.rotr)(l,13)^(0,H.rotr)(l,22))+(0,s.Maj)(l,b,m)|0;U=T,T=I,I=A,A=V+h|0,V=m,m=b,b=l,l=h+c|0}l=l+this.A|0,b=b+this.B|0,m=m+this.C|0,V=V+this.D|0,A=A+this.E|0,I=I+this.F|0,T=T+this.G|0,U=U+this.H|0,this.set(l,b,m,V,A,I,T,U)}roundClean(){(0,H.clean)(G)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,H.clean)(this.buffer)}};e.SHA256=r;var _=class extends r{constructor(){super(28),this.A=s.SHA224_IV[0]|0,this.B=s.SHA224_IV[1]|0,this.C=s.SHA224_IV[2]|0,this.D=s.SHA224_IV[3]|0,this.E=s.SHA224_IV[4]|0,this.F=s.SHA224_IV[5]|0,this.G=s.SHA224_IV[6]|0,this.H=s.SHA224_IV[7]|0}};e.SHA224=_;const S=i.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(E=>BigInt(E))),g=S[0],C=S[1],u=new Uint32Array(80),w=new Uint32Array(80);var x=class extends s.HashMD{constructor(E=64){super(128,E,16,!1),this.Ah=s.SHA512_IV[0]|0,this.Al=s.SHA512_IV[1]|0,this.Bh=s.SHA512_IV[2]|0,this.Bl=s.SHA512_IV[3]|0,this.Ch=s.SHA512_IV[4]|0,this.Cl=s.SHA512_IV[5]|0,this.Dh=s.SHA512_IV[6]|0,this.Dl=s.SHA512_IV[7]|0,this.Eh=s.SHA512_IV[8]|0,this.El=s.SHA512_IV[9]|0,this.Fh=s.SHA512_IV[10]|0,this.Fl=s.SHA512_IV[11]|0,this.Gh=s.SHA512_IV[12]|0,this.Gl=s.SHA512_IV[13]|0,this.Hh=s.SHA512_IV[14]|0,this.Hl=s.SHA512_IV[15]|0}get(){const{Ah:E,Al:v,Bh:l,Bl:b,Ch:m,Cl:V,Dh:A,Dl:I,Eh:T,El:U,Fh:t,Fl:n,Gh:h,Gl:o,Hh:c,Hl:a}=this;return[E,v,l,b,m,V,A,I,T,U,t,n,h,o,c,a]}set(E,v,l,b,m,V,A,I,T,U,t,n,h,o,c,a){this.Ah=E|0,this.Al=v|0,this.Bh=l|0,this.Bl=b|0,this.Ch=m|0,this.Cl=V|0,this.Dh=A|0,this.Dl=I|0,this.Eh=T|0,this.El=U|0,this.Fh=t|0,this.Fl=n|0,this.Gh=h|0,this.Gl=o|0,this.Hh=c|0,this.Hl=a|0}process(E,v){for(let f=0;f<16;f++,v+=4)u[f]=E.getUint32(v),w[f]=E.getUint32(v+=4);for(let f=16;f<80;f++){const F=u[f-15]|0,O=w[f-15]|0,p=i.rotrSH(F,O,1)^i.rotrSH(F,O,8)^i.shrSH(F,O,7),q=i.rotrSL(F,O,1)^i.rotrSL(F,O,8)^i.shrSL(F,O,7),B=u[f-2]|0,L=w[f-2]|0,k=i.rotrSH(B,L,19)^i.rotrBH(B,L,61)^i.shrSH(B,L,6),R=i.rotrSL(B,L,19)^i.rotrBL(B,L,61)^i.shrSL(B,L,6),$=i.add4L(q,R,w[f-7],w[f-16]),J=i.add4H($,p,k,u[f-7],u[f-16]);u[f]=J|0,w[f]=$|0}let{Ah:l,Al:b,Bh:m,Bl:V,Ch:A,Cl:I,Dh:T,Dl:U,Eh:t,El:n,Fh:h,Fl:o,Gh:c,Gl:a,Hh:j,Hl:D}=this;for(let f=0;f<80;f++){const F=i.rotrSH(t,n,14)^i.rotrSH(t,n,18)^i.rotrBH(t,n,41),O=i.rotrSL(t,n,14)^i.rotrSL(t,n,18)^i.rotrBL(t,n,41),p=t&h^~t&c,q=n&o^~n&a,B=i.add5L(D,O,q,C[f],w[f]),L=i.add5H(B,j,F,p,g[f],u[f]),k=B|0,R=i.rotrSH(l,b,28)^i.rotrBH(l,b,34)^i.rotrBH(l,b,39),$=i.rotrSL(l,b,28)^i.rotrBL(l,b,34)^i.rotrBL(l,b,39),J=l&m^l&A^m&A,X=b&V^b&I^V&I;j=c|0,D=a|0,c=h|0,a=o|0,h=t|0,o=n|0,{h:t,l:n}=i.add(T|0,U|0,L|0,k|0),T=A|0,U=I|0,A=m|0,I=V|0,m=l|0,V=b|0;const Q=i.add3L(k,$,X);l=i.add3H(Q,L,R,J),b=Q|0}({h:l,l:b}=i.add(this.Ah|0,this.Al|0,l|0,b|0)),{h:m,l:V}=i.add(this.Bh|0,this.Bl|0,m|0,V|0),{h:A,l:I}=i.add(this.Ch|0,this.Cl|0,A|0,I|0),{h:T,l:U}=i.add(this.Dh|0,this.Dl|0,T|0,U|0),{h:t,l:n}=i.add(this.Eh|0,this.El|0,t|0,n|0),{h,l:o}=i.add(this.Fh|0,this.Fl|0,h|0,o|0),{h:c,l:a}=i.add(this.Gh|0,this.Gl|0,c|0,a|0),{h:j,l:D}=i.add(this.Hh|0,this.Hl|0,j|0,D|0),this.set(l,b,m,V,A,I,T,U,t,n,h,o,c,a,j,D)}roundClean(){(0,H.clean)(u,w)}destroy(){(0,H.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};e.SHA512=x;var P=class extends x{constructor(){super(48),this.Ah=s.SHA384_IV[0]|0,this.Al=s.SHA384_IV[1]|0,this.Bh=s.SHA384_IV[2]|0,this.Bl=s.SHA384_IV[3]|0,this.Ch=s.SHA384_IV[4]|0,this.Cl=s.SHA384_IV[5]|0,this.Dh=s.SHA384_IV[6]|0,this.Dl=s.SHA384_IV[7]|0,this.Eh=s.SHA384_IV[8]|0,this.El=s.SHA384_IV[9]|0,this.Fh=s.SHA384_IV[10]|0,this.Fl=s.SHA384_IV[11]|0,this.Gh=s.SHA384_IV[12]|0,this.Gl=s.SHA384_IV[13]|0,this.Hh=s.SHA384_IV[14]|0,this.Hl=s.SHA384_IV[15]|0}};e.SHA384=P;const y=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),d=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);var N=class extends x{constructor(){super(28),this.Ah=y[0]|0,this.Al=y[1]|0,this.Bh=y[2]|0,this.Bl=y[3]|0,this.Ch=y[4]|0,this.Cl=y[5]|0,this.Dh=y[6]|0,this.Dl=y[7]|0,this.Eh=y[8]|0,this.El=y[9]|0,this.Fh=y[10]|0,this.Fl=y[11]|0,this.Gh=y[12]|0,this.Gl=y[13]|0,this.Hh=y[14]|0,this.Hl=y[15]|0}};e.SHA512_224=N;var W=class extends x{constructor(){super(32),this.Ah=d[0]|0,this.Al=d[1]|0,this.Bh=d[2]|0,this.Bl=d[3]|0,this.Ch=d[4]|0,this.Cl=d[5]|0,this.Dh=d[6]|0,this.Dl=d[7]|0,this.Eh=d[8]|0,this.El=d[9]|0,this.Fh=d[10]|0,this.Fl=d[11]|0,this.Gh=d[12]|0,this.Gl=d[13]|0,this.Hh=d[14]|0,this.Hl=d[15]|0}};e.SHA512_256=W,e.sha256=(0,H.createHasher)(()=>new r),e.sha224=(0,H.createHasher)(()=>new _),e.sha512=(0,H.createHasher)(()=>new x),e.sha384=(0,H.createHasher)(()=>new P),e.sha512_256=(0,H.createHasher)(()=>new W),e.sha512_224=(0,H.createHasher)(()=>new N)}}),nt=z({"../../node_modules/@noble/curves/utils.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.notImplemented=e.bitMask=e.utf8ToBytes=e.randomBytes=e.isBytes=e.hexToBytes=e.concatBytes=e.bytesToUtf8=e.bytesToHex=e.anumber=e.abytes=void 0,e.abool=G,e.numberToHexUnpadded=r,e.hexToNumber=_,e.bytesToNumberBE=S,e.bytesToNumberLE=g,e.numberToBytesBE=C,e.numberToBytesLE=u,e.numberToVarBytesBE=w,e.ensureBytes=x,e.equalBytes=P,e.inRange=d,e.aInRange=N,e.bitLen=W,e.bitGet=E,e.bitSet=v,e.createHmacDrbg=b,e.validateObject=V,e.isHash=A,e._validateObject=I,e.memoized=U;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const s=K();var i=K();Object.defineProperty(e,"abytes",{enumerable:!0,get:function(){return i.abytes}}),Object.defineProperty(e,"anumber",{enumerable:!0,get:function(){return i.anumber}}),Object.defineProperty(e,"bytesToHex",{enumerable:!0,get:function(){return i.bytesToHex}}),Object.defineProperty(e,"bytesToUtf8",{enumerable:!0,get:function(){return i.bytesToUtf8}}),Object.defineProperty(e,"concatBytes",{enumerable:!0,get:function(){return i.concatBytes}}),Object.defineProperty(e,"hexToBytes",{enumerable:!0,get:function(){return i.hexToBytes}}),Object.defineProperty(e,"isBytes",{enumerable:!0,get:function(){return i.isBytes}}),Object.defineProperty(e,"randomBytes",{enumerable:!0,get:function(){return i.randomBytes}}),Object.defineProperty(e,"utf8ToBytes",{enumerable:!0,get:function(){return i.utf8ToBytes}});const H=BigInt(0),M=BigInt(1);function G(t,n){if(typeof n!="boolean")throw new Error(t+" boolean expected, got "+n)}function r(t){const n=t.toString(16);return n.length&1?"0"+n:n}function _(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?H:BigInt("0x"+t)}function S(t){return _((0,s.bytesToHex)(t))}function g(t){return(0,s.abytes)(t),_((0,s.bytesToHex)(Uint8Array.from(t).reverse()))}function C(t,n){return(0,s.hexToBytes)(t.toString(16).padStart(n*2,"0"))}function u(t,n){return C(t,n).reverse()}function w(t){return(0,s.hexToBytes)(r(t))}function x(t,n,h){let o;if(typeof n=="string")try{o=(0,s.hexToBytes)(n)}catch(a){throw new Error(t+" must be hex string or Uint8Array, cause: "+a)}else if((0,s.isBytes)(n))o=Uint8Array.from(n);else throw new Error(t+" must be hex string or Uint8Array");const c=o.length;if(typeof h=="number"&&c!==h)throw new Error(t+" of length "+h+" expected, got "+c);return o}function P(t,n){if(t.length!==n.length)return!1;let h=0;for(let o=0;o<t.length;o++)h|=t[o]^n[o];return h===0}const y=t=>typeof t=="bigint"&&H<=t;function d(t,n,h){return y(t)&&y(n)&&y(h)&&n<=t&&t<h}function N(t,n,h,o){if(!d(n,h,o))throw new Error("expected valid "+t+": "+h+" <= n < "+o+", got "+n)}function W(t){let n;for(n=0;t>H;t>>=M,n+=1);return n}function E(t,n){return t>>BigInt(n)&M}function v(t,n,h){return t|(h?M:H)<<BigInt(n)}const l=t=>(M<<BigInt(t))-M;e.bitMask=l;function b(t,n,h){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof n!="number"||n<2)throw new Error("qByteLen must be a number");if(typeof h!="function")throw new Error("hmacFn must be a function");const o=B=>new Uint8Array(B),c=B=>Uint8Array.of(B);let a=o(t),j=o(t),D=0;const f=()=>{a.fill(1),j.fill(0),D=0},F=(...B)=>h(j,a,...B),O=(B=o(0))=>{j=F(c(0),B),a=F(),B.length!==0&&(j=F(c(1),B),a=F())},p=()=>{if(D++>=1e3)throw new Error("drbg: tried 1000 values");let B=0;const L=[];for(;B<n;){a=F();const k=a.slice();L.push(k),B+=a.length}return(0,s.concatBytes)(...L)};return(B,L)=>{f(),O(B);let k;for(;!(k=L(p()));)O();return f(),k}}const m={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||(0,s.isBytes)(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,n)=>n.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function V(t,n,h={}){const o=(c,a,j)=>{const D=m[a];if(typeof D!="function")throw new Error("invalid validator function");const f=t[c];if(!(j&&f===void 0)&&!D(f,t))throw new Error("param "+String(c)+" is invalid. Expected "+a+", got "+f)};for(const[c,a]of Object.entries(n))o(c,a,!1);for(const[c,a]of Object.entries(h))o(c,a,!0);return t}function A(t){return typeof t=="function"&&Number.isSafeInteger(t.outputLen)}function I(t,n,h={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function o(c,a,j){const D=t[c];if(j&&D===void 0)return;const f=typeof D;if(f!==a||D===null)throw new Error(`param "${c}" is invalid: expected ${a}, got ${f}`)}Object.entries(n).forEach(([c,a])=>o(c,a,!1)),Object.entries(h).forEach(([c,a])=>o(c,a,!0))}const T=()=>{throw new Error("not implemented")};e.notImplemented=T;function U(t){const n=new WeakMap;return(h,...o)=>{const c=n.get(h);if(c!==void 0)return c;const a=t(h,...o);return n.set(h,a),a}}}});export{Z as require__md,st as require_sha2,nt as require_utils};
