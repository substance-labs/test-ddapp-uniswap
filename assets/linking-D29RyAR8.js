import{__toESM as b}from"./chunk-DgAfPHQg.js";import{colorsLight as $}from"./src-DOOtfpHS.js";import{logger as S}from"./hooks-BXO4d1DJ.js";import{Chain as D,UniverseChainId as N,getChainInfo as k,toGraphQLChain as F}from"./utils-BX1Fu73x.js";import{NATIVE_TOKEN_PLACEHOLDER as H,buildCurrencyId as B,currencyIdToGraphQLAddress as M,getNativeAddress as V,isNativeCurrencyAddress as K}from"./currencyId-Ci6selsx.js";import{require_cjs as L}from"./Loader-D83W8G1W.js";var A;const j="NATIVE";function Ae(e,t){const n=V(t);return e!==j&&e!==n?e:M(B(t,n))}var y=class extends Error{constructor(e,t){super(t),this.code=e}};const U=typeof window<"u"&&!!(!((A=window.document)===null||A===void 0)&&A.createElement),G=U&&!!(window.addEventListener||window.attachEvent),W=U&&!!window.screen,z=!1;var X=b(L());const q=typeof window<"u"?X.Platform.select:function(t){if(t.hasOwnProperty("web"))return t.web;if(t.hasOwnProperty("default"))return t.default},Q={OS:"web",select:q,isDOMAvailable:U,canUseEventListeners:G,canUseViewport:W,isAsyncDebugging:z};var Y=Q,Z=class extends y{constructor(e,t){super("ERR_UNAVAILABLE",`The method or property ${e}.${t} is not available on ${Y.OS}, are you sure you've linked all the native dependencies properly?`)}},l;(function(e){e.CANCEL="cancel",e.DISMISS="dismiss",e.OPENED="opened",e.LOCKED="locked"})(l||(l={}));var C;(function(e){e.FULL_SCREEN="fullScreen",e.PAGE_SHEET="pageSheet",e.FORM_SHEET="formSheet",e.CURRENT_CONTEXT="currentContext",e.OVER_FULL_SCREEN="overFullScreen",e.OVER_CURRENT_CONTEXT="overCurrentContext",e.POPOVER="popover",e.AUTOMATIC="automatic"})(C||(C={}));var J=b(L());const ee=500,te=650;let s=null;const h=new Map,d=()=>"ExpoWebBrowserRedirectHandle",v=e=>`ExpoWebBrowser_OriginUrl_${e}`,R=e=>`ExpoWebBrowser_RedirectUrl_${e}`;function O(e){return(e.origin.replace(e.protocol,"").replace(/^\/+/,"").replace(/\/+$/,"")+decodeURI(e.pathname.replace(/\/{2,}/g,"/"))).toLowerCase()}function g(){if(s&&(s.close(),h.has(s))){const{listener:e,appStateSubscription:t,interval:n}=h.get(s);clearInterval(n),window.removeEventListener("message",e),t.remove(),h.delete(s);const r=window.localStorage.getItem(d());r&&(window.localStorage.removeItem(d()),window.localStorage.removeItem(v(r)),window.localStorage.removeItem(R(r))),s=null}}var T={async openBrowserAsync(e,t={}){if(typeof window>"u")return{type:l.CANCEL};const{windowName:n="_blank",windowFeatures:r}=t,i=P(r);return window.open(e,n,i),{type:l.OPENED}},dismissAuthSession(){typeof window>"u"||g()},maybeCompleteAuthSession({skipRedirectCheck:e}){if(typeof window>"u")return{type:"failed",message:"Cannot use expo-web-browser in a non-browser environment"};const t=window.localStorage.getItem(d());if(!t)return{type:"failed",message:"No auth session is currently in progress"};const n=window.location.href;if(e!==!0){const i=window.localStorage.getItem(R(t)),o=O(window.location);if(i!==o)return{type:"failed",message:`Current URL "${o}" and original redirect URL "${i}" do not match.`}}window.localStorage.setItem(v(t),n);const r=window.opener??window.parent;if(!r)throw new y("ERR_WEB_BROWSER_REDIRECT","The window cannot complete the redirect request because the invoking window doesn't have a reference to it's parent. This can happen if the parent window was reloaded.");return r.postMessage({url:n,expoSender:t},r.location.toString()),{type:"success",message:"Attempting to complete auth"}},async openAuthSessionAsync(e,t,n){if(typeof window>"u")return{type:l.CANCEL};if(t=t??oe(e),s==null||s!=null&&s.closed){const o=P(n==null?void 0:n.windowFeatures);if(s=window.open(e,n==null?void 0:n.windowName,o),s)try{s.focus()}catch{}else throw new y("ERR_WEB_BROWSER_BLOCKED","Popup window was blocked by the browser or failed to open. This can happen in mobile browsers when the window.open() method was invoked too long after a user input was fired.")}const r=await re(e);window.localStorage.setItem(d(),r);const i=(()=>{if(!t)return t;try{return O(new URL(t))}catch{return t}})();return window.localStorage.setItem(R(r),i),new Promise(async o=>{const c=w=>{if(!w.isTrusted||w.origin!==window.location.origin)return;const{data:f}=w,m=window.localStorage.getItem(d());f.expoSender===m&&(g(),o({type:"success",url:f.url}))};window.addEventListener("message",c,!1);const u=w=>{if(w!=="active")return;const f=window.localStorage.getItem(d());if(f){const m=window.localStorage.getItem(v(f));m&&(g(),o({type:"success",url:m}))}},a=J.AppState.addEventListener("change",u),I=setInterval(()=>{s!=null&&s.closed&&(o&&o({type:l.DISMISS}),clearInterval(I),g())},1e3);h.set(s,{listener:c,interval:I,appStateSubscription:a})})}};function x(){var e;return typeof window>"u"?!1:!!(!((e=window)===null||e===void 0)&&e.crypto)}function ne(){return x()?!!window.crypto.subtle:!1}async function re(e){const t=new URL(e);return t.searchParams.has("state")&&typeof t.searchParams.get("state")=="string"?t.searchParams.get("state"):await ie()}function oe(e){const t=new URL(e);return t.searchParams.has("redirect_uri")&&typeof t.searchParams.get("redirect_uri")=="string"?t.searchParams.get("redirect_uri"):location.origin+location.pathname}const _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";async function ie(){if(!ne())throw new y("ERR_WEB_BROWSER_CRYPTO","The current environment doesn't support crypto. Ensure you are running from a secure origin (localhost/https).");const e=new TextEncoder,t=se(10),n=e.encode(t),r=await crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode(...new Uint8Array(r)))}function se(e){let t=new Uint8Array(e);t.byteLength!==t.length&&(t=new Uint8Array(t.buffer));const n=new Uint8Array(t.length);if(x())window.crypto.getRandomValues(n);else for(let r=0;r<e;r+=1)n[r]=Math.random()*_.length|0;return ae(n)}function ae(e){const t=[];for(let n=0;n<e.byteLength;n+=1){const r=e[n]%_.length;t.push(_[r])}return t.join("")}function ce(e){let t={};if(typeof e=="string"){const n=e.split(",");for(const r of n){const[i,o]=r.trim().split("=");i&&o&&(t[i]=o)}}else e&&(t=e);return t}function P(e){const t=ce(e),n=t.width??ee,r=t.height??te,i=t.top??Math.max(0,(window.screen.height-r)*.5),o=t.left??Math.max(0,(window.screen.width-n)*.5);return le({...t,toolbar:t.toolbar??"no",menubar:t.menubar??"no",location:t.location??"yes",resizable:t.resizable??"yes",status:t.status??"no",scrollbars:t.scrollbars??"yes",top:i,left:o,width:n,height:r})}function le(e){return Object.keys(e).reduce((t,n)=>{let r=e[n];return typeof r=="boolean"&&(r=r?"yes":"no"),n&&r?(t&&(t+=","),`${t}${n}=${r}`):t},"")}var E=b(L());async function ue(e,t={}){if(!T.openBrowserAsync)throw new Z("WebBrowser","openBrowserAsync");let n;try{n=await T.openBrowserAsync(e,de(t))}catch{return{type:l.LOCKED}}return n}function de(e){return{...e,controlsColor:(0,E.processColor)(e.controlsColor),toolbarColor:(0,E.processColor)(e.toolbarColor),secondaryToolbarColor:(0,E.processColor)(e.secondaryToolbarColor)}}let Ce=E.AppState.currentState!==null;async function we(e){return window.open(e)}async function fe(e){return!0}const pe=["http://","https://"];async function ve({uri:e,openExternalBrowser:t=!1,isSafeUri:n=!1,controlsColor:r=$.accent1,throwOnError:i=!1}){const o=e.trim();if(!n&&!pe.some(a=>o.startsWith(a))){const a=new Error("User attempted to open potentially unsafe url");if(S.error(a,{tags:{file:"linking",function:"openUri"},extra:{uri:e}}),i)throw a;return}if(!(/^https?:\/\//.test(o)?!0:await fe(e))){const a=new Error(`Cannot open URI: ${e}`);if(S.warn("linking","openUri",a.message),i)throw a;return}try{t?await we(e):await ue(e,{controlsColor:r,presentationStyle:C.FULL_SCREEN,showInRecents:!0,windowFeatures:"popup=false"})}catch(a){if(S.error(a,{tags:{file:"linking",function:"openUri"},extra:{uri:e}}),i)throw a}}let p=(function(e){return e.TRANSACTION="transaction",e.TOKEN="token",e.ADDRESS="address",e.BLOCK="block",e.NFT="nft",e.NATIVE="native",e})({});function Re({chainId:e,data:t,type:n}){const{explorer:r,nativeCurrency:i}=k(e),o=r.url;if(!t)return o;switch(n){case p.TRANSACTION:return`${o}tx/${t}`;case p.TOKEN:return t===i.address&&i.explorerLink?i.explorerLink:`${o}token/${t}`;case p.BLOCK:return e===N.Optimism?`${o}tx/${t}`:`${o}block/${t}`;case p.ADDRESS:return`${o}address/${t}`;case p.NFT:if(e===N.Zora){const c=t.split("/"),u=c[0]??"",a=c[1]??"";return`${o}token/${u}/instance/${a}`}return`${o}nft/${t}`;default:return o}}function _e({address:e,chain:t,chainUrlParam:n,inputAddress:r}){if(!t)return"/not-found";const i=F(t),o=K(t,e)?H:e,c=n||String(i).toLowerCase()||D.Ethereum.toLowerCase(),u=r?`?inputCurrency=${r}`:"";return`/explore/tokens/${c}/${o}${u}`}function be(e,t){return`/explore/pools/${k(t).urlParam}/${e}`}export{p as ExplorerDataType,Re as getExplorerLink,be as getPoolDetailsURL,_e as getTokenDetailsURL,ve as openUri,Ae as tokenAddressOrNativeAddress};
