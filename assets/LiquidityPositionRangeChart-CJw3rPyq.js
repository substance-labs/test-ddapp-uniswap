import{__toESM as yt}from"./chunk-DgAfPHQg.js";import{require_react as bi}from"./react-CNoFhWkx.js";import{Circle as Ti,ClipPath as ji,Defs as Ii,G as vt,Path as Si,Rect as P,Svg as hi,createIcon as fi,opacify as dt,useSporeColors as tt,zIndexes as At}from"./src-DOOtfpHS.js";import{useTranslation as Ei}from"./useTranslation-BotBuoJf.js";import{isMobileWeb as Ai}from"./index.web-BqgtOHN3.js";import{ReactQueryCacheKey as Ni}from"./cache-BFZkIToX.js";import{require_jsx_runtime as Oi}from"./jsx-runtime-D7bMTQeG.js";import{useEnabledChains as qi}from"./useEnabledChains-DuB86c95.js";import{logger as Nt}from"./hooks-BXO4d1DJ.js";import{CurrencyAmount as ft,HistoryDuration as Ri,Percent as ut,UniverseChainId as Mi,V3_CORE_FACTORY_ADDRESSES as pi,ZERO_ADDRESS as $,getChainInfo as Bi,init_jsbi as _t,init_sdk_core_esm as Q,jsbi_default as E,toGraphQLChain as Ot,useAllV3TicksQuery as Vi,useAllV4TicksQuery as Di,usePoolPriceHistoryQuery as Fi}from"./utils-BX1Fu73x.js";import{BigNumber as $i,init_lib$5 as Hi}from"./lib-DPFIyRke.js";import{Pool as mi,init_v4_sdk_esm as kt,tickToPrice as Lt}from"./V3DutchOrderTrade-Cl7yELmp.js";import{Pool as Pt,TICK_SPACINGS as z,TickMath as W,init_v3_sdk_esm as Ct,tickToPrice as wt}from"./v3-sdk.esm-CHH6GWR1.js";import{useQuery as zi}from"./useQuery-D_ZCw8XG.js";import{require_ms as Ui}from"./ms-BqmEYo6j.js";import{useUSDCValue as qt}from"./useUSDCPrice-HO7Wgroz.js";import{PositionStatus as Y,ProtocolVersion as N}from"./types_pb-yZxlo4b1.js";import{NumberType as Z}from"./types-JuyYLR0O.js";import{formatNumber as Ki,useLocalizationContext as pt}from"./LocalizationContext-B31peW1_.js";import{useSupportedChainId as Gi}from"./useSupportedChainId-DskHoisQ.js";import{Flex as D,Shine as vi,Text as F,iconSizes as Rt}from"./Loader-D83W8G1W.js";import{removeOutliers as Xi}from"./prices-BzyZhpWW.js";import{usePrevious as Wi}from"./usePrevious-CggM0Zir.js";import{useMultichainContext as Qi}from"./useMultichainContext-BVmgxqO2.js";import{ErrorBoundary as Yi}from"./ErrorBoundary-oYzyK_hY.js";import{useResizeObserver as Ji}from"./bundle.esm-B4P3X753.js";import{tryParseCurrencyAmount as Mt}from"./tryParseCurrencyAmount-Bt3FPZDG.js";import{DoubleCurrencyLogo as Bt}from"./DoubleLogo-D40dQ2P7.js";import{brushY as Zi,linear as Vt,select_default as G}from"./AdaptiveDropdown-Cv1C9ooR.js";import{Chart as te,ChartModel as xi,ChartType as ie,DEFAULT_BOTTOM_PRICE_SCALE_MARGIN as ee,DEFAULT_TOP_PRICE_SCALE_MARGIN as oe,DataQuality as gt,PriceChartType as re,Te as ne,c as Dt,calculateColumnPositionsInPlace as se,d as ae,formatTickMarks as le,ot as ce,positionsBox as de,roundRect as Ft}from"./util-CfowgtYu.js";import{getBaseAndQuoteCurrencies as ue,getTokenOrZeroAddress as $t}from"./currency-Brc-ymXr.js";import{poolEnabledProtocolVersion as he}from"./protocolVersion-Djp_Gxjw.js";import{useGetPoolsByTokens as fe}from"./networkSupportsV4-CXcYAtrx.js";import{PoolCache as pe}from"./usePools-Bz9FGvMj.js";import{isOutOfRange as me}from"./priceRangeInfo-DbHE3vOq.js";var I=(function(i){function t(n){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t(n)}function e(n,s){if(t(n)!="object"||!n)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var c=a.call(n,s||"default");if(t(c)!="object")return c;throw TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}function o(n){var s=e(n,"string");return t(s)=="symbol"?s:s+""}function l(n,s,a){return(s=o(s))in n?Object.defineProperty(n,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[s]=a,n}return i.defineProperty=l,i})({}),r=yt(Oi());const[ve,Bo]=fi({name:"HorizontalDensityChart",getIcon:i=>(0,r.jsxs)(hi,{viewBox:"0 0 124 160",fill:"none",...i,children:[(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 10)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 13.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 17.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 21.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 28.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 32.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 36.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 40)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 43.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 47.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 51.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 55)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 58.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 62.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 66.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 70)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 73.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 77.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 81.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 85)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 88.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 92.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 96.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 100)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 103.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 107.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 111.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 115)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 118.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 122.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 126.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 130)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 133.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 137.5)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 141.25)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 145)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 148.75)",fill:"currentColor",fillOpacity:"0.6"}),(0,r.jsx)(P,{width:"60",height:"1",rx:"0.5",transform:"matrix(1 0 0 -1 84 152.5)",fill:"currentColor",fillOpacity:"0.6"})]}),defaultFill:"#5E5E5E"}),[gi,Vo]=fi({name:"LoadingPriceCurve",getIcon:i=>(0,r.jsxs)(hi,{viewBox:"0 0 224 52",fill:"none",...i,children:[(0,r.jsxs)(vt,{clipPath:"url(#clip0_6507_58835)",children:[(0,r.jsx)("mask",{id:"mask0_6507_58835",mask:"alpha",maskUnits:"userSpaceOnUse",x:"-1",y:"0",width:"229",height:"35",children:(0,r.jsx)(Si,{d:"M0 17.3223L2.27128 15.3383L4.54257 13.3855L6.81385 11.4949L9.08514 9.6961L11.3564 8.0176L13.6277 6.4859L15.899 5.125L18.1703 3.9565L20.4416 2.9988L22.7128 2.267L24.9841 1.7726L27.2554 1.5234H29.5267L31.798 1.7726L34.0693 2.267L36.3406 2.9988L38.6118 3.9565L40.8831 5.125L43.1544 6.4859L45.4257 8.0176L47.697 9.6961L49.9683 11.4949L52.2396 13.3855L54.5108 15.3383L56.7821 17.3223L59.0534 19.3064L61.3247 21.2591L63.596 23.1498L65.8673 24.9485L68.1385 26.627L70.4098 28.1588L72.6811 29.5196L74.9524 30.6881L77.2237 31.6458L79.495 32.3777L81.7663 32.872L84.0375 33.1212H86.3088L88.5801 32.872L90.8514 32.3777L93.1227 31.6458L95.394 30.6881L97.6653 29.5196L99.9365 28.1588L102.208 26.627L104.479 24.9485L106.75 23.1498L109.022 21.2591L111.293 19.3064L113.564 17.3223L115.836 15.3383L118.107 13.3855L120.378 11.4949L122.649 9.6961L124.921 8.0176L127.192 6.4859L129.463 5.125L131.735 3.9565L134.006 2.9988L136.277 2.267L138.548 1.7726L140.82 1.5234L143.091 1.5234L145.362 1.7726L147.634 2.267L149.905 2.9988L152.176 3.9565L154.447 5.125L156.719 6.4859L158.99 8.0176L161.261 9.6961L163.533 11.4949L165.804 13.3855L168.075 15.3383L170.346 17.3223L172.618 19.3064L174.889 21.2591L177.16 23.1498L179.432 24.9485L181.703 26.627L183.974 28.1588L186.245 29.5196L188.517 30.6881L190.788 31.6458L193.059 32.3777L195.331 32.872L197.602 33.1212H199.873L202.144 32.872L204.416 32.3777L206.687 31.6458L208.958 30.6881L211.229 29.5196L213.501 28.1588L215.772 26.627L218.043 24.9485L220.315 23.1498L222.586 21.2591L224.857 19.3064L227.128 17.3223",stroke:"currentColor",strokeWidth:"2"})}),(0,r.jsxs)(vt,{mask:"url(#mask0_6507_58835)",children:[(0,r.jsx)(P,{width:"224",height:"76.9609",rx:"1.2514",fill:"currentColor",fillOpacity:"0.12"}),(0,r.jsx)(vt,{filter:"url(#filter0_f_6507_58835)",children:(0,r.jsx)(Ti,{cx:"-0.156054",cy:"19.1994",r:"17.676",fill:"currentColor",fillOpacity:"0.24"})})]})]}),(0,r.jsxs)(Ii,{children:[(0,r.jsxs)("filter",{id:"filter0_f_6507_58835",x:"-20.9605",y:"-1.60505",width:"41.6085",height:"41.6085",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,r.jsx)("feFlood",{result:"BackgroundImageFix",floodOpacity:"0"}),(0,r.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,r.jsx)("feGaussianBlur",{stdDeviation:"1.56425",result:"effect1_foregroundBlur_6507_58835"})]}),(0,r.jsx)(ji,{id:"clip0_6507_58835",children:(0,r.jsx)(P,{width:"224",height:"52",fill:"currentColor"})})]})]})});function xe(i,t){let e;if(t===void 0)for(const o of i)o!=null&&(e<o||e===void 0&&o>=o)&&(e=o);else{let o=-1;for(let l of i)(l=t(l,++o,i))!=null&&(e<l||e===void 0&&l>=l)&&(e=l)}return e}function ge(i){return i}var xt=1,lt=2,Ht=3,rt=4,zt=1e-6;function ye(i){return"translate("+i+",0)"}function _e(i){return"translate(0,"+i+")"}function ke(i){return t=>+i(t)}function Le(i,t){return t=Math.max(0,i.bandwidth()-t*2)/2,i.round()&&(t=Math.round(t)),e=>+i(e)+t}function Pe(){return!this.__axis}function Ce(i,t){var e=[],o=null,l=null,n=6,s=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,h=i===xt||i===rt?-1:1,f=i===rt||i===lt?"x":"y",d=i===xt||i===Ht?ye:_e;function p(u){var m=o??(t.ticks?t.ticks.apply(t,e):t.domain()),x=l??(t.tickFormat?t.tickFormat.apply(t,e):ge),g=Math.max(n,0)+a,w=t.range(),v=+w[0]+c,C=+w[w.length-1]+c,b=(t.bandwidth?Le:ke)(t.copy(),c),_=u.selection?u.selection():u,k=_.selectAll(".domain").data([null]),L=_.selectAll(".tick").data(m,t).order(),A=L.exit(),y=L.enter().append("g").attr("class","tick"),T=L.select("line"),O=L.select("text");k=k.merge(k.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge(y),T=T.merge(y.append("line").attr("stroke","currentColor").attr(f+"2",h*n)),O=O.merge(y.append("text").attr("fill","currentColor").attr(f,h*g).attr("dy",i===xt?"0em":i===Ht?"0.71em":"0.32em")),u!==_&&(k=k.transition(u),L=L.transition(u),T=T.transition(u),O=O.transition(u),A=A.transition(u).attr("opacity",zt).attr("transform",function(j){return isFinite(j=b(j))?d(j+c):this.getAttribute("transform")}),y.attr("opacity",zt).attr("transform",function(j){var q=this.parentNode.__axis;return d((q&&isFinite(q=q(j))?q:b(j))+c)})),A.remove(),k.attr("d",i===rt||i===lt?s?"M"+h*s+","+v+"H"+c+"V"+C+"H"+h*s:"M"+c+","+v+"V"+C:s?"M"+v+","+h*s+"V"+c+"H"+C+"V"+h*s:"M"+v+","+c+"H"+C),L.attr("opacity",1).attr("transform",function(j){return d(b(j)+c)}),T.attr(f+"2",h*n),O.attr(f,h*g).text(x),_.filter(Pe).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",i===lt?"start":i===rt?"end":"middle"),_.each(function(){this.__axis=b})}return p.scale=function(u){return arguments.length?(t=u,p):t},p.ticks=function(){return e=Array.from(arguments),p},p.tickArguments=function(u){return arguments.length?(e=u==null?[]:Array.from(u),p):e.slice()},p.tickValues=function(u){return arguments.length?(o=u==null?null:Array.from(u),p):o&&o.slice()},p.tickFormat=function(u){return arguments.length?(l=u,p):l},p.tickSize=function(u){return arguments.length?(n=s=+u,p):n},p.tickSizeInner=function(u){return arguments.length?(n=+u,p):n},p.tickSizeOuter=function(u){return arguments.length?(s=+u,p):s},p.tickPadding=function(u){return arguments.length?(a=+u,p):a},p.offset=function(u){return arguments.length?(c=+u,p):c},p}function we(i){return Ce(lt,i)}var S=yt(bi());const X=5,be=({axisGenerator:i,yScale:t,height:e})=>{const o=l=>{G(l).call(i).call(n=>n.select(".domain").remove()).call(n=>n.selectAll("text").attr("transform",function(s){const a=t(s);return a<X?`translate(0, ${X})`:a>e-X?`translate(0, ${-X})`:""}))};return(0,r.jsx)("g",{ref:o})},Te=({yScale:i,offset:t=0,min:e,current:o,max:l,height:n})=>{const{formatNumberOrString:s}=pt(),a=(0,S.useMemo)(()=>{const c=e?i(e):void 0,h=l?i(l):void 0,f=o?i(o):void 0;return c&&f&&Math.abs(c-f)<X?[e,l].filter(Boolean):h&&f&&Math.abs(h-f)<X?[e,l].filter(Boolean):[e,o,l].filter(Boolean)},[o,l,e,i]);return(0,r.jsx)("g",{transform:`translate(${t}, 0)`,className:"axis-right",children:(0,r.jsx)(be,{axisGenerator:we(i).tickValues(a).tickFormat(c=>s({value:c,type:Z.TokenQuantityStats})),height:n,yScale:i})})},Ut=i=>["M 0 0",`h ${i}`].join(" "),Kt=i=>["M 0 0",`m ${i/2-15} 8`,"h 30"].join(" "),Gt=({color:i,size:t=6})=>{const e=t/3;return(0,r.jsx)("polygon",{points:`0 0, ${t} ${t}, 0 ${t}`,transform:`translate(${e}, ${e}) rotate(-45) translate(-${e}, -${e})`,fill:i,stroke:i,strokeWidth:"4",strokeLinejoin:"round"})},Xt=20,Wt=2,Qt=(i,t,e)=>{const o=i.map(n=>e(n).toFixed(1)),l=t.map(n=>e(n).toFixed(1));return o.every((n,s)=>n===l[s])},Yt=(i,t)=>[t(i[1]),t(i[0])],Jt=(i,t)=>[t.invert(i[1]),t.invert(i[0])],U=i=>i[0]<i[1]?i:[i[1],i[0]],je=({id:i,yScale:t,interactive:e,brushExtent:o,setBrushExtent:l,hideHandles:n,width:s,height:a})=>{const c=tt(),h=(0,S.useRef)(null),f=(0,S.useRef)(null),{t:d}=Ei(),[p,u]=(0,S.useState)(o),m=Wi(o),x=(0,S.useRef)(!1);(0,S.useEffect)(()=>{x.current||u(o)},[o]),(0,S.useEffect)(()=>{if(!h.current)return;const L=U(o),A=Yt(L,t);f.current=Zi().extent([[0,Wt],[s,a-Wt]]).handleSize(30).filter(()=>e).filter(y=>{const T=y.target;return T.classList.contains("selection")||T.classList.contains("handle")}).on("brush",y=>{const{selection:T}=y;if(x.current=!0,!T){u(null);return}const O=U(Jt(T,t));u(O)}).on("end",y=>{const{selection:T,mode:O}=y;if(!T){u(null);return}const j=U(Jt(T,t));Qt(L,j,t)||l(j,O),u(j),x.current=!1}),f.current(G(h.current)),!x.current&&m&&Qt(L,U(m),t)&&G(h.current).transition().call(f.current.move,A),G(h.current).selectAll(".overlay").attr("cursor","default"),G(h.current).selectAll(".selection").attr("stroke","none").attr("fill-opacity","0.1").attr("fill",`url(#${i}-gradient-selection)`).attr("cursor","grab")},[o,i,a,e,m,t,s,l]),(0,S.useEffect)(()=>{!h.current||!f.current||f.current.move(G(h.current),U(Yt(o,t)))},[o,t]);const g=U(p??o),w=t(g[1])<Xt,v=t(g[0])>a-Xt,C=t(g[0])<0||t(g[1])<0,b=t(g[0])>a||t(g[1])>a,_=t(g[0])>=0&&t(g[0])<=a,k=t(g[1])>=0&&t(g[1])<=a;return(0,S.useMemo)(()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("defs",{children:[(0,r.jsxs)("linearGradient",{id:`${i}-gradient-selection`,x1:"0%",y1:"100%",x2:"100%",y2:"100%",children:[(0,r.jsx)("stop",{stopColor:c.accent1.val}),(0,r.jsx)("stop",{stopColor:c.accent1.val,offset:"1"})]}),(0,r.jsx)("clipPath",{id:`${i}-brush-clip`,children:(0,r.jsx)("rect",{x:0,y:"0",width:s,height:a})})]}),(0,r.jsx)("g",{ref:h,clipPath:`url(#${i}-brush-clip)`}),!n&&(0,r.jsxs)(r.Fragment,{children:[k?(0,r.jsx)("g",{transform:`translate(0, ${Math.max(0,t(g[1]))}), scale(1, ${w?"1":"-1"})`,cursor:e?"ns-resize":"default",pointerEvents:"none",children:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{color:c.neutral2.val,stroke:c.neutral2.val,opacity:.6,d:Ut(s)}),(0,r.jsx)("path",{color:c.neutral2.val,stroke:c.neutral2.val,strokeWidth:4,strokeLinecap:"round",d:Kt(s)})]})}):null,_?(0,r.jsx)("g",{transform:`translate(0, ${t(g[0])}), scale(1, ${v?"-1":"1"})`,cursor:e?"ns-resize":"default",pointerEvents:"none",children:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{color:c.neutral2.val,stroke:c.neutral2.val,opacity:.6,d:Ut(s)}),(0,r.jsx)("path",{color:c.neutral2.val,stroke:c.neutral2.val,strokeWidth:4,strokeLinecap:"round",d:Kt(s)})]})}):null,C&&(0,r.jsxs)("g",{transform:"translate(18, 16) scale(1,-1)",children:[(0,r.jsx)(Gt,{color:c.accent1.val}),(0,r.jsx)("text",{x:14,y:-3,fill:c.accent1.val,fontSize:10,alignmentBaseline:"middle",transform:"scale(1,-1)",children:d("range.outOfView")})]}),b&&(0,r.jsxs)("g",{transform:`translate(18, ${a-16}) `,children:[(0,r.jsx)(Gt,{color:c.accent1.val}),!C&&(0,r.jsx)("text",{x:14,y:5,fill:c.accent1.val,fontSize:10,alignmentBaseline:"middle",children:d("range.outOfView")})]})]})]}),[i,c.accent1.val,c.neutral2.val,s,a,g,n,k,t,w,e,_,v,C,d,b])},Ie=({series:i,xScale:t,yScale:e,xValue:o,yValue:l,fill:n,brushDomain:s,selectedFill:a,containerHeight:c,containerWidth:h})=>{const f=tt();return(0,r.jsx)(r.Fragment,{children:i.filter(d=>{const p=e(l(d));return p>0&&p<=c}).map((d,p)=>{const u=l(d),x=(s&&u>=s[0]&&u<=s[1]?a:n)??f.accent1.val;return(0,r.jsx)("rect",{x:t(o(d)),y:e(u),width:t(h)-t(o(d)),height:.2,fill:x,stroke:x,rx:1,ry:1},p)})})},Zt=({value:i,yScale:t,width:e,containerWidth:o,lineStyle:l="dashed"})=>{const n=o-e,s=tt();if(isNaN(n))return null;const a=l==="dashed"?"1, 4":"none";return(0,r.jsx)("line",{strokeDasharray:a,stroke:s.neutral2.val,opacity:.5,strokeWidth:1,fill:"none",y1:t(i),x1:n,y2:t(i),x2:n+e})};Q();const ti="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _alignItems-center _gap-t-space-gap52 ",ii="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _gap-t-space-gap52 _alignItems-center ",ei="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _justifyContent-space-betwe3241 _alignItems-center _gap-t-space-gap56 ";function Se({hoverY:i,hoveredTick:t,currentPrice:e,currentTick:o,containerHeight:l,contentWidth:n,axisLabelPaneWidth:s,quoteCurrency:a,baseCurrency:c}){const h=i<20,f=l-i<20;return(0,r.jsx)(Ee,{position:"absolute",top:i-18,right:n+s+8,transform:f?"translateY(-12px)":h?"translateY(14px)":void 0,currentPrice:e,hoveredTick:t,currentTick:o,quoteCurrency:a,baseCurrency:c})}function Ee({currentPrice:i,hoveredTick:t,currentTick:e,quoteCurrency:o,baseCurrency:l,showQuoteCurrencyFirst:n=!0,...s}){var a,c;const{formatPercent:h,convertFiatAmountFormatted:f}=pt(),d=qt(Mt((a=t.amount1Locked)===null||a===void 0?void 0:a.toFixed(2),l)),p=qt(Mt((c=t.amount0Locked)===null||c===void 0?void 0:c.toFixed(2),o));if(!p||!d)return null;const u=typeof t.price0=="string"?parseFloat(t.price0):t.price0,m=n?i>=u:i<=u,x=t.tick===e,g=x?p.divide(2):p,w=x?d.divide(2):d;return(0,r.jsxs)(D,{p:"$padding8",gap:"$gap4",minWidth:150,borderRadius:"$rounded12",borderColor:"$surface3",borderWidth:"$spacing1",backgroundColor:"$surface2",pointerEvents:"none",...s,children:[(m||x)&&(0,r.jsxs)("div",{className:ei,children:[(0,r.jsxs)("div",{className:ii,children:[(0,r.jsx)(Bt,{currencies:[o],size:Rt.icon16}),(0,r.jsx)(F,{variant:"body4",children:o.symbol})]}),(0,r.jsxs)("div",{className:ti,children:[(0,r.jsx)(F,{variant:"body4",children:f(g.toExact(),Z.FiatTokenStats)}),(0,r.jsx)(F,{variant:"body4",color:"$neutral2",children:h(x?new ut(g.quotient,w.add(g).quotient).toSignificant():100)})]})]}),(!m||x)&&(0,r.jsxs)("div",{className:ei,children:[(0,r.jsxs)("div",{className:ii,children:[(0,r.jsx)(Bt,{currencies:[l],size:Rt.icon16}),(0,r.jsx)(F,{variant:"body4",children:l.symbol})]}),(0,r.jsxs)("div",{className:ti,children:[(0,r.jsx)(F,{variant:"body4",children:f(w.toExact(),Z.FiatTokenStats)}),(0,r.jsx)(F,{variant:"body4",color:"$neutral2",children:h(x?new ut(w.quotient,g.add(w).quotient).toSignificant():100)})]})]})]})}Q();const oi=i=>i.activeLiquidity,Ae=i=>i.price0,nt=new Map;function ri(i,t){let e=0,o=i.length-1;if(!t)return null;if(nt.has(t.toString()))return nt.get(t.toString());for(;e<=o;){const a=Math.floor((e+o)/2);if(i[a].price0===t)return nt.set(t.toString(),i[a]),i[a];i[a].price0<t?e=a+1:o=a-1}const l=i[o]??{price0:1/0},n=i[e]??{price0:1/0},s=Math.abs(l.price0-t)<=Math.abs(n.price0-t)?l:n;return nt.set(t.toString(),s),s}function st(i,t=18){const e=Math.pow(10,t);return Math.round(i*e)}function Ne({id:i="ActiveLiquidityChart2",quoteCurrency:t,baseCurrency:e,data:{series:o,current:l,min:n,max:s},dimensions:{width:a,height:c,contentWidth:h,axisLabelPaneWidth:f},brushDomain:d,onBrushDomainChange:p,disableBrush:u,disableRightAxis:m,disableBrushInteraction:x,showDiffIndicators:g,isMobile:w,barColor:v}){const{formatPercent:C}=pt(),b=tt(),_=(0,S.useRef)(null),[k,L]=(0,S.useState)(),{xScale:A,yScale:y}=(0,S.useMemo)(()=>{const R=n&&s?o.filter(M=>M.price0>=n&&M.price0<=s):o;return{yScale:Vt().domain([n,s]).range([c,0]),xScale:Vt().domain([0,xe(R,oi)]).range([a-f,a-f-h])}},[n,s,o,c,a,f,h]),T=(0,S.useMemo)(()=>{if(!k)return;const R=y.invert(k);return ri(o,R)},[k,o,y]),O=(0,S.useMemo)(()=>{var R;return(R=ri(o,l))===null||R===void 0?void 0:R.tick},[l,o]);(0,S.useEffect)(()=>{if(!d){const[R,B]=y.domain(),M=R+(B-R)*.2,it=R+(B-R)*.8;p([M,it],void 0)}},[d,p,y]);const j=d&&y(d[0])>=0&&y(d[0])<=c,q=d&&y(d[1])>=0&&y(d[1])<=c;return(0,r.jsxs)(r.Fragment,{children:[k&&T?(0,r.jsx)(Se,{containerHeight:c,hoverY:k,hoveredTick:T,currentTick:O,currentPrice:l,contentWidth:h,axisLabelPaneWidth:f,quoteCurrency:t,baseCurrency:e}):null,g&&(0,r.jsxs)(r.Fragment,{children:[j&&(0,r.jsx)(D,{borderRadius:"$rounded12",backgroundColor:"$surface2",borderColor:"$surface3",borderWidth:"$spacing1",p:"$padding8",position:"absolute",left:0,top:y(d[0])-16,children:(0,r.jsx)(F,{variant:"body4",children:C(new ut(st(d[0]-l),st(l)).toSignificant())})}),q&&(0,r.jsx)(D,{borderRadius:"$rounded12",backgroundColor:"$surface2",borderColor:"$surface3",borderWidth:"$spacing1",p:"$padding8",position:"absolute",left:0,top:y(d[1])-16,children:(0,r.jsx)(F,{variant:"body4",children:C(new ut(st(d[1]-l),st(l)).toSignificant())})})]}),(0,r.jsxs)("svg",{ref:_,width:"100%",height:"100%",viewBox:`0 0 ${a} ${c}`,onMouseMove:R=>{if(!_.current)return;const B=_.current.getBoundingClientRect(),M=R.clientY-B.top;R.clientX-B.left>a-f-h?L(M):L(void 0)},onMouseLeave:()=>L(void 0),children:[(0,r.jsxs)("defs",{children:[(0,r.jsx)("clipPath",{id:`${i}-chart-clip`,children:(0,r.jsx)("rect",{x:"0",y:"0",width:a,height:c})}),d&&!u&&(0,r.jsx)("mask",{id:`${i}-chart-area-mask`,children:(0,r.jsx)("rect",{fill:"white",y:y(d[1]),x:a-f-h-1,height:y(d[0])-y(d[1]),width:h+2})}),(0,r.jsx)("style",{children:`
              .axis-right line { display: none; }
              .axis-right text { fill: ${b.neutral2.val}; }
            `})]}),(0,r.jsxs)("g",{children:[(0,r.jsxs)("g",{clipPath:`url(#${i}-chart-clip)`,children:[(0,r.jsx)(Ie,{series:o,xScale:A,yScale:y,xValue:oi,yValue:Ae,brushDomain:d,containerHeight:c,fill:dt(10,d?b.neutral1.val:v??b.accent1.val),selectedFill:dt(10,v??b.accent1.val),containerWidth:a-f}),!u&&(0,r.jsx)(Zt,{value:l,yScale:y,width:h+12,containerWidth:a-f}),k&&T&&Number(T.amount0Locked)+Number(T.amount1Locked)>0&&(0,r.jsx)(Zt,{value:y.invert(k),yScale:y,width:h+12,containerWidth:a-f,lineStyle:"solid"})]}),w||m?null:(0,r.jsx)(Te,{yScale:y,offset:a-f,min:d==null?void 0:d[0],current:l,max:d==null?void 0:d[1],height:c}),!u&&(0,r.jsx)(je,{id:i,yScale:y,interactive:!x,brushExtent:d??y.domain(),hideHandles:!d,width:a-f,height:c,setBrushExtent:p})]})]})]})}var ni=class{constructor(i){I.defineProperty(this,"numbers",void 0),I.defineProperty(this,"cache",void 0),this.numbers=i,this.cache=new Map}findClosestIndex(i,t){const e=`${i}:${t}`;if(this.cache.has(e))return this.cache.get(e);const o=this._performSearch(i,t);return this.cache.set(e,o),o}_performSearch(i,t){var e,o;let l=0,n=this.numbers.length-1;if(i<=((e=this.numbers[0])===null||e===void 0?void 0:e.time))return 0;if(i>=((o=this.numbers[n])===null||o===void 0?void 0:o.time))return n;for(;l<=n;){var s;const a=Math.floor((l+n)/2),c=(s=this.numbers[a])===null||s===void 0?void 0:s.time;if(c===i)return a;c>i?n=a-1:l=a+1}return t==="left"?l:n}},si=class{constructor(i,t=10){I.defineProperty(this,"_arr",void 0),I.defineProperty(this,"_chunkSize",void 0),I.defineProperty(this,"_cache",void 0),this._arr=i,this._chunkSize=t,this._cache=new Map}getMinMax(i,t){const e=`${i}:${t}`;if(e in this._cache)return this._cache.get(e);const o={lower:1/0,upper:-1/0},l=Math.floor(i/this._chunkSize),n=Math.floor(t/this._chunkSize);for(let s=l;s<=n;s++){const a=s*this._chunkSize,c=Math.min((s+1)*this._chunkSize-1,this._arr.length-1),h=`${a}:${c}`;if(h in this._cache.keys()){const f=this._cache.get(e);this._check(f,o)}else{const f={lower:1/0,upper:-1/0};for(let d=a;d<=c;d++)this._check(this._arr[d],f);this._cache.set(h,f),this._check(f,o)}}return this._cache.set(e,o),o}_check(i,t){i.lower<t.lower&&(t.lower=i.lower),i.upper>t.upper&&(t.upper=i.upper)}};function yi(i){return JSON.parse(JSON.stringify(i))}var Oe=class{constructor(){I.defineProperty(this,"_chart",void 0),I.defineProperty(this,"_series",void 0),I.defineProperty(this,"_requestUpdate",void 0),I.defineProperty(this,"_fireDataUpdated",i=>{this.dataUpdated&&this.dataUpdated(i)})}requestUpdate(){this._requestUpdate&&this._requestUpdate()}attached({chart:i,series:t,requestUpdate:e}){this._chart=i,this._series=t,this._series.subscribeDataChanged(this._fireDataUpdated),this._requestUpdate=e,this.requestUpdate()}detached(){var i;(i=this._series)===null||i===void 0||i.unsubscribeDataChanged(this._fireDataUpdated),this._chart=void 0,this._series=void 0,this._requestUpdate=void 0}get chart(){if(!this._chart)throw new Error("Value is undefined");return this._chart}get series(){if(!this._series)throw new Error("Value is undefined");return this._series}},qe=class{constructor(i){I.defineProperty(this,"_viewData",void 0),this._viewData=i}draw(){}drawBackground(i){const t=this._viewData.data;i.useBitmapCoordinateSpace(e=>{var o,l,n,s,a,c,h,f,d,p;const u=e.context;u.scale(e.horizontalPixelRatio,e.verticalPixelRatio),u.strokeStyle=this._viewData.options.lineColor,u.lineWidth=this._viewData.options.lineWidth,u.beginPath();const m=new Path2D,x=new Path2D;m.moveTo((o=t[0])===null||o===void 0?void 0:o.x,(l=t[0])===null||l===void 0?void 0:l.upper),x.moveTo((n=t[0])===null||n===void 0?void 0:n.x,(s=t[0])===null||s===void 0?void 0:s.upper);for(const _ of t)m.lineTo(_.x,_.upper),x.lineTo(_.x,_.upper);const g=t.length-1;m.lineTo((a=t[g])===null||a===void 0?void 0:a.x,(c=t[g])===null||c===void 0?void 0:c.lower),x.moveTo((h=t[g])===null||h===void 0?void 0:h.x,(f=t[g])===null||f===void 0?void 0:f.lower);for(let _=t.length-2;_>=0;_--){var w,v,C,b;m.lineTo((w=t[_])===null||w===void 0?void 0:w.x,(v=t[_])===null||v===void 0?void 0:v.lower),x.lineTo((C=t[_])===null||C===void 0?void 0:C.x,(b=t[_])===null||b===void 0?void 0:b.lower)}m.lineTo((d=t[0])===null||d===void 0?void 0:d.x,(p=t[0])===null||p===void 0?void 0:p.upper),m.closePath(),u.stroke(x),u.fillStyle=this._viewData.options.fillColor,u.fill(m)})}},Re=class{constructor(i){I.defineProperty(this,"_source",void 0),I.defineProperty(this,"_data",void 0),this._source=i,this._data={data:[],options:this._source._options}}update(){const i=this._source.series,t=this._source.chart.timeScale();this._data.data=this._source._bandsData.map(e=>({x:t.timeToCoordinate(e.time)??-100,upper:i.priceToCoordinate(e.upper)??-100,lower:i.priceToCoordinate(e.lower)??-100}))}renderer(){return new qe(this._data)}},Me=class extends Oe{constructor(i){super(),I.defineProperty(this,"_paneViews",void 0),I.defineProperty(this,"_seriesData",[]),I.defineProperty(this,"_bandsData",[]),I.defineProperty(this,"_options",void 0),I.defineProperty(this,"_timeIndices",void 0),I.defineProperty(this,"_upperLower",void 0),this._options=i,this._paneViews=[new Re(this)],this._timeIndices=new ni([]),this._upperLower=new si([])}updateOptions(i){this._options=i,this.dataUpdated("full")}updateAllViews(){this._paneViews.forEach(i=>i.update())}paneViews(){return this._paneViews}attached(i){super.attached(i),this.dataUpdated("full")}dataUpdated(i){this._seriesData=yi(this.series.data()),this.calculateBands(),i==="full"&&(this._timeIndices=new ni(this._seriesData))}calculateBands(){const i=this._seriesData.map(t=>({upper:this._options.upperValue,lower:this._options.lowerValue,time:t.time}));this._bandsData=i,this._upperLower=new si(this._bandsData,4)}};Q();function ai(i,{yCoordinate:t,xCoordinate:e}){return{position:"absolute",left:e-3,top:t-3,width:6,height:6,borderRadius:"$roundedFull",backgroundColor:i}}function Be(i){return Math.abs(i)>=1e20||Math.abs(i)<=1e-20}function ht(i,t){const e=i==null?void 0:i.baseCurrency;if(!e)return t;const o=e.decimals&&e.decimals>0?e.decimals:6,l=Number(i.quote(ft.fromRawAmount(e,Math.pow(10,e.decimals))).toSignificant(o));return Be(l)?t:l}var Ve=class{constructor(i){I.defineProperty(this,"_data",null),I.defineProperty(this,"_options",void 0),this._options=i,this._options.hoveredTick=i.activeTick}draw(i,t){i.useBitmapCoordinateSpace(e=>this._drawImpl(e,t))}update(i,t){this._data=i,this._options={...this._options,...t}}_drawImpl(i,t){if(this._data===null||this._data.bars.length===0||this._data.visibleRange===null)return;const e=i.context,o=this._data.bars.map(n=>({x:n.x,y:t(n.originalData.liquidity)??0,tick:n.originalData.tick}));se({items:o,barSpacingMedia:this._data.barSpacing,horizontalPixelRatio:i.horizontalPixelRatio,startIndex:this._data.visibleRange.from,endIndex:this._data.visibleRange.to});const l=t(0)??0;e.fillStyle=this._options.tokenAColor;for(let n=this._data.visibleRange.from;n<this._data.visibleRange.to;n++){const s=o[n],a=s.column,c=this._options.activeTick===s.tick,h=this._options.hoveredTick===s.tick;if(!a)return;const f=Math.min(Math.max(i.horizontalPixelRatio,a.right-a.left),this._data.barSpacing*i.horizontalPixelRatio),d=.3*f,p=f-d*2,u=de({position1Media:l,position2Media:s.y,pixelRatio:i.verticalPixelRatio});if(h){const m=.3*e.canvas.height,x=e.canvas.height-m;e.fillStyle=this._options.highlightColor,Ft({ctx:e,x:a.left+d,y:m,w:p,h:x,radii:8}),e.globalAlpha=1}else e.globalAlpha=.4;if(c?e.fillStyle=this._options.tokenBColor:this._options.activeTick===void 0?e.fillStyle=this._options.color??"white":this._options.activeTick>s.tick?e.fillStyle=this._options.tokenBColor:this._options.activeTick<s.tick&&(e.fillStyle=this._options.tokenAColor),Ft({ctx:e,x:a.left+d,y:u.position,w:p,h:u.length,radii:8}),e.globalAlpha=1,c&&this._options.activeTickProgress){e.globalCompositeOperation="source-atop";const m=u.length*this._options.activeTickProgress,x=u.position+(u.length-m);e.fillStyle=this._options.tokenAColor,e.beginPath(),e.fillRect(a.left,x,f,m),e.globalCompositeOperation="source-over"}}}},De=class{constructor(i){I.defineProperty(this,"_renderer",void 0),I.defineProperty(this,"_tokenAColor",void 0),I.defineProperty(this,"_tokenBColor",void 0),I.defineProperty(this,"_highlightColor",void 0),this._tokenAColor=i.tokenAColor,this._renderer=new Ve(i),this._tokenBColor=i.tokenBColor,this._highlightColor=i.highlightColor}priceValueBuilder(i){return[0,i.liquidity]}isWhitespace(i){return!i.liquidity}renderer(){return this._renderer}update(i,t){this._renderer.update(i,t)}defaultOptions(){return{...ne,tokenAColor:this._tokenAColor,tokenBColor:this._tokenBColor,highlightColor:this._highlightColor}}};Ct();kt();_t();const Fe=8;function li({token0:i,token1:t,activeTickProcessed:e,sortedTickData:o,pivot:l,ascending:n,version:s}){let a={...e};if(s===N.V3&&(i.isNative||t.isNative))return[];let c=[];for(let p=l+(n?1:-1);n?p<o.length:p>=0;n?p++:p--){var h,f,d;const u=Number((h=o[p])===null||h===void 0?void 0:h.tick),m=s===N.V3?wt(i,t,u):Lt(i,t,u),x={liquidityActive:a.liquidityActive,tick:u,liquidityNet:E.BigInt(((f=o[p])===null||f===void 0?void 0:f.liquidityNet)??""),price0:m.toFixed(Fe),sdkPrice:m};n?x.liquidityActive=E.add(a.liquidityActive,E.BigInt(((d=o[p])===null||d===void 0?void 0:d.liquidityNet)??0)):E.notEqual(a.liquidityNet,E.BigInt(0))&&(x.liquidityActive=E.subtract(a.liquidityActive,a.liquidityNet)),c.push(x),a=x}return n||(c=c.reverse()),c}Q();Ct();kt();_t();var ci=yt(Ui());const $e=8;function He({tickCurrent:i,feeAmount:t,tickSpacing:e}){return i&&t!==void 0&&e?Math.floor(i/e)*e:void 0}const J=1e3;function ze({poolId:i,version:t,skip:e,chainId:o}){const{defaultChainId:l}=qi(),n=Gi(o),s=Vi({variables:{address:(i==null?void 0:i.toLowerCase())??"",chain:Ot(n??l),skip:e,first:J},skip:!i||t!==N.V3,pollInterval:(0,ci.default)("30s")}),a=Di({variables:{poolId:i??"",chain:Ot(n??l),skip:e,first:J},skip:!i||t!==N.V4,pollInterval:(0,ci.default)("30s")});return(0,S.useMemo)(()=>t===N.V3?s:t===N.V4?a:{data:void 0,error:new Error("Invalid version"),loading:!1},[s,a,t])}function Ue({sdkCurrencies:i,feeAmount:t,chainId:e,version:o,tickSpacing:l,hooks:n,precalculatedPoolId:s}){var a,c;const[h,f]=(0,S.useState)(0),[d,p]=(0,S.useState)([]),u=(0,S.useMemo)(()=>{if(s)return s;const{TOKEN0:v,TOKEN1:C}=i,b=v&&C&&t&&o===N.V3?Pt.getAddress(v.wrapped,C.wrapped,t,void 0,pi[e]):void 0,_=o===N.V4&&v&&C&&t&&l&&n?mi.getPoolId(v,C,t,l,n):void 0;return o===N.V3?b:_},[e,i,t,n,s,l,o]),{data:m,error:x,loading:g}=ze({poolId:u,version:o,skip:h,chainId:e}),w=(m==null||(a=m.v3Pool)===null||a===void 0?void 0:a.ticks)??(m==null||(c=m.v4Pool)===null||c===void 0?void 0:c.ticks);return(0,S.useEffect)(()=>{w!=null&&w.length&&(p(v=>[...v,...w]),w.length===J&&f(v=>v+J))},[w]),{isLoading:g||(w==null?void 0:w.length)===J,error:x,ticks:d}}function _i({sdkCurrencies:i,feeAmount:t,chainId:e,version:o,tickSpacing:l,hooks:n,poolId:s,skip:a}){const h=Qi().chainId??Mi.Mainnet,f=!!(he(o)&&i.TOKEN0&&i.TOKEN1&&!a),{data:d,isLoading:p}=fe({fee:t,chainId:e??h,protocolVersions:[o],token0:$t(i.TOKEN0),token1:$t(i.TOKEN1),hooks:n??$},f),u=d!=null&&d.pools&&d.pools.length>0?d.pools[0]:void 0,m=l??(u==null?void 0:u.tickSpacing)??(t?z[t]:void 0),x=u==null?void 0:u.liquidity,g=u==null?void 0:u.sqrtPriceX96,w=u==null?void 0:u.tick,v=(0,S.useMemo)(()=>He({tickCurrent:w,feeAmount:t,tickSpacing:m}),[w,t,m]),{isLoading:C,error:b,ticks:_}=Ue({sdkCurrencies:i,feeAmount:t,precalculatedPoolId:s,chainId:e??h,version:o,tickSpacing:m,hooks:n});return(0,S.useMemo)(()=>{var k,L;const A=i.TOKEN0,y=i.TOKEN1;if(!A||!y||v===void 0||!u||!_||_.length===0||C)return{isLoading:C||p,error:b,activeTick:v,data:void 0};const T=_.findIndex(M=>(M==null?void 0:M.tick)&&M.tick>v)-1;if(T<0)return Nt.debug("usePoolTickData","usePoolActiveLiquidity","TickData pivot not found",{token0:A.isToken?A.address:$,token1:y.isToken?y.address:$,chainId:A.chainId}),{isLoading:C,error:b,activeTick:v,data:void 0};let O;try{O=o===N.V3?wt(A,y,v):Lt(A,y,v)}catch(M){return Nt.debug("usePoolTickData","usePoolActiveLiquidity","Error getting price",{error:M,token0:A.isToken?A.address:$,token1:y.isToken?y.address:$,chainId:A.chainId}),{isLoading:C,error:b,activeTick:v,data:void 0}}const j={liquidityActive:E.BigInt(u.liquidity),tick:v,liquidityNet:Number((k=_[T])===null||k===void 0?void 0:k.tick)===v?E.BigInt(((L=_[T])===null||L===void 0?void 0:L.liquidityNet)??0):E.BigInt(0),price0:O.toFixed($e),sdkPrice:O},q=li({token0:A,token1:y,activeTickProcessed:j,sortedTickData:_,pivot:T,ascending:!0,version:o}),B=li({token0:A,token1:y,activeTickProcessed:j,sortedTickData:_,pivot:T,ascending:!1,version:o}).concat(j).concat(q);return{isLoading:C,error:b,currentTick:w,activeTick:v,liquidity:E.BigInt(x??0),sqrtPriceX96:E.BigInt(g??0),data:B}},[i,v,u,_,C,o,b,w,x,g,p])}Hi();Q();Ct();kt();_t();var Do=class extends xi{constructor(i,t){super(i,t),I.defineProperty(this,"series",void 0),I.defineProperty(this,"activeTick",void 0),this.series=this.api.addCustomSeries(new De(t)),this.series.setData(this.data),this.updateOptions(t),this.fitContent()}updateOptions(i){super.updateOptions(i,{localization:{locale:i.locale},rightPriceScale:{visible:!1,borderVisible:!1,scaleMargins:{top:.35,bottom:0},autoScale:!0},timeScale:{visible:!1,fixLeftEdge:!0,fixRightEdge:!0,borderVisible:!1},crosshair:{horzLine:{visible:!1,labelVisible:!1},vertLine:{visible:!1,labelVisible:!1}},grid:{vertLines:{visible:!1},horzLines:{visible:!1}}});const{data:t,activeTick:e}=i;this.activeTick=e,this.data!==t&&(this.data=t,this.series.setData(t),this.fitContent()),this.series.applyOptions({priceFormat:{type:"volume"},priceLineVisible:!1,lastValueVisible:!1}),this.series.applyOptions(i)}onSeriesHover(i){super.onSeriesHover(i);const t={hoveredTick:(i==null?void 0:i.item.tick)??this.activeTick};this.series.applyOptions(t)}activeTickIndex(){return this.data.findIndex(i=>i.tick===this.activeTick)}fitContent(){const i=this.data.length,t=this.data.findIndex(o=>o.tick===this.activeTick),e=t!==-1?t:i/2;this.api.timeScale().setVisibleLogicalRange({from:Math.max(e-50,0),to:Math.min(e+50,this.data.length)})}};const bt=$i.from(2).pow(128).sub(1);function di(i){return ft.fromRawAmount(i,bt.toString())}async function Ke({token0:i,token1:t,feeTier:e,tick:o,poolData:l}){if(!(!l.currentTick||!l.sqrtPriceX96||!l.liquidity))try{const n=E.greaterThan(o.liquidityNet,E.BigInt(0))?o.liquidityNet:E.multiply(o.liquidityNet,E.BigInt("-1")),s=[{index:o.tick,liquidityGross:n,liquidityNet:E.multiply(o.liquidityNet,E.BigInt("-1"))},{index:o.tick+z[e],liquidityGross:n,liquidityNet:o.liquidityNet}],a=new Pt(i,t,e,l.sqrtPriceX96,o.liquidityActive,l.currentTick,s),c=W.getSqrtRatioAtTick(s[0].index),h=(await a.getOutputAmount(di(i),c))[0],f=parseFloat(o.sdkPrice.invert().quote(h).toExact()),d=W.getSqrtRatioAtTick(s[1].index),p=(await a.getOutputAmount(di(t),d))[0],u=parseFloat(o.sdkPrice.quote(p).toExact());return{amount0Locked:f,amount1Locked:u}}catch{return{amount0Locked:0,amount1Locked:0}}}async function ki({token0:i,token1:t,feeTier:e,tick:o}){try{const l=z[e],n=E.greaterThan(o.liquidityNet,E.BigInt(0))?o.liquidityNet:E.multiply(o.liquidityNet,E.BigInt("-1")),s=W.getSqrtRatioAtTick(o.tick),a=[{index:o.tick,liquidityGross:n,liquidityNet:E.multiply(o.liquidityNet,E.BigInt("-1"))},{index:o.tick+z[e],liquidityGross:n,liquidityNet:o.liquidityNet}],c=new Pt(i,t,Number(e),s,o.liquidityActive,o.tick,a),h=W.getSqrtRatioAtTick(o.tick-l),f=ft.fromRawAmount(i,bt.toString()),d=(await c.getOutputAmount(f,h))[0],p=parseFloat(o.sdkPrice.invert().quote(d).toExact()),u=parseFloat(d.toExact());return{amount0Locked:p,amount1Locked:u}}catch{return{amount0Locked:0,amount1Locked:0}}}async function Li({token0:i,token1:t,feeTier:e,tickSpacing:o,hooks:l,tick:n}){try{const s=E.greaterThan(n.liquidityNet,E.BigInt(0))?n.liquidityNet:E.multiply(n.liquidityNet,E.BigInt("-1")),a=W.getSqrtRatioAtTick(n.tick),c=[{index:n.tick,liquidityGross:s,liquidityNet:E.multiply(n.liquidityNet,E.BigInt("-1"))},{index:n.tick+o,liquidityGross:s,liquidityNet:n.liquidityNet}],h=new mi(i,t,Number(e),o,l,a,n.liquidityActive,n.tick,c),f=W.getSqrtRatioAtTick(n.tick-o),d=ft.fromRawAmount(i,bt.toString()),p=(await h.getOutputAmount(d,f))[0],u=parseFloat(n.sdkPrice.invert().quote(p).toExact()),m=parseFloat(p.toExact());return{amount0Locked:u,amount1Locked:m}}catch{return{amount0Locked:0,amount1Locked:0}}}function Fo({sdkCurrencies:i,feeTier:t,isReversed:e,chainId:o,version:l,tickSpacing:n,hooks:s,poolId:a}){const{formatNumberOrString:c}=pt(),h=_i({sdkCurrencies:i,feeAmount:t,version:l,poolId:a,chainId:o,tickSpacing:n??z[t],hooks:s}),[f,d]=(0,S.useState)(),{data:p,activeTick:u,currentTick:m,liquidity:x,sqrtPriceX96:g}=h;return(0,S.useEffect)(()=>{async function w(){if(!p)return;let v,C;const b=[];for(let k=0;k<p.length;k++){const L=p[k],A=e?k*1e3:(p.length-k)*1e3,y=u===L.tick;let T=L.sdkPrice,O=L.sdkPrice.invert();y&&u&&m&&(C=k,v=(m-L.tick)/z[t],T=l===N.V3?wt(i.TOKEN0.wrapped,i.TOKEN1.wrapped,L.tick):Lt(i.TOKEN0,i.TOKEN1,L.tick),O=T.invert());const{amount0Locked:j,amount1Locked:q}=await(l===N.V3?ki({token0:i.TOKEN0.wrapped,token1:i.TOKEN1.wrapped,feeTier:t,tick:L}):Li({token0:i.TOKEN0,token1:i.TOKEN1,feeTier:t,tickSpacing:n??z[t],hooks:s??$,tick:L}));b.push({tick:L.tick,liquidity:parseFloat(L.liquidityActive.toString()),price0:c({value:T.toSignificant(),type:Z.SwapTradeAmount}),price1:c({value:O.toSignificant(),type:Z.SwapTradeAmount}),time:A,amount0Locked:j,amount1Locked:q})}b.map((k,L)=>{L>0&&(b[L-1].amount0Locked=k.amount0Locked,b[L-1].amount1Locked=k.amount1Locked)});const _=C!==void 0?b[C]:void 0;if(C!==void 0&&_){const k=await Ke({token0:i.TOKEN0.wrapped,token1:i.TOKEN1.wrapped,feeTier:t,tick:p[C],poolData:{currentTick:m,liquidity:x,sqrtPriceX96:g}});b[C]={..._,...k}}e||b.reverse(),d({barData:b.filter(k=>k.liquidity>0),activeRangeData:_,activeRangePercentage:v})}w()},[p,u,m,x,g,i,c,e,t,l,n,s]),{tickData:f,activeTick:h.activeTick,loading:h.isLoading||!f}}function Ge({poolId:i,sdkCurrencies:t,feeAmount:e,priceInverted:o,version:l,chainId:n,tickSpacing:s,hooks:a,skip:c}){const{isLoading:h,error:f,data:d}=_i({sdkCurrencies:t,version:l,poolId:i,feeAmount:e,chainId:n,tickSpacing:s,hooks:a,skip:c}),p=async()=>{if(!(d!=null&&d.length)||!t.TOKEN0||!t.TOKEN1||e===void 0||!s)return null;const m=[];for(let x=0;x<d.length;x++){const g=d[x],w=o?g.sdkPrice.invert().toSignificant(8):g.sdkPrice.toSignificant(8),{amount0Locked:v,amount1Locked:C}=await(l===N.V3?ki({token0:t.TOKEN0.wrapped,token1:t.TOKEN1.wrapped,feeTier:e,tick:g}):Li({token0:t.TOKEN0,token1:t.TOKEN1,feeTier:e,tickSpacing:s,hooks:a??$,tick:g})),b={activeLiquidity:parseFloat(g.liquidityActive.toString()),price0:parseFloat(w),tick:g.tick,amount0Locked:o?v:C,amount1Locked:o?C:v};b.activeLiquidity>0&&m.push(b)}return m},{data:u}=zi({queryKey:[Ni.DensityChartData,i,t.TOKEN0,t.TOKEN1,e,o,l,n,s,d],queryFn:p});return(0,S.useMemo)(()=>({isLoading:h||!!d&&!u,error:f,formattedData:h?void 0:u}),[d,f,u,h])}Q();function Xe({protocolVersion:i,poolOrPair:t,sdkCurrencies:e}){if(t)switch(i){case N.V2:return"liquidityToken"in t?t.liquidityToken.address:void 0;case N.V3:return"fee"in t&&"chainId"in t&&t.chainId&&e.TOKEN0&&e.TOKEN1?pe.getPoolAddress({factoryAddress:pi[t.chainId],tokenA:e.TOKEN0.wrapped,tokenB:e.TOKEN1.wrapped,fee:t.fee,chainId:t.chainId}):void 0;case N.V4:default:return"poolId"in t?t.poolId:void 0}}function We({variables:i,priceInverted:t}){const{data:e,loading:o}=Fi({variables:i,skip:!(i!=null&&i.addressOrId)});return(0,S.useMemo)(()=>{const{priceHistory:l}=(e==null?void 0:e.v2Pair)??(e==null?void 0:e.v3Pool)??(e==null?void 0:e.v4Pool)??{},n=(l==null?void 0:l.filter(c=>c!==void 0).map(c=>{const h=t?c.token0Price:c.token1Price;return{time:c.timestamp,value:h,open:h,high:h,low:h,close:h}}))??[],s=Xi(n),a=o||!l||!l.length?gt.INVALID:gt.VALID;return{chartType:ie.PRICE,entries:s,loading:o,dataQuality:a}},[e==null?void 0:e.v2Pair,e==null?void 0:e.v3Pool,e==null?void 0:e.v4Pool,o,t])}const Qe=52,ui=224,K=28,H=40,Ye=120,Je=`
  @keyframes pulse {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: scale(5);
      opacity: 0;
    }
  }
`;var at=class ct extends xi{constructor(t,e){super(t,e),I.defineProperty(this,"series",void 0),I.defineProperty(this,"rangeBandSeries",void 0),I.defineProperty(this,"extendedData",void 0),I.defineProperty(this,"positionRangeMin",void 0),I.defineProperty(this,"positionRangeMax",void 0),I.defineProperty(this,"bandIndicator",void 0),this.series=this.api.addAreaSeries(),this.series.setData(this.data),this.extendedData=ct.generateExtendedData(this.data,e.disableExtendedTimeScale),this.rangeBandSeries=this.api.addLineSeries({priceScaleId:"right"}),this.rangeBandSeries.setData(this.extendedData),this.rangeBandSeries.applyOptions({priceLineVisible:!1,color:"transparent"}),this.calculatePositionRange(e),this.updateOptions(e),this.fitContent(),this.overrideCrosshair(e)}updateOptions(t){var e;if(this.data!==t.data){var o;this.data=t.data,this.series.setData(this.data),this.extendedData=ct.generateExtendedData(this.data,t.disableExtendedTimeScale),this.calculatePositionRange(t),(o=this.rangeBandSeries)===null||o===void 0||o.setData(this.extendedData),this.fitContent(),this.overrideCrosshair(t)}super.updateOptions(t,{rightPriceScale:{visible:!1,autoScale:!0,borderVisible:!1,minimumWidth:H,alignLabels:!0},leftPriceScale:{visible:!1},timeScale:{visible:t.showXAxis??!1,borderVisible:!1,tickMarkFormatter:le},handleScroll:!1,handleScale:!1,localization:{priceFormatter:s=>{const a=window.navigator.languages[0];return Ki({input:s,locale:a})}},crosshair:{mode:ce.Hidden,vertLine:{color:"transparent"},horzLine:{color:"transparent"}}});const l=s=>{const a=s();return t.minVisiblePrice&&t.maxVisiblePrice?{...a,priceRange:{minValue:t.minVisiblePrice,maxValue:t.maxVisiblePrice}}:a},n=ct.getPriceLineColor(t);this.series.applyOptions({priceLineVisible:!0,priceLineStyle:ae.SparseDotted,priceLineColor:t.currentPriceLineColor??n,lineType:this.data.length<20?Dt.WithSteps:Dt.Curved,lineWidth:2,lineColor:n,topColor:"transparent",bottomColor:"transparent",autoscaleInfoProvider:l}),this.series.priceScale().applyOptions({scaleMargins:t.priceScaleMargins??{top:oe,bottom:ee}}),(e=this.rangeBandSeries)===null||e===void 0||e.applyOptions({autoscaleInfoProvider:l}),requestAnimationFrame(()=>{if(t.setBoundaryPrices){const s=this.series.coordinateToPrice(0),a=this.series.coordinateToPrice(t.height);t.setBoundaryPrices([a,s])}})}static getPriceLineColor(t){if(t.color)return t.color;switch(t.positionStatus){case Y.OUT_OF_RANGE:return t.colors.statusCritical.val;case Y.IN_RANGE:return t.colors.statusSuccess.val;case Y.CLOSED:default:return t.colors.neutral2.val}}calculatePositionRange(t){if(this.positionRangeMin=typeof t.positionPriceLower=="number"?t.positionPriceLower:ht(t.positionPriceLower,0),this.positionRangeMax=typeof t.positionPriceUpper=="number"?t.positionPriceUpper:ht(t.positionPriceUpper,Number.MAX_SAFE_INTEGER),t.positionPriceLower!==void 0&&t.positionPriceUpper!==void 0)if(this.bandIndicator)this.bandIndicator.updateOptions({lineColor:dt(10,t.theme.neutral1),fillColor:t.theme.surface3,lineWidth:1,upperValue:this.positionRangeMax,lowerValue:this.positionRangeMin}),this.bandIndicator.updateAllViews();else{var e;this.bandIndicator=new Me({lineColor:dt(40,t.theme.neutral1),fillColor:t.theme.surface3,lineWidth:1.5,upperValue:this.positionRangeMax,lowerValue:this.positionRangeMin}),(e=this.rangeBandSeries)===null||e===void 0||e.attachPrimitive(this.bandIndicator)}}overrideCrosshair(t){const e=this.data[this.data.length-1];e&&requestAnimationFrame(()=>{var o;const l=this.api.timeScale().timeToCoordinate(e.time),n=this.series.priceToCoordinate(e.value);(o=t.setCrosshairCoordinates)===null||o===void 0||o.call(t,{x:Number(l),y:Number(n)})})}static generateExtendedData(t,e=!1){var o,l;if(e)return t;const n=(o=t[t.length-1])===null||o===void 0?void 0:o.time;if(!n)return t;const a=(n-((l=t[0])===null||l===void 0?void 0:l.time))/t.length;if(a===0)return t;const c=yi(t),h=c[c.length-1];for(let f=1;f<=Math.floor(t.length/10);f++){const d=n+a*f;c.push({...h,time:d})}return c}};function $o({protocolVersion:i,sdkCurrencies:t,priceInverted:e,interactive:o,poolOrPair:l,ticks:n,pricesAtTicks:s}){const{baseCurrency:a,quoteCurrency:c}=ue(t,e);if(!a||!c||!c.chainId)return;const h=Xe({protocolVersion:i,poolOrPair:l,sdkCurrencies:t}),f=i===N.V2?{}:{base:t.TOKEN0,priceLower:s[0],priceUpper:s[1]},d=me({poolOrPair:l,lowerTick:n[0],upperTick:n[1]});return{poolAddressOrId:h,version:i,priceInverted:e,quoteCurrency:c,baseCurrency:a,sdkCurrencies:t,chainId:c.chainId,priceOrdering:f,positionStatus:i!==N.V2&&d?Y.OUT_OF_RANGE:Y.IN_RANGE,interactive:o}}function Ze({width:i,height:t,...e}){return(0,r.jsx)(vi,{height:t,width:i,position:"absolute",top:0,left:0,right:0,bottom:0,alignItems:"center",justifyContent:"center",...e,children:(0,r.jsx)(gi,{size:{width:i,height:t},color:"$neutral2"})})}function to({version:i,quoteCurrency:t,baseCurrency:e,sdkCurrencies:o,priceInverted:l,poolAddressOrId:n,chainId:s,positionStatus:a,priceOrdering:c,duration:h,width:f=ui,height:d=Qe,showXAxis:p,showYAxis:u=!1,interactive:m,tickSpacing:x,hook:g,feeTier:w,showLiquidityBars:v,crosshairEnabled:C,showChartBorder:b=!1}){var _;const k=tt(),L=i===N.V2,A=i===N.V3,y=i===N.V4,T=Bi(s),O=n?{addressOrId:n,chain:T.backendChain.chain,duration:h??Ri.Month,isV4:y,isV3:A,isV2:L}:void 0,j=We({variables:O,priceInverted:l}),[q,R]=(0,S.useState)(),[B,M]=(0,S.useState)(),it=(0,S.useMemo)(()=>({data:j.entries,stale:j.dataQuality===gt.STALE,type:re.LINE,color:at.getPriceLineColor({positionStatus:a,colors:k}),colors:k,positionPriceLower:L?0:c.priceLower,positionPriceUpper:L?Number.MAX_SAFE_INTEGER:c.priceUpper,height:v?d-K:d,priceScaleMargins:{top:0,bottom:0},setCrosshairCoordinates:R,setBoundaryPrices:M,showXAxis:p,showYAxis:u,interactive:m}),[c.priceLower,c.priceUpper,j.entries,j.dataQuality,a,k,L,d,v,p,u,m]),{formattedData:mt,isLoading:Tt}=Ge({poolId:n,sdkCurrencies:o,version:i,feeAmount:Number(w),tickSpacing:x,hooks:g??$,skip:!v}),jt=(0,S.useMemo)(()=>{if(!mt)return;const Et=new Map;return mt.forEach(ot=>{Et.set(ot.tick,ot)}),Array.from(Et.values()).sort((ot,wi)=>ot.price0-wi.price0)},[mt]),et=Tt&&j.loading&&j.entries.length===0,It=j.entries.length===0&&!Tt&&!j.loading,{ref:Pi,width:V}=Ji(),St=!It&&!!V,Ci=C&&St&&!j.loading&&(q==null?void 0:q.y)&&q.y>5&&q.x;return(0,r.jsxs)(D,{ref:Pi,height:d,width:f,$md:{width:"100%"},overflow:"hidden",position:"relative",children:[et&&V&&!It&&(0,r.jsx)(Ze,{width:V-(v?H:0),height:d}),et&&(0,r.jsx)(gi,{size:{width:V??ui,height:d},color:"$neutral2",mt:"$spacing8",ml:"$spacing4"}),St&&(0,r.jsxs)(D,{width:v?V-H+2:V,$md:{width:"100%"},zIndex:At.default,position:"relative",children:[b&&(0,r.jsx)(D,{position:"absolute",left:0,top:0,width:V-H,height:d-K,borderRightWidth:1,borderBottomWidth:1,borderColor:"$surface3"}),(0,r.jsx)(te,{Model:at,params:it,height:d,disableChartTouchPanning:!0})]}),(0,r.jsx)("style",{children:Je}),Ci&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D,{...ai(at.getPriceLineColor({positionStatus:a,colors:k}),{xCoordinate:q.x,yCoordinate:q.y})}),(0,r.jsx)(D,{...ai(at.getPriceLineColor({positionStatus:a,colors:k}),{xCoordinate:q.x,yCoordinate:q.y}),style:{animation:"pulse 1.5s linear infinite"}})]}),v&&V&&jt&&!et&&B&&(0,r.jsx)(D,{width:V,height:d-K,position:"absolute",left:0,top:0,zIndex:At.mask,children:(0,r.jsx)(Ne,{barColor:k.surface3.val,data:{series:jt,current:(_=j.entries[j.entries.length-1])===null||_===void 0?void 0:_.value,min:B[0],max:B[1]},brushDomain:[ht(c.priceLower,0),ht(c.priceUpper,Number.MAX_SAFE_INTEGER)],disableBrush:!0,disableRightAxis:!u,showDiffIndicators:!1,dimensions:{width:V,height:d-K,contentWidth:Ye,axisLabelPaneWidth:H},onBrushDomainChange:()=>{},quoteCurrency:t,baseCurrency:e,isMobile:Ai})}),v&&et&&V&&(0,r.jsx)(vi,{position:"absolute",right:H,top:0,alignItems:"flex-end",height:d-K,width:V-H,children:(0,r.jsx)(ve,{color:"$neutral2",size:d-K})})]})}function Ho(i){return(0,r.jsx)(Yi,{fallback:()=>null,children:(0,r.jsx)(to,{...i})})}export{Ne as ActiveLiquidityChart,Qe as CHART_HEIGHT,ui as CHART_WIDTH,ve as HorizontalDensityChart,at as LPPriceChartModel,Do as LiquidityBarChartModel,Ze as LiquidityPositionRangeChartLoader,gi as LoadingPriceCurve,Ee as TickTooltipContent,Ho as WrappedLiquidityPositionRangeChart,$o as getLiquidityRangeChartProps,Xe as getPoolIdOrAddressFromCreatePositionInfo,Ge as useDensityChartData,Fo as useLiquidityBarData,We as usePoolPriceChartData};
