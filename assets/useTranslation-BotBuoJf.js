import{__toESM as M}from"./chunk-DgAfPHQg.js";import{require_react as F}from"./react-CNoFhWkx.js";import{I18nContext as _,ReportNamespaces as j,getDefaults as z,getI18n as P,hasLoadedNamespace as A,loadLanguages as x,loadNamespaces as I,warnOnce as R}from"./src-DOOtfpHS.js";var f=M(F());const L=(i,t)=>{const s=(0,f.useRef)();return(0,f.useEffect)(()=>{s.current=t?s.current:i},[i,t]),s.current};function E(i,t,s,d){return i.getFixedT(t,s,d)}function U(i,t,s,d){return(0,f.useCallback)(E(i,t,s,d),[i,t,s,d])}function J(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:s}=t,{i18n:d,defaultNS:v}=(0,f.useContext)(_)||{},e=s||d||P();if(e&&!e.reportNamespaces&&(e.reportNamespaces=new j),!e){R("You will need to pass in an i18next instance by using initReactI18next");const r=(c,o)=>typeof o=="string"?o:o&&typeof o=="object"&&typeof o.defaultValue=="string"?o.defaultValue:Array.isArray(c)?c[c.length-1]:c,a=[r,{},!1];return a.t=r,a.i18n={},a.ready=!1,a}e.options.react&&e.options.react.wait!==void 0&&R("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const p={...z(),...e.options.react,...t},{useSuspense:S,keyPrefix:w}=p;let n=i||v||e.options&&e.options.defaultNS;n=typeof n=="string"?[n]:n||["translation"],e.reportNamespaces.addUsedNamespaces&&e.reportNamespaces.addUsedNamespaces(n);const u=(e.isInitialized||e.initializedStoreOnce)&&n.every(r=>A(r,e,p)),C=U(e,t.lng||null,p.nsMode==="fallback"?n:n[0],w),b=()=>C,N=()=>E(e,t.lng||null,p.nsMode==="fallback"?n:n[0],w),[h,m]=(0,f.useState)(b);let g=n.join();t.lng&&(g=`${t.lng}${g}`);const T=L(g),l=(0,f.useRef)(!0);(0,f.useEffect)(()=>{const{bindI18n:r,bindI18nStore:a}=p;l.current=!0,!u&&!S&&(t.lng?x(e,t.lng,n,()=>{l.current&&m(N)}):I(e,n,()=>{l.current&&m(N)})),u&&T&&T!==g&&l.current&&m(N);function c(){l.current&&m(N)}return r&&e&&e.on(r,c),a&&e&&e.store.on(a,c),()=>{l.current=!1,r&&e&&r.split(" ").forEach(o=>e.off(o,c)),a&&e&&a.split(" ").forEach(o=>e.store.off(o,c))}},[e,g]),(0,f.useEffect)(()=>{l.current&&u&&m(b)},[e,w,u]);const y=[h,e,u];if(y.t=h,y.i18n=e,y.ready=u,u||!u&&!S)return y;throw new Promise(r=>{t.lng?x(e,t.lng,n,()=>r()):I(e,n,()=>r())})}export{J as useTranslation};
