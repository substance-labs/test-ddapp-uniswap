import{__toESM as C}from"./chunk-DgAfPHQg.js";import{require_react as w}from"./react-CNoFhWkx.js";import{Subscribable as g,hashKey as S,noop as M,notifyManager as G,shallowEqualObjects as O,shouldThrowError as E,useQueryClient as I}from"./useQuery-D_ZCw8XG.js";import{getDefaultState as k}from"./mutation-CRQvRc5_.js";import{BaseError as y}from"./useAccount-C5hwiBwN.js";var e=(function(t){function s(i,r,n){if(typeof i=="function"?i===r:i.has(r))return arguments.length<3?r:n;throw TypeError("Private element is not present on this object")}function a(i,r,n){return i.set(s(i,r),n),n}function o(i,r){if(r.has(i))throw TypeError("Cannot initialize the same private elements twice on an object")}function u(i,r,n){o(i,r),r.set(i,n)}function h(i,r){o(i,r),r.add(i)}function d(i,r){return i.get(s(i,r))}return t.assertClassBrand=s,t.classPrivateFieldGet2=d,t.classPrivateFieldInitSpec=u,t.classPrivateFieldSet2=a,t.classPrivateMethodInitSpec=h,t})({}),v,f,l,c,p,B=(v=new WeakMap,f=new WeakMap,l=new WeakMap,c=new WeakMap,p=new WeakSet,class extends g{constructor(t,s){super(),e.classPrivateMethodInitSpec(this,p),e.classPrivateFieldInitSpec(this,v,void 0),e.classPrivateFieldInitSpec(this,f,void 0),e.classPrivateFieldInitSpec(this,l,void 0),e.classPrivateFieldInitSpec(this,c,void 0),e.classPrivateFieldSet2(v,this,t),this.setOptions(s),this.bindMethods(),e.assertClassBrand(p,this,P).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const a=this.options;this.options=e.classPrivateFieldGet2(v,this).defaultMutationOptions(t),O(this.options,a)||e.classPrivateFieldGet2(v,this).getMutationCache().notify({type:"observerOptionsUpdated",mutation:e.classPrivateFieldGet2(l,this),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&S(a.mutationKey)!==S(this.options.mutationKey)?this.reset():((s=e.classPrivateFieldGet2(l,this))===null||s===void 0?void 0:s.state.status)==="pending"&&e.classPrivateFieldGet2(l,this).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=e.classPrivateFieldGet2(l,this))===null||t===void 0||t.removeObserver(this)}onMutationUpdate(t){e.assertClassBrand(p,this,P).call(this),e.assertClassBrand(p,this,b).call(this,t)}getCurrentResult(){return e.classPrivateFieldGet2(f,this)}reset(){var t;(t=e.classPrivateFieldGet2(l,this))===null||t===void 0||t.removeObserver(this),e.classPrivateFieldSet2(l,this,void 0),e.assertClassBrand(p,this,P).call(this),e.assertClassBrand(p,this,b).call(this)}mutate(t,s){var a;return e.classPrivateFieldSet2(c,this,s),(a=e.classPrivateFieldGet2(l,this))===null||a===void 0||a.removeObserver(this),e.classPrivateFieldSet2(l,this,e.classPrivateFieldGet2(v,this).getMutationCache().build(e.classPrivateFieldGet2(v,this),this.options)),e.classPrivateFieldGet2(l,this).addObserver(this),e.classPrivateFieldGet2(l,this).execute(t)}});function P(){var t;const s=((t=e.classPrivateFieldGet2(l,this))===null||t===void 0?void 0:t.state)??k();e.classPrivateFieldSet2(f,this,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})}function b(t){G.batch(()=>{if(e.classPrivateFieldGet2(c,this)&&this.hasListeners()){const n=e.classPrivateFieldGet2(f,this).variables,F=e.classPrivateFieldGet2(f,this).context;if((t==null?void 0:t.type)==="success"){var s,a,o,u;(s=(a=e.classPrivateFieldGet2(c,this)).onSuccess)===null||s===void 0||s.call(a,t.data,n,F),(o=(u=e.classPrivateFieldGet2(c,this)).onSettled)===null||o===void 0||o.call(u,t.data,null,n,F)}else if((t==null?void 0:t.type)==="error"){var h,d,i,r;(h=(d=e.classPrivateFieldGet2(c,this)).onError)===null||h===void 0||h.call(d,t.error,n,F),(i=(r=e.classPrivateFieldGet2(c,this)).onSettled)===null||i===void 0||i.call(r,void 0,t.error,n,F)}}this.listeners.forEach(n=>{n(e.classPrivateFieldGet2(f,this))})})}var m=C(w());function N(t,s){const a=I(s),[o]=m.useState(()=>new B(a,t));m.useEffect(()=>{o.setOptions(t)},[o,t]);const u=m.useSyncExternalStore(m.useCallback(d=>o.subscribe(G.batchCalls(d)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),h=m.useCallback((d,i)=>{o.mutate(d,i).catch(M)},[o]);if(u.error&&E(o.options.throwOnError,[u.error]))throw u.error;return{...u,mutate:h,mutateAsync:u.mutate}}var x=class extends y{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}},T=class extends y{constructor({connector:t}){super(`"${t.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}};export{x as ProviderNotFoundError,T as SwitchChainNotSupportedError,N as useMutation};
