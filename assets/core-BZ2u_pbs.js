const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/basic-DiskHcyG.js","assets/preload-helper-CaakwtpC.js","assets/lit-DG7NlYUS.js","assets/wui-text-Dy7AYz8M.js","assets/ConstantsUtil-DWdkyivO.js","assets/formatUnits-DkyMpOD7.js","assets/dist-QCpUvRkJ.js","assets/chunk-DgAfPHQg.js","assets/ConnectorUtil-BidIfr3U.js","assets/dijkstra-6umg7ymP.js","assets/encode-utf8-DiSL6KQ9.js","assets/w3m-modal-JAA4YQhx.js","assets/_u64-b_viZRi_.js","assets/isAddress-P2vaZgmG.js","assets/SIWXUtil-BcrNwiHE.js","assets/index.es-2xsffwdf.js","assets/events-Bnkik2bI.js","assets/basics-DA01Pp0C.js","assets/dist-ceZDlR1V.js","assets/dist-Q7olfaoJ.js","assets/esm-DSGHq0HW.js","assets/recoverAddress-oPdWABRo.js"])))=>i.map(i=>d[i]);
import{__vitePreload as ae}from"./preload-helper-CaakwtpC.js";import"./dist-Q7olfaoJ.js";import"./dist-QCpUvRkJ.js";import"./dist-ceZDlR1V.js";import{toHex as oe}from"./isAddress-P2vaZgmG.js";import"./node-C_BraYgX.js";import"./formatUnits-DkyMpOD7.js";import"./_u64-b_viZRi_.js";import"./stringify-B82RFruy.js";import"./rpc-nQR4Ijs4.js";import"./recoverAddress-oPdWABRo.js";import"./createBatchScheduler-BJBpfhFD.js";import"./createTransport-WEDNYdh5.js";import{fallback as ce,http as $}from"./http-CIklBnX8.js";import{esm_default as me}from"./esm-DSGHq0HW.js";import"./events-Bnkik2bI.js";import{A as Ae,k as Ee}from"./index.es-2xsffwdf.js";import"./basics-DA01Pp0C.js";import"./lit-DG7NlYUS.js";import{AccountController as p,AlertController as M,ApiController as Z,AssetUtil as be,BlockchainApiController as U,ChainController as o,ConnectionController as T,ConnectorController as N,ConstantsUtil$1 as y,ConstantsUtil$2 as u,CoreHelperUtil as _,EventsController as B,MELD_PUBLIC_KEY as ye,ModalController as x,NetworkUtil as Ie,ONRAMP_PROVIDERS as fe,OptionsController as l,PublicStateController as de,RouterController as D,SendController as Te,SnackController as le,StorageUtil as A,ThemeController as P,proxy as re,ref as ke,setColorTheme as Oe,setThemeVariables as _e,subscribe as X,subscribeKey as ie,withErrorBoundary as Ne}from"./ConstantsUtil-DWdkyivO.js";import{B as Re,SIWXUtil as we}from"./SIWXUtil-BcrNwiHE.js";import{ConstantsUtil as m,HelpersUtil as Pe,WalletUtil as Ue}from"./ConnectorUtil-BidIfr3U.js";const S={validateCaipAddress(e){var t;if(((t=e.split(":"))===null||t===void 0?void 0:t.length)!==3)throw new Error("Invalid CAIP Address");return e},parseCaipAddress(e){const t=e.split(":");if(t.length!==3)throw new Error(`Invalid CAIP-10 address: ${e}`);const[s,n,r]=t;if(!s||!n||!r)throw new Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:s,chainId:n,address:r}},parseCaipNetworkId(e){const t=e.split(":");if(t.length!==2)throw new Error(`Invalid CAIP-2 network id: ${e}`);const[s,n]=t;if(!s||!n)throw new Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:s,chainId:n}}},q={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},se={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},Se={providers:fe,selectedProvider:null,error:null,purchaseCurrency:q,paymentCurrency:se,purchaseCurrencies:[q],paymentCurrencies:[],quotesLoading:!1},h=re(Se),De={state:h,subscribe(e){return X(h,()=>e(h))},subscribeKey(e,t){return ie(h,e,t)},setSelectedProvider(e){if(e&&e.name==="meld"){const t=o.state.activeChain===u.CHAIN.SOLANA?"SOL":"USDC",s=p.state.address??"",n=new URL(e.url);n.searchParams.append("publicKey",ye),n.searchParams.append("destinationCurrencyCode",t),n.searchParams.append("walletAddress",s),n.searchParams.append("externalCustomerId",l.state.projectId),h.selectedProvider={...e,url:n.toString()}}else h.selectedProvider=e},setOnrampProviders(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string")){const t=e,s=fe.filter(n=>t.includes(n.name));h.providers=s}else h.providers=[]},setPurchaseCurrency(e){h.purchaseCurrency=e},setPaymentCurrency(e){h.paymentCurrency=e},setPurchaseAmount(e){ne.state.purchaseAmount=e},setPaymentAmount(e){ne.state.paymentAmount=e},async getAvailableCurrencies(){const e=await U.getOnrampOptions();h.purchaseCurrencies=e.purchaseCurrencies,h.paymentCurrencies=e.paymentCurrencies,h.paymentCurrency=e.paymentCurrencies[0]||se,h.purchaseCurrency=e.purchaseCurrencies[0]||q,await Z.fetchCurrencyImages(e.paymentCurrencies.map(t=>t.id)),await Z.fetchTokenImages(e.purchaseCurrencies.map(t=>t.symbol))},async getQuote(){h.quotesLoading=!0;try{var e,t;const s=await U.getOnrampQuote({purchaseCurrency:h.purchaseCurrency,paymentCurrency:h.paymentCurrency,amount:((e=h.paymentAmount)===null||e===void 0?void 0:e.toString())||"0",network:(t=h.purchaseCurrency)===null||t===void 0?void 0:t.symbol});return h.quotesLoading=!1,h.purchaseAmount=Number(s==null?void 0:s.purchaseAmount.amount),s}catch(s){return h.error=s.message,h.quotesLoading=!1,null}finally{h.quotesLoading=!1}},resetState(){h.selectedProvider=null,h.error=null,h.purchaseCurrency=q,h.paymentCurrency=se,h.purchaseCurrencies=[q],h.paymentCurrencies=[],h.paymentAmount=void 0,h.purchaseAmount=void 0,h.quotesLoading=!1}},ne=Ne(De),ue=2147483648,Le={convertEVMChainIdToCoinType(e){if(e>=ue)throw new Error("Invalid chainId");return(ue|e)>>>0}},I=re({suggestions:[],loading:!1}),We={state:I,subscribe(e){return X(I,()=>e(I))},subscribeKey(e,t){return ie(I,e,t)},async resolveName(e){try{return await U.lookupEnsName(e)}catch(s){var t;const n=s;throw new Error((n==null||(t=n.reasons)===null||t===void 0||(t=t[0])===null||t===void 0?void 0:t.description)||"Error resolving name")}},async isNameRegistered(e){try{return await U.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{I.loading=!0,I.suggestions=[];const t=await U.getEnsNameSuggestions(e);return I.suggestions=t.suggestions.map(s=>({...s,name:s.name}))||[],I.suggestions}catch(t){const s=H.parseEnsApiError(t,"Error fetching name suggestions");throw new Error(s)}finally{I.loading=!1}},async getNamesForAddress(e){try{if(!o.state.activeCaipNetwork)return[];const s=A.getEnsFromCacheForAddress(e);if(s)return s;const n=await U.reverseLookupEnsName({address:e});return A.updateEnsCache({address:e,ens:n,timestamp:Date.now()}),n}catch(t){const s=H.parseEnsApiError(t,"Error fetching names for address");throw new Error(s)}},async registerName(e){const t=o.state.activeCaipNetwork;if(!t)throw new Error("Network not found");const s=p.state.address,n=N.getAuthConnector();if(!s||!n)throw new Error("Address or auth connector not found");I.loading=!0;try{const r=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});D.pushTransactionStack({onCancel(){D.replace("RegisterAccountName")}});const i=await T.signMessage(r);I.loading=!1;const a=t.id;if(!a)throw new Error("Network not found");const c=Le.convertEVMChainIdToCoinType(Number(a));await U.registerEnsName({coinType:c,address:s,signature:i,message:r}),p.setProfileName(e,t.chainNamespace),D.replace("RegisterAccountNameSuccess")}catch(r){const i=H.parseEnsApiError(r,`Error registering name ${e}`);throw D.replace("RegisterAccountName"),new Error(i)}finally{I.loading=!1}},validateName(e){return/^[a-zA-Z0-9-]{4,}$/u.test(e)},parseEnsApiError(e,t){var s;const n=e;return(n==null||(s=n.reasons)===null||s===void 0||(s=s[0])===null||s===void 0?void 0:s.description)||t}},H=Ne(We),Q={ConnectorExplorerIds:{[u.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[u.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[u.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[u.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[u.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[m.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[m.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[m.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[m.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[m.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[m.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[m.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[m.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[m.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[m.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[m.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[u.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[u.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[u.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[u.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[u.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[u.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[u.CONNECTOR_ID.INJECTED]:"Browser Wallet",[u.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[u.CONNECTOR_ID.COINBASE]:"Coinbase",[u.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[u.CONNECTOR_ID.LEDGER]:"Ledger",[u.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[u.CONNECTOR_ID.INJECTED]:"INJECTED",[u.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[u.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[u.CONNECTOR_ID.AUTH]:"AUTH"},WalletConnectRpcChainIds:[1,5,11155111,10,420,42161,421613,137,80001,42220,1313161554,1313161555,56,97,43114,43113,100,8453,84531,7777777,999,324,280]},Me=new AbortController,W={EmbeddedWalletAbortController:Me,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${Fe()?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};function Fe(){return typeof window<"u"}const Be={createLogger(e,t="error"){const s=Ee({level:t}),{logger:n}=Ae({opts:s});return n.error=(...r)=>{for(const i of r)if(i instanceof Error){e(i,...r);return}e(void 0,...r)},n}},xe="rpc.walletconnect.org";function pe(e,t){const s=new URL("https://rpc.walletconnect.org/v1/");return s.searchParams.set("chainId",e),s.searchParams.set("projectId",t),s.toString()}const te=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],F={extendRpcUrlWithProjectId(e,t){let s=!1;try{s=new URL(e).host===xe}catch{s=!1}if(s){const n=new URL(e);return n.searchParams.has("projectId")||n.searchParams.set("projectId",t),n.toString()}return e},isCaipNetwork(e){return"chainNamespace"in e&&"caipNetworkId"in e},getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:u.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${u.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,s){var n;const r=(n=e.rpcUrls)===null||n===void 0||(n=n.default)===null||n===void 0||(n=n.http)===null||n===void 0?void 0:n[0];return te.includes(t)?pe(t,s):r||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:s,customRpcUrls:n}){var r,i,a;const c=this.getChainNamespace(e),d=this.getCaipNetworkId(e),C=(r=e.rpcUrls.default.http)===null||r===void 0?void 0:r[0],v=this.getDefaultRpcUrl(e,d,s),w=(e==null||(i=e.rpcUrls)===null||i===void 0||(i=i.chainDefault)===null||i===void 0||(i=i.http)===null||i===void 0?void 0:i[0])||C,E=(n==null||(a=n[d])===null||a===void 0?void 0:a.map(O=>O.url))||[],k=[...E,v],g=[...E];return w&&!g.includes(w)&&g.push(w),{...e,chainNamespace:c,caipNetworkId:d,assets:{imageId:Q.NetworkImageIds[e.id],imageUrl:t==null?void 0:t[e.id]},rpcUrls:{...e.rpcUrls,default:{http:k},chainDefault:{http:g}}}},extendCaipNetworks(e,{customNetworkImageUrls:t,projectId:s,customRpcUrls:n}){return e.map(r=>F.extendCaipNetwork(r,{customNetworkImageUrls:t,customRpcUrls:n,projectId:s}))},getViemTransport(e,t,s){var n;const r=[];return s==null||s.forEach(i=>{r.push($(i.url,i.config))}),te.includes(e.caipNetworkId)&&r.push($(pe(e.caipNetworkId,t),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),e==null||(n=e.rpcUrls)===null||n===void 0||(n=n.default)===null||n===void 0||(n=n.http)===null||n===void 0||n.forEach(i=>{r.push($(i))}),ce(r)},extendWagmiTransports(e,t,s){if(te.includes(e.caipNetworkId)){const n=this.getDefaultRpcUrl(e,e.caipNetworkId,t);return ce([s,$(n)])}return s},getUnsupportedNetwork(e){return{id:e.split(":")[1],caipNetworkId:e,name:u.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(e){var t;const s=A.getActiveCaipNetworkId(),n=o.getAllRequestedCaipNetworks(),r=Array.from(((t=o.state.chains)===null||t===void 0?void 0:t.keys())||[]),i=s==null?void 0:s.split(":")[0],a=i?r.includes(i):!1,c=n==null?void 0:n.find(C=>C.caipNetworkId===s);return a&&!c&&s?this.getUnsupportedNetwork(s):c||e||(n==null?void 0:n[0])}},ee={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},b=re({providers:{...ee},providerIds:{...ee}}),f={state:b,subscribeKey(e,t){return ie(b,e,t)},subscribe(e){return X(b,()=>{e(b)})},subscribeProviders(e){return X(b.providers,()=>e(b.providers))},setProvider(e,t){t&&(b.providers[e]=ke(t))},getProvider(e){return b.providers[e]},setProviderId(e,t){t&&(b.providerIds[e]=t)},getProviderId(e){if(e)return b.providerIds[e]},reset(){b.providers={...ee},b.providerIds={...ee}},resetChain(e){b.providers[e]=void 0,b.providerIds[e]=void 0}};function Y(e,t){return N.getConnectorId(e)===t}function je(e){const t=Array.from(o.state.chains.keys());let s=[];return e?(s.push([e,o.state.chains.get(e)]),Y(e,u.CONNECTOR_ID.WALLET_CONNECT)?t.forEach(n=>{n!==e&&Y(n,u.CONNECTOR_ID.WALLET_CONNECT)&&s.push([n,o.state.chains.get(n)])}):Y(e,u.CONNECTOR_ID.AUTH)&&t.forEach(n=>{n!==e&&Y(n,u.CONNECTOR_ID.AUTH)&&s.push([n,o.state.chains.get(n)])})):s=Array.from(o.state.chains.entries()),s}const j={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};function K(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const he=K({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),ve=K({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"}),gt=K({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"}),mt=K({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),At=K({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0}),qe={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},G={getMethodsByChainNamespace(e){return qe[e]||[]},createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};const s={...e},n=new Set;if(t.methods&&Object.keys(t.methods).forEach(r=>n.add(r)),t.chains&&Object.keys(t.chains).forEach(r=>n.add(r)),t.events&&Object.keys(t.events).forEach(r=>n.add(r)),t.rpcMap&&Object.keys(t.rpcMap).forEach(r=>{const[i]=r.split(":");i&&n.add(i)}),n.forEach(r=>{s[r]||(s[r]=this.createDefaultNamespace(r))}),t.methods&&Object.entries(t.methods).forEach(([r,i])=>{s[r]&&(s[r].methods=i)}),t.chains&&Object.entries(t.chains).forEach(([r,i])=>{s[r]&&(s[r].chains=i)}),t.events&&Object.entries(t.events).forEach(([r,i])=>{s[r]&&(s[r].events=i)}),t.rpcMap){const r=new Set;Object.entries(t.rpcMap).forEach(([i,a])=>{const[c,d]=i.split(":");!c||!d||!s[c]||(s[c].rpcMap||(s[c].rpcMap={}),r.has(c)||(s[c].rpcMap={},r.add(c)),s[c].rpcMap[d]=a)})}return s},createNamespaces(e,t){const s=e.reduce((n,r)=>{const{id:i,chainNamespace:a,rpcUrls:c}=r,d=c.default.http[0];n[a]||(n[a]=this.createDefaultNamespace(a));const C=`${a}:${i}`,v=n[a];switch(v.chains.push(C),C){case he.caipNetworkId:v.chains.push(he.deprecatedCaipNetworkId);break;case ve.caipNetworkId:v.chains.push(ve.deprecatedCaipNetworkId);break;default:}return v!=null&&v.rpcMap&&d&&(v.rpcMap[i]=d),n},{});return this.applyNamespaceOverrides(s,t)},resolveReownName:async e=>{var t;const s=await H.resolveName(e);return((t=(Object.values(s==null?void 0:s.addresses)||[])[0])===null||t===void 0?void 0:t.address)||!1},getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const s=t.chains||[],n=t.accounts.map(r=>{const[i,a]=r.split(":");return`${i}:${a}`});return Array.from(new Set([...s,...n]))})},isSessionEventData(e){return typeof e=="object"&&e!==null&&"id"in e&&"topic"in e&&"params"in e&&typeof e.params=="object"&&e.params!==null&&"chainId"in e.params&&"event"in e.params&&typeof e.params.event=="object"&&e.params.event!==null},isOriginAllowed(e,t,s){for(const n of[...t,...s])if(n.includes("*")){const i=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(e))return!0}else try{if(new URL(n).origin===e)return!0}catch{if(n===e)return!0}return!1}};var ge=class{constructor({provider:e,namespace:t}){this.id=u.CONNECTOR_ID.WALLET_CONNECT,this.name=Q.ConnectorNamesMap[u.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Q.ConnectorImageIds[u.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=o.getCaipNetworks.bind(o),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const t=this.getCaipNetworks(),s=l.state.universalProviderConfigOverride,n=G.createNamespaces(t,s);await this.provider.connect({optionalNamespaces:n})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(t=>t.caipNetworkId);return we.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:He})}};const He=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];var Ke=class{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=t=>o.getCaipNetworks(t),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:u.CONNECTOR_ID.AUTH,type:"AUTH",name:u.CONNECTOR_NAMES.AUTH,provider:e,imageId:Q.ConnectorImageIds[u.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(s=>t.has(s.id)?!1:(t.add(s.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){p.setStatus(e,t)}on(e,t){var s;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(s=this.eventListeners.get(e))===null||s===void 0||s.add(t)}off(e,t){const s=this.eventListeners.get(e);s&&s.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const s=this.eventListeners.get(e);s&&s.forEach(n=>n(t))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:t,providerType:s}=e;if(!e.provider)return;const n="provider"in e.provider?e.provider.provider:e.provider;if(s==="WALLET_CONNECT"){n.setDefaultChain(t.caipNetworkId);return}if(n&&s==="AUTH"){var r;const i=n,a=(r=p.state.preferredAccountTypes)===null||r===void 0?void 0:r[t.chainNamespace];await i.switchNetwork(t.caipNetworkId);const c=await i.getUser({chainId:t.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(t=>t instanceof ge);if(!e)throw new Error("WalletConnectConnector not found");return e}},Ve=class extends Ke{setUniversalProvider(e){this.addConnector(new ge({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){var t;const s=this.provider,n=(s==null||(t=s.session)===null||t===void 0||(t=t.namespaces)===null||t===void 0||(t=t[e])===null||t===void 0||(t=t.accounts)===null||t===void 0?void 0:t.map(r=>{const[,,i]=r.split(":");return i}).filter((r,i,a)=>a.indexOf(r)===i))||[];return Promise.resolve({accounts:n.map(r=>_.createAccount(e,r,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var t,s,n,r,i;if(!(e.caipNetwork&&y.BALANCE_SUPPORTED_CHAINS.includes((t=e.caipNetwork)===null||t===void 0?void 0:t.chainNamespace))||!((s=e.caipNetwork)===null||s===void 0)&&s.testnet)return{balance:"0.00",symbol:((n=e.caipNetwork)===null||n===void 0?void 0:n.nativeCurrency.symbol)||""};if(p.state.balanceLoading&&e.chainId===((r=o.state.activeCaipNetwork)===null||r===void 0?void 0:r.id))return{balance:p.state.balance||"0.00",symbol:p.state.balanceSymbol||""};const d=(await p.fetchTokenBalance()).find(C=>{var v,w;return C.chainId===`${(v=e.caipNetwork)===null||v===void 0?void 0:v.chainNamespace}:${e.chainId}`&&C.symbol===((w=e.caipNetwork)===null||w===void 0?void 0:w.nativeCurrency.symbol)});return{balance:(d==null?void 0:d.quantity.numeric)||"0.00",symbol:(d==null?void 0:d.symbol)||((i=e.caipNetwork)===null||i===void 0?void 0:i.nativeCurrency.symbol)||""}}async signMessage(e){var t,s;const{provider:n,message:r,address:i}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let a="";if(((t=o.state.activeCaipNetwork)===null||t===void 0?void 0:t.chainNamespace)===u.CHAIN.SOLANA){var c;a=(await n.request({method:"solana_signMessage",params:{message:me.encode(new TextEncoder().encode(r)),pubkey:i}},(c=o.state.activeCaipNetwork)===null||c===void 0?void 0:c.caipNetworkId)).signature}else a=await n.request({method:"personal_sign",params:[r,i]},(s=o.state.activeCaipNetwork)===null||s===void 0?void 0:s.caipNetworkId);return{signature:a}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:t}=e,s=this.getWalletConnectConnector();if(t.chainNamespace===u.CHAIN.EVM)try{var n;await((n=s.provider)===null||n===void 0?void 0:n.request({method:"wallet_switchEthereumChain",params:[{chainId:oe(t.id)}]}))}catch(d){var r;if(d.code===j.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||d.code===j.ERROR_INVALID_CHAIN_ID||d.code===j.ERROR_CODE_DEFAULT||(d==null||(r=d.data)===null||r===void 0||(r=r.originalError)===null||r===void 0?void 0:r.code)===j.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{var i,a,c;await((i=s.provider)===null||i===void 0?void 0:i.request({method:"wallet_addEthereumChain",params:[{chainId:oe(t.id),rpcUrls:[t==null||(a=t.rpcUrls.chainDefault)===null||a===void 0?void 0:a.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[(c=t.blockExplorers)===null||c===void 0?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}s.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(s=>s.type==="WALLET_CONNECT");return e==null?void 0:e.provider}};const ze=["email","socials","swaps","onramp","activity","reownBranding"],J={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!(e!=null&&e.config))return!1;const t=e.config;return!!e.isEnabled&&t.includes("email")},processFallback:e=>e===void 0?y.DEFAULT_REMOTE_FEATURES.email:!!e},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!(e!=null&&e.config))return!1;const t=e.config;return e.isEnabled&&t.length>0?t.filter(s=>s!=="email"):!1},processFallback:e=>e===void 0?y.DEFAULT_REMOTE_FEATURES.socials:typeof e=="boolean"?e?y.DEFAULT_REMOTE_FEATURES.socials:!1:e},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!(e!=null&&e.config))return!1;const t=e.config;return e.isEnabled&&t.length>0?t:!1},processFallback:e=>e===void 0?y.DEFAULT_REMOTE_FEATURES.swaps:typeof e=="boolean"?e?y.DEFAULT_REMOTE_FEATURES.swaps:!1:e},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!(e!=null&&e.config))return!1;const t=e.config;return e.isEnabled&&t.length>0?t:!1},processFallback:e=>e===void 0?y.DEFAULT_REMOTE_FEATURES.onramp:typeof e=="boolean"?e?y.DEFAULT_REMOTE_FEATURES.onramp:!1:e},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>e===void 0?y.DEFAULT_REMOTE_FEATURES.activity:!!e},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>e===void 0?y.DEFAULT_REMOTE_FEATURES.reownBranding:!!e}},$e={localSettingsOverridden:new Set,getApiConfig(e,t){return t==null?void 0:t.find(s=>s.id===e)},addWarning(e,t){if(e!==void 0){const s=J[t],n=s.isLegacy?`"features.${s.localFeatureName}" (now "${t}")`:`"features.${t}"`;this.localSettingsOverridden.add(n)}},processFeature(e,t,s,n,r){const i=J[e],a=t[i.localFeatureName];if(r&&!i.isAvailableOnBasic)return!1;if(n){const c=this.getApiConfig(i.apiFeatureName,s);return(c==null?void 0:c.config)===null?this.processFallbackFeature(e,a):c!=null&&c.config?(a!==void 0&&this.addWarning(a,e),this.processApiFeature(e,c)):!1}return this.processFallbackFeature(e,a)},processApiFeature(e,t){return J[e].processApi(t)},processFallbackFeature(e,t){return J[e].processFallback(t)},async fetchRemoteFeatures(e){const t=e.basic??!1,s=e.features||{};this.localSettingsOverridden.clear();let n=null,r=!1;try{n=await Z.fetchProjectConfig(),r=n!=null}catch(a){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",a)}const i=r&&!t?y.DEFAULT_REMOTE_FEATURES:y.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const a of ze){const c=this.processFeature(a,s,n,r,t);Object.assign(i,{[a]:c})}}catch(a){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",a),y.DEFAULT_REMOTE_FEATURES}if(r&&this.localSettingsOverridden.size>0){const a=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;M.open({shortMessage:"Local configuration ignored",longMessage:`[Reown Config Notice] ${a}`},"warning")}return i}};var Ye=class{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(t,s)=>{if(t){var n,r,i;const a=(n=o.getNetworkData(t))===null||n===void 0||(n=n.requestedCaipNetworks)===null||n===void 0?void 0:n.find(C=>C.id===s);if(a)return a;const c=(r=o.getNetworkData(t))===null||r===void 0?void 0:r.caipNetwork;return c||((i=o.getRequestedCaipNetworks(t).filter(C=>C.chainNamespace===t))===null||i===void 0?void 0:i[0])}return o.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>o.getCaipNetworks(t),this.getActiveChainNamespace=()=>o.state.activeChain,this.setRequestedCaipNetworks=(t,s)=>{o.setRequestedCaipNetworks(t,s)},this.getApprovedCaipNetworkIds=()=>o.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>o.state.activeChain===t||!t?o.state.activeCaipAddress:o.getAccountProp("caipAddress",t),this.setClientId=t=>{U.setClientId(t)},this.getProvider=t=>f.getProvider(t),this.getProviderType=t=>f.getProviderId(t),this.getPreferredAccountType=t=>{var s;return(s=p.state.preferredAccountTypes)===null||s===void 0?void 0:s[t]},this.setCaipAddress=(t,s)=>{p.setCaipAddress(t,s),t&&l.state.enableEmbedded&&this.close()},this.setBalance=(t,s,n)=>{p.setBalance(t,s,n)},this.setProfileName=(t,s)=>{p.setProfileName(t,s)},this.setProfileImage=(t,s)=>{p.setProfileImage(t,s)},this.setUser=(t,s)=>{p.setUser(t,s)},this.resetAccount=t=>{p.resetAccount(t)},this.setCaipNetwork=t=>{o.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,s)=>{o.setChainNetworkData(s,{caipNetwork:t})},this.setAllAccounts=(t,s)=>{p.setAllAccounts(t,s),l.setHasMultipleAddresses((t==null?void 0:t.length)>1)},this.setStatus=(t,s)=>{p.setStatus(t,s),N.isConnected()?A.setConnectionStatus("connected"):A.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>o.getAccountProp("address",t),this.setConnectors=t=>{const s=[...N.state.allConnectors,...t];N.setConnectors(s)},this.setConnections=(t,s)=>{T.setConnections(t,s)},this.fetchIdentity=t=>U.fetchIdentity(t),this.getReownName=t=>H.getNamesForAddress(t),this.getConnectors=()=>N.getConnectors(),this.getConnectorImage=t=>be.getConnectorImage(t),this.setConnectedWalletInfo=(t,s)=>{const n=f.getProviderId(s),r=t?{...t,type:n}:void 0;p.setConnectedWalletInfo(r,s)},this.getIsConnectedState=()=>!!o.state.activeCaipAddress,this.addAddressLabel=(t,s,n)=>{p.addAddressLabel(t,s,n)},this.removeAddressLabel=(t,s)=>{p.removeAddressLabel(t,s)},this.getAddress=t=>o.state.activeChain===t||!t?p.state.address:o.getAccountProp("address",t),this.setApprovedCaipNetworksData=t=>o.setApprovedCaipNetworksData(t),this.resetNetwork=t=>{o.resetNetwork(t)},this.addConnector=t=>{N.addConnector(t)},this.resetWcConnection=()=>{T.resetWcConnection()},this.setAddressExplorerUrl=(t,s)=>{p.setAddressExplorerUrl(t,s)},this.setSmartAccountDeployed=(t,s)=>{p.setSmartAccountDeployed(t,s)},this.setSmartAccountEnabledNetworks=(t,s)=>{o.setSmartAccountEnabledNetworks(t,s)},this.setPreferredAccountType=(t,s)=>{p.setPreferredAccountType(t,s)},this.setEIP6963Enabled=t=>{l.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){const s=e==null?void 0:e.map(r=>r.namespace).filter(r=>!!r);if(s!=null&&s.length)return[...new Set(s)];const n=t==null?void 0:t.map(r=>r.chainNamespace);return[...new Set(n)]}async initialize(e){var t,s,n;this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),await this.syncExistingConnection(),this.remoteFeatures=await $e.fetchRemoteFeatures(e),l.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&ne.setOnrampProviders(this.remoteFeatures.onramp),(!((t=l.state.remoteFeatures)===null||t===void 0)&&t.email||Array.isArray((s=l.state.remoteFeatures)===null||s===void 0?void 0:s.socials)&&((n=l.state.remoteFeatures)===null||n===void 0?void 0:n.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){const e=await Z.fetchAllowedOrigins();if(e&&_.isClient()){const t=window.location.origin;G.isOriginAllowed(t,e,j.DEFAULT_ALLOWED_ANCESTORS)||M.open(W.ALERT_ERRORS.INVALID_APP_CONFIGURATION,"error")}else M.open(W.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}sendInitializeEvent(e){var t;const{...s}=e;delete s.adapters,delete s.universalProvider,B.sendEvent({type:"track",event:"INITIALIZE",properties:{...s,networks:e.networks.map(n=>n.id),siweConfig:{options:((t=e.siweConfig)===null||t===void 0?void 0:t.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&P.setThemeMode(e.themeMode),e.themeVariables&&P.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");o.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&o.setActiveCaipNetwork(t)}initializeConnectionController(e){T.setWcBasic(e.basic??!1)}initializeConnectorController(){N.initialize(this.chainNamespaces)}initializeProjectSettings(e){l.setProjectId(e.projectId),l.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var t;l.setDebug(e.debug!==!1),l.setEnableWalletConnect(e.enableWalletConnect!==!1),l.setEnableWalletGuide(e.enableWalletGuide!==!1),l.setEnableWallets(e.enableWallets!==!1),l.setEIP6963Enabled(e.enableEIP6963!==!1),l.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),l.setEnableAuthLogger(e.enableAuthLogger!==!1),l.setCustomRpcUrls(e.customRpcUrls),l.setEnableEmbedded(e.enableEmbedded),l.setAllWallets(e.allWallets),l.setIncludeWalletIds(e.includeWalletIds),l.setExcludeWalletIds(e.excludeWalletIds),l.setFeaturedWalletIds(e.featuredWalletIds),l.setTokens(e.tokens),l.setTermsConditionsUrl(e.termsConditionsUrl),l.setPrivacyPolicyUrl(e.privacyPolicyUrl),l.setCustomWallets(e.customWallets),l.setFeatures(e.features),l.setAllowUnsupportedChain(e.allowUnsupportedChain),l.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),l.setPreferUniversalLinks(e.experimental_preferUniversalLinks),l.setDefaultAccountTypes(e.defaultAccountTypes);const s=A.getPreferredAccountTypes()||{},n={...l.state.defaultAccountTypes,...s};p.setPreferredAccountTypes(n);const r=this.getDefaultMetaData();if(!e.metadata&&r&&(e.metadata=r),l.setMetadata(e.metadata),l.setDisableAppend(e.disableAppend),l.setEnableEmbedded(e.enableEmbedded),l.setSIWX(e.siwx),!e.projectId){M.open(W.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((t=e.adapters)===null||t===void 0?void 0:t.find(a=>a.namespace===u.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");l.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,t,s;return _.isClient()?{name:((e=document.getElementsByTagName("title"))===null||e===void 0||(e=e[0])===null||e===void 0?void 0:e.textContent)||"",description:((t=document.querySelector('meta[property="og:description"]'))===null||t===void 0?void 0:t.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))===null||s===void 0?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const s=F.getUnsupportedNetwork(`${t}:${e}`);o.setActiveCaipNetwork(s)}}getDefaultNetwork(){return F.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return F.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return F.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(n=>{var r;return n.id===((r=e.defaultNetwork)===null||r===void 0?void 0:r.id)});return t?F.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e){try{const t=this.getAdapter(e),s=f.getProvider(e),n=f.getProviderId(e),{caipAddress:r}=o.getAccountData(e)||{};this.setLoading(!0,e),r&&(t!=null&&t.disconnect)&&await t.disconnect({provider:s,providerType:n}),A.removeConnectedNamespace(e),f.resetChain(e),this.setUser(void 0,e),this.setStatus("disconnected",e),this.setConnectedWalletInfo(void 0,e),N.removeConnectorId(e),o.resetAccount(e),o.resetNetwork(e),this.setLoading(!1,e)}catch(t){throw this.setLoading(!1,e),new Error(`Failed to disconnect chain ${e}: ${t.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var e;const t=o.state.activeChain,s=this.getAdapter(t),n=(e=this.getCaipNetwork(t))===null||e===void 0?void 0:e.id;if(!s)throw new Error("Adapter not found");const r=await s.connectWalletConnect(n);this.close(),this.setClientId((r==null?void 0:r.clientId)||null),A.setConnectedNamespaces([...o.state.chains.keys()]),this.chainNamespaces.forEach(i=>{N.setConnectorId(m.CONNECTOR_TYPE_WALLET_CONNECT,i)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:s,provider:n,chain:r,caipNetwork:i,socialUri:a})=>{var c,d;const C=o.state.activeChain,v=r||C,w=this.getAdapter(v);if(r&&r!==C&&!i){const V=this.getCaipNetworks().find(z=>z.chainNamespace===r);V&&this.setCaipNetwork(V)}if(!w)throw new Error("Adapter not found");const E=this.getCaipNetwork(v),k=await w.connect({id:e,info:t,type:s,provider:n,socialUri:a,chainId:(i==null?void 0:i.id)||(E==null?void 0:E.id),rpcUrl:(i==null||(c=i.rpcUrls)===null||c===void 0||(c=c.default)===null||c===void 0||(c=c.http)===null||c===void 0?void 0:c[0])||(E==null||(d=E.rpcUrls)===null||d===void 0||(d=d.default)===null||d===void 0||(d=d.http)===null||d===void 0?void 0:d[0])});if(!k)return;A.addConnectedNamespace(v),this.syncProvider({...k,chainNamespace:v});const g=p.state.allAccounts,{accounts:O}=(g==null?void 0:g.length)>0?{accounts:[...g]}:await w.getAccounts({namespace:v,id:e});this.setAllAccounts(O,v),this.setStatus("connected",v),this.syncConnectedWalletInfo(v)},reconnectExternal:async({id:e,info:t,type:s,provider:n})=>{const r=o.state.activeChain,i=this.getAdapter(r);if(i!=null&&i.reconnect){var a;await(i==null?void 0:i.reconnect({id:e,info:t,type:s,provider:n,chainId:(a=this.getCaipNetwork())===null||a===void 0?void 0:a.id})),A.addConnectedNamespace(r),this.syncConnectedWalletInfo(r)}},disconnect:async e=>{const t=je(e);try{const s=await Promise.allSettled(t.map(async([r])=>this.disconnectNamespace(r)));Te.resetSend(),T.resetWcConnection(),await we.clearSessions(),N.setFilterByNamespace(void 0);const n=s.filter(r=>r.status==="rejected");if(n.length>0)throw new Error(n.map(r=>r.reason.message).join(", "));A.deleteConnectedSocialProvider(),B.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:e||"all"}})}catch(s){throw new Error(`Failed to disconnect chains: ${s.message}`)}},checkInstalled:e=>e?e.some(t=>{var s;return!!(!((s=window.ethereum)===null||s===void 0)&&s[String(t)])}):!!window.ethereum,signMessage:async e=>{const t=this.getAdapter(o.state.activeChain),s=await(t==null?void 0:t.signMessage({message:e,address:p.state.address,provider:f.getProvider(o.state.activeChain)}));return(s==null?void 0:s.signature)||""},sendTransaction:async e=>{const t=e.chainNamespace;if(y.SEND_SUPPORTED_NAMESPACES.includes(t)){const s=this.getAdapter(o.state.activeChain),n=f.getProvider(t),r=await(s==null?void 0:s.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:n}));return(r==null?void 0:r.hash)||""}return""},estimateGas:async e=>{if(e.chainNamespace===u.CHAIN.EVM){const t=this.getAdapter(o.state.activeChain),s=f.getProvider(o.state.activeChain),n=this.getCaipNetwork();if(!n)throw new Error("CaipNetwork is undefined");const r=await(t==null?void 0:t.estimateGas({...e,provider:s,caipNetwork:n}));return(r==null?void 0:r.gas)||0n}return 0n},getEnsAvatar:async()=>{var e;return await this.syncIdentity({address:p.state.address,chainId:Number((e=this.getCaipNetwork())===null||e===void 0?void 0:e.id),chainNamespace:o.state.activeChain}),p.state.profileImage||!1},getEnsAddress:async e=>await G.resolveReownName(e),writeContract:async e=>{const t=this.getAdapter(o.state.activeChain),s=this.getCaipNetwork(),n=this.getCaipAddress(),r=f.getProvider(o.state.activeChain);if(!s||!n)throw new Error("CaipNetwork or CaipAddress is undefined");const i=await(t==null?void 0:t.writeContract({...e,caipNetwork:s,provider:r,caipAddress:n}));return i==null?void 0:i.hash},parseUnits:(e,t)=>{const s=this.getAdapter(o.state.activeChain);return(s==null?void 0:s.parseUnits({value:e,decimals:t}))??0n},formatUnits:(e,t)=>{const s=this.getAdapter(o.state.activeChain);return(s==null?void 0:s.formatUnits({value:e,decimals:t}))??"0"},getCapabilities:async e=>{const t=this.getAdapter(o.state.activeChain);return await(t==null?void 0:t.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(o.state.activeChain);return await(t==null?void 0:t.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(o.state.activeChain);return t!=null&&t.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(o.state.activeChain);return await(t==null?void 0:t.walletGetAssets(e))??{}},updateBalance:e=>{const t=this.getCaipNetwork(e);!t||!p.state.address||this.updateNativeBalance(p.state.address,t==null?void 0:t.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},T.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(f.getProviderId(o.state.activeChain)===m.CONNECTOR_TYPE_WALLET_CONNECT){var t,s;const n=(t=this.universalProvider)===null||t===void 0||(t=t.session)===null||t===void 0?void 0:t.namespaces;return{supportsAllNetworks:((s=this.universalProvider)===null||s===void 0||(s=s.session)===null||s===void 0||(s=s.peer)===null||s===void 0?void 0:s.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const n=f.getProvider(t),r=f.getProviderId(t);if(e.chainNamespace===o.state.activeChain){const i=this.getAdapter(t);await(i==null?void 0:i.switchNetwork({caipNetwork:e,provider:n,providerType:r}))}else if(this.setCaipNetwork(e),r===m.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const i=this.getAddressByChainNamespace(t);i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const s=t.chains||[],n=t.accounts.map(r=>{const{chainId:i,chainNamespace:a}=S.parseCaipAddress(r);return`${a}:${i}`});return Array.from(new Set([...s,...n]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,s)=>{const n=e==null?void 0:e.find(i=>i.namespace===s);if(n){var r;n.construct({namespace:s,projectId:(r=this.options)===null||r===void 0?void 0:r.projectId,networks:this.getCaipNetworks()}),t[s]=n}else t[s]=new Ve({namespace:s,networks:this.getCaipNetworks()});return t},{})}async initChainAdapter(e){var t;this.onConnectors(e),this.listenAdapter(e),await((t=this.chainAdapters)===null||t===void 0?void 0:t[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const t=this.getAdapter(e);t==null||t.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const s=A.getConnectionStatus();s==="connected"?this.setStatus("connecting",e):s==="disconnected"?(A.clearAddressCache(),this.setStatus(s,e)):this.setStatus(s,e),t.on("switchNetwork",({address:n,chainId:r})=>{const i=this.getCaipNetworks().find(d=>d.id===r||d.caipNetworkId===r),a=o.state.activeChain===e,c=o.getAccountProp("address",e);if(i){const d=a&&n?n:c;d&&this.syncAccount({address:d,chainId:i.id,chainNamespace:e})}else this.setUnsupportedNetwork(r)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("connections",n=>{this.setConnections(n,e)}),t.on("pendingTransactions",()=>{const n=p.state.address,r=o.state.activeCaipNetwork;!n||!(r!=null&&r.id)||this.updateNativeBalance(n,r.id,r.chainNamespace)}),t.on("accountChanged",({address:n,chainId:r})=>{var i,a;const c=o.state.activeChain===e;c&&r?this.syncAccount({address:n,chainId:r,chainNamespace:e}):c&&(!((i=o.state.activeCaipNetwork)===null||i===void 0)&&i.id)?this.syncAccount({address:n,chainId:(a=o.state.activeCaipNetwork)===null||a===void 0?void 0:a.id,chainNamespace:e}):this.syncAccountInfo(n,r,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){var t,s;await this.getUniversalProvider(),this.universalProvider&&((t=this.chainAdapters)===null||t===void 0||(t=t[e])===null||t===void 0||(s=t.setUniversalProvider)===null||s===void 0||s.call(t,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{e===u.CHAIN.EVM&&_.isSafeApp()&&N.setConnectorId(u.CONNECTOR_ID.SAFE,e);const t=N.getConnectorId(e);switch(this.setStatus("connecting",e),t){case u.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case u.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){const t=this.getAdapter(e),s=N.getConnectorId(e),n=this.getCaipNetwork(e),i=N.getConnectors(e).find(c=>c.id===s);try{var a;if(!t||!i)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(n!=null&&n.id))throw new Error("CaipNetwork not found");const c=await(t==null?void 0:t.syncConnection({namespace:e,id:i.id,chainId:n.id,rpcUrl:n==null||(a=n.rpcUrls)===null||a===void 0||(a=a.default)===null||a===void 0||(a=a.http)===null||a===void 0?void 0:a[0]}));if(c){const d=await(t==null?void 0:t.getAccounts({namespace:e,id:i.id}));d&&d.accounts.length>0?this.setAllAccounts(d.accounts,e):this.setAllAccounts([_.createAccount(e,c.address,"eoa")],e),this.syncProvider({...c,chainNamespace:e}),await this.syncAccount({...c,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch{this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){const e=this.chainNamespaces.map(async t=>{var s,n;const r=this.getAdapter(t),i=((s=this.universalProvider)===null||s===void 0||(s=s.session)===null||s===void 0||(s=s.namespaces)===null||s===void 0||(s=s[t])===null||s===void 0?void 0:s.accounts)||[],a=(n=o.state.activeCaipNetwork)===null||n===void 0?void 0:n.id,c=i.find(d=>{const{chainId:C}=S.parseCaipAddress(d);return C===(a==null?void 0:a.toString())})||i[0];if(c){const d=S.validateCaipAddress(c),{chainId:C,address:v}=S.parseCaipAddress(d);if(f.setProviderId(t,m.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&o.state.activeCaipNetwork&&(r==null?void 0:r.namespace)!==u.CHAIN.EVM){const w=r==null?void 0:r.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:o.state.activeCaipNetwork});f.setProvider(t,w)}else f.setProvider(t,this.universalProvider);N.setConnectorId(u.CONNECTOR_ID.WALLET_CONNECT,t),A.addConnectedNamespace(t),this.syncWalletConnectAccounts(t),await this.syncAccount({address:v,chainId:C,chainNamespace:t})}else this.setStatus("disconnected",t);this.syncConnectedWalletInfo(t),await o.setApprovedCaipNetworksData(t)});await Promise.all(e)}syncWalletConnectAccounts(e){var t;const s=(t=this.universalProvider)===null||t===void 0||(t=t.session)===null||t===void 0||(t=t.namespaces)===null||t===void 0||(t=t[e])===null||t===void 0||(t=t.accounts)===null||t===void 0?void 0:t.map(n=>{const{address:r}=S.parseCaipAddress(n);return r}).filter((n,r,i)=>i.indexOf(n)===r);s&&this.setAllAccounts(s.map(n=>_.createAccount(e,n,e==="bip122"?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:s,chainNamespace:n}){f.setProviderId(n,e),f.setProvider(n,t),N.setConnectorId(s,n)}async syncAllAccounts(e){const t=N.getConnectorId(e);if(!t)return;const s=this.getAdapter(e),n=await(s==null?void 0:s.getAccounts({namespace:e,id:t}));n&&n.accounts.length>0&&this.setAllAccounts(n.accounts,e)}async syncAccount(e){var t;const s=e.chainNamespace===o.state.activeChain,n=o.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:r,chainId:i,chainNamespace:a}=e,{chainId:c}=A.getActiveNetworkProps(),d=i||c,C=((t=o.state.activeCaipNetwork)===null||t===void 0?void 0:t.name)===u.UNSUPPORTED_NETWORK_NAME,v=o.getNetworkProp("supportsAllNetworks",a);if(this.setStatus("connected",a),!(C&&!v)&&d){var w;let E=this.getCaipNetworks().find(O=>O.id.toString()===d.toString()),k=this.getCaipNetworks().find(O=>O.chainNamespace===a);if(!v&&!E&&!k){const O=this.getApprovedCaipNetworkIds()||[],V=O.find(R=>{var L;return((L=S.parseCaipNetworkId(R))===null||L===void 0?void 0:L.chainId)===d.toString()}),z=O.find(R=>{var L;return((L=S.parseCaipNetworkId(R))===null||L===void 0?void 0:L.chainNamespace)===a});E=this.getCaipNetworks().find(R=>R.caipNetworkId===V),k=this.getCaipNetworks().find(R=>R.caipNetworkId===z||"deprecatedCaipNetworkId"in R&&R.deprecatedCaipNetworkId===z)}const g=E||k;(g==null?void 0:g.chainNamespace)===o.state.activeChain?l.state.enableNetworkSwitch&&!l.state.allowUnsupportedChain&&((w=o.state.activeCaipNetwork)===null||w===void 0?void 0:w.name)===u.UNSUPPORTED_NETWORK_NAME?o.showUnsupportedChainUI():this.setCaipNetwork(g):s||n&&this.setCaipNetworkOfNamespace(n,a),this.syncConnectedWalletInfo(a),Pe.isLowerCaseMatch(r,p.state.address)||this.syncAccountInfo(r,g==null?void 0:g.id,a),s?await this.syncBalance({address:r,chainId:g==null?void 0:g.id,chainNamespace:a}):await this.syncBalance({address:r,chainId:n==null?void 0:n.id,chainNamespace:a})}}async syncAccountInfo(e,t,s){const n=this.getCaipAddress(s),r=t||(n==null?void 0:n.split(":")[1]);if(!r)return;const i=`${s}:${r}:${e}`;this.setCaipAddress(i,s),await this.syncIdentity({address:e,chainId:r,chainNamespace:s})}async syncReownName(e,t){try{const s=await this.getReownName(e);if(s[0]){const n=s[0];this.setProfileName(n.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){const t=N.getConnectorId(e),s=f.getProviderId(e);if(s===m.CONNECTOR_TYPE_ANNOUNCED||s===m.CONNECTOR_TYPE_INJECTED){if(t){const r=this.getConnectors().find(i=>i.id===t);if(r){const{info:i,name:a,imageUrl:c}=r,d=c||this.getConnectorImage(r);this.setConnectedWalletInfo({name:a,icon:d,...i},e)}}}else if(s===m.CONNECTOR_TYPE_WALLET_CONNECT){var n;const r=f.getProvider(e);r!=null&&r.session&&this.setConnectedWalletInfo({...r.session.peer.metadata,name:r.session.peer.metadata.name,icon:(n=r.session.peer.metadata.icons)===null||n===void 0?void 0:n[0]},e)}else if(t&&t===u.CONNECTOR_ID.COINBASE){const r=this.getConnectors().find(i=>i.id===u.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(r)},e)}}async syncBalance(e){!Ie.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(s=>{var n;return s.id.toString()===((n=e.chainId)===null||n===void 0?void 0:n.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,s){const n=this.getAdapter(s),r=o.getCaipNetworkByNamespace(s,t);if(n){const i=await n.getBalance({address:e,chainId:t,caipNetwork:r,tokens:this.options.tokens});return this.setBalance(i.balance,i.symbol,s),i}}async initializeUniversalAdapter(){var e,t,s,n,r,i,a,c,d,C;const v=Be.createLogger((E,...k)=>{E&&this.handleAlertError(E),console.error(...k)}),w={projectId:(e=this.options)===null||e===void 0?void 0:e.projectId,metadata:{name:!((t=this.options)===null||t===void 0)&&t.metadata?(s=this.options)===null||s===void 0?void 0:s.metadata.name:"",description:!((n=this.options)===null||n===void 0)&&n.metadata?(r=this.options)===null||r===void 0?void 0:r.metadata.description:"",url:!((i=this.options)===null||i===void 0)&&i.metadata?(a=this.options)===null||a===void 0?void 0:a.metadata.url:"",icons:!((c=this.options)===null||c===void 0)&&c.metadata?(d=this.options)===null||d===void 0?void 0:d.metadata.icons:[""]},logger:v};l.setManualWCControl(!!(!((C=this.options)===null||C===void 0)&&C.manualWCControl)),this.universalProvider=this.options.universalProvider??await Re.init(w),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{T.setUri(e)}),this.universalProvider.on("connect",T.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),T.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{const t=this.getCaipNetworks().find(n=>n.id==e),s=this.getCaipNetwork();if(!t){this.setUnsupportedNetwork(e);return}(s==null?void 0:s.id)!==(t==null?void 0:t.id)&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(G.isSessionEventData(e)){const{name:t,data:s}=e.params.event;t==="accountsChanged"&&Array.isArray(s)&&_.isCaipAddress(s[0])&&this.syncAccount(S.parseCaipAddress(s[0]))}}))}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&_.isClient()&&(!((e=this.options)===null||e===void 0)&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){B.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries(W.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[s,n]=t??[],{message:r,alertErrorKey:i}=n??{};if(s&&r&&!this.reportedAlertErrors[s]){const a=W.ALERT_ERRORS[i];a&&(M.open(a,"error"),this.reportedAlertErrors[s]=!0)}}getAdapter(e){var t;if(e)return(t=this.chainAdapters)===null||t===void 0?void 0:t[e]}createAdapter(e){var t;if(!e)return;const s=e.namespace;if(!s)return;this.createClients();const n=e;n.namespace=s,n.construct({namespace:s,projectId:(t=this.options)===null||t===void 0?void 0:t.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(s)||this.chainNamespaces.push(s),this.chainAdapters&&(this.chainAdapters[s]=n)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&T.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return x.open({...e,data:{swap:e.arguments}});default:}return x.open(e)}async close(){await this.injectModalUi(),x.close()}setLoading(e,t){x.setLoading(e,t)}async disconnect(e){await T.disconnect(e)}getSIWX(){return l.state.siwx}getError(){return""}getChainId(){var e;return(e=o.state.activeCaipNetwork)===null||e===void 0?void 0:e.id}async switchNetwork(e){const t=this.getCaipNetworks().find(s=>s.id===e.id);if(!t){M.open(W.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await o.switchActiveNetwork(t)}getWalletProvider(){return o.state.activeChain?f.state.providers[o.state.activeChain]:null}getWalletProviderType(){return f.getProviderId(o.state.activeChain)}subscribeProviders(e){return f.subscribeProviders(e)}getThemeMode(){return P.state.themeMode}getThemeVariables(){return P.state.themeVariables}setThemeMode(e){P.setThemeMode(e),Oe(P.state.themeMode)}setTermsConditionsUrl(e){l.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){l.setPrivacyPolicyUrl(e)}setThemeVariables(e){P.setThemeVariables(e),_e(P.state.themeVariables)}subscribeTheme(e){return P.subscribe(e)}getWalletInfo(){return p.state.connectedWalletInfo}getAccount(e){var t;const s=N.getAuthConnector(e),n=o.getAccountData(e),r=o.state.activeChain,i=A.getConnectedConnectorId(e||r);if(n)return{allAccounts:n.allAccounts,caipAddress:n.caipAddress,address:_.getPlainAddress(n.caipAddress),isConnected:!!n.caipAddress,status:n.status,embeddedWalletInfo:s&&i===u.CONNECTOR_ID.AUTH?{user:n.user?{...n.user,username:A.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:(t=n.preferredAccountTypes)===null||t===void 0?void 0:t[e||r],isSmartAccountDeployed:!!n.smartAccountDeployed}:void 0}}subscribeAccount(e,t){const s=()=>{const n=this.getAccount(t);n&&e(n)};t?o.subscribeChainProp("accountState",s,t):o.subscribe(s),N.subscribe(s)}subscribeNetwork(e){return o.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t==null?void 0:t.id,caipNetworkId:t==null?void 0:t.caipNetworkId})})}subscribeWalletInfo(e){return p.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){p.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){o.subscribeKey("activeCaipNetwork",e)}getState(){return de.state}subscribeState(e){return de.subscribe(e)}showErrorMessage(e){le.showError(e)}showSuccessMessage(e){le.showSuccess(e)}getEvent(){return{...B.state}}subscribeEvents(e){return B.subscribe(e)}replace(e){D.replace(e)}redirect(e){D.push(e)}popTransactionStack(e){D.popTransactionStack(e)}isOpen(){return x.state.open}isTransactionStackEmpty(){return D.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){l.setFeatures(e)}updateRemoteFeatures(e){l.setRemoteFeatures(e)}updateOptions(e){const s={...l.state||{},...e};l.setOptions(s)}setConnectMethodsOrder(e){l.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){l.setWalletFeaturesOrder(e)}setCollapseWallets(e){l.setCollapseWallets(e)}setSocialsOrder(e){l.setSocialsOrder(e)}getConnectMethodsOrder(){return Ue.getConnectOrderMethod(l.state.features,N.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const s=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(n=>n.id===s.id)||o.addNetwork(s)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(n=>n.id===t)&&o.removeNetwork(e,t)}};let Ce=!1;var Je=class extends Ye{async open(e){N.isConnected()||await super.open(e)}async close(){await super.close(),this.options.manualWCControl&&T.finalizeWcConnection()}async syncIdentity(e){return Promise.resolve()}async syncBalance(e){return Promise.resolve()}async injectModalUi(){if(!Ce&&_.isClient()){if(await ae(()=>import("./basic-DiskHcyG.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),await ae(()=>import("./w3m-modal-JAA4YQhx.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,12,13,14,15,16,17,18,19,20,21])),!document.querySelector("w3m-modal")){const t=document.createElement("w3m-modal");!l.state.disableAppend&&!l.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",t)}Ce=!0}}};const Ge="1.7.8";function Et(e){return new Je({...e,basic:!0,sdkVersion:`html-core-${Ge}`})}export{Je as AppKit,Et as createAppKit};
