import{Code as x,ConnectError as P,MethodKind as b}from"./connect-transport-9OnIgPz5.js";function V(r,a){const u={};for(const[l,e]of Object.entries(r.methods)){const n=a(Object.assign(Object.assign({},e),{localName:l,service:r}));n!=null&&(u[l]=n)}return u}var T=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r[Symbol.asyncIterator],u;return a?a.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),u={},l("next"),l("throw"),l("return"),u[Symbol.asyncIterator]=function(){return this},u);function l(n){u[n]=r[n]&&function(i){return new Promise(function(c,d){i=r[n](i),e(c,d,i.done,i.value)})}}function e(n,i,c,d){Promise.resolve(d).then(function(v){n({value:v,done:c})},i)}},w=function(r){return this instanceof w?(this.v=r,this):new w(r)},C=function(r,a,u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=u.apply(r,a||[]),e,n=[];return e={},c("next"),c("throw"),c("return",i),e[Symbol.asyncIterator]=function(){return this},e;function i(t){return function(o){return Promise.resolve(o).then(t,s)}}function c(t,o){l[t]&&(e[t]=function(f){return new Promise(function(h,g){n.push([t,f,h,g])>1||d(t,f)})},o&&(e[t]=o(e[t])))}function d(t,o){try{v(l[t](o))}catch(f){y(n[0][3],f)}}function v(t){t.value instanceof w?Promise.resolve(t.value.v).then(m,s):y(n[0][2],t)}function m(t){d("next",t)}function s(t){d("throw",t)}function y(t,o){t(o),n.shift(),n.length&&d(n[0][0],n[0][1])}},D=function(r){var a,u;return a={},l("next"),l("throw",function(e){throw e}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(e,n){a[e]=r[e]?function(i){return(u=!u)?{value:w(r[e](i)),done:!1}:n?n(i):i}:n}};function M(r){return C(this,arguments,function*(){yield w(yield*D(T(r)))})}var S=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r[Symbol.asyncIterator],u;return a?a.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),u={},l("next"),l("throw"),l("return"),u[Symbol.asyncIterator]=function(){return this},u);function l(n){u[n]=r[n]&&function(i){return new Promise(function(c,d){i=r[n](i),e(c,d,i.done,i.value)})}}function e(n,i,c,d){Promise.resolve(d).then(function(v){n({value:v,done:c})},i)}},_=function(r){return this instanceof _?(this.v=r,this):new _(r)},j=function(r){var a,u;return a={},l("next"),l("throw",function(e){throw e}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(e,n){a[e]=r[e]?function(i){return(u=!u)?{value:_(r[e](i)),done:!1}:n?n(i):i}:n}},E=function(r,a,u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=u.apply(r,a||[]),e,n=[];return e={},c("next"),c("throw"),c("return",i),e[Symbol.asyncIterator]=function(){return this},e;function i(t){return function(o){return Promise.resolve(o).then(t,s)}}function c(t,o){l[t]&&(e[t]=function(f){return new Promise(function(h,g){n.push([t,f,h,g])>1||d(t,f)})},o&&(e[t]=o(e[t])))}function d(t,o){try{v(l[t](o))}catch(f){y(n[0][3],f)}}function v(t){t.value instanceof _?Promise.resolve(t.value.v).then(m,s):y(n[0][2],t)}function m(t){d("next",t)}function s(t){d("throw",t)}function y(t,o){t(o),n.shift(),n.length&&d(n[0][0],n[0][1])}};function O(r,a){return V(r,u=>{switch(u.kind){case b.Unary:return F(a,r,u);case b.ServerStreaming:return G(a,r,u);case b.ClientStreaming:return $(a,r,u);case b.BiDiStreaming:return A(a,r,u);default:return null}})}function F(r,a,u){return async function(l,e){var n,i;const c=await r.unary(a,u,e==null?void 0:e.signal,e==null?void 0:e.timeoutMs,e==null?void 0:e.headers,l,e==null?void 0:e.contextValues);return(n=e==null?void 0:e.onHeader)===null||n===void 0||n.call(e,c.header),(i=e==null?void 0:e.onTrailer)===null||i===void 0||i.call(e,c.trailer),c.message}}function G(r,a,u){return function(l,e){return I(r.stream(a,u,e==null?void 0:e.signal,e==null?void 0:e.timeoutMs,e==null?void 0:e.headers,M([l]),e==null?void 0:e.contextValues),e)}}function $(r,a,u){return async function(l,e){var n,i,c,d,v,m;const s=await r.stream(a,u,e==null?void 0:e.signal,e==null?void 0:e.timeoutMs,e==null?void 0:e.headers,l,e==null?void 0:e.contextValues);(v=e==null?void 0:e.onHeader)===null||v===void 0||v.call(e,s.header);let y;try{for(var t=!0,o=S(s.message),f;f=await o.next(),n=f.done,!n;t=!0)d=f.value,t=!1,y=d}catch(h){i={error:h}}finally{try{!t&&!n&&(c=o.return)&&await c.call(o)}finally{if(i)throw i.error}}if(!y)throw new P("protocol error: missing response message",x.Internal);return(m=e==null?void 0:e.onTrailer)===null||m===void 0||m.call(e,s.trailer),y}}function A(r,a,u){return function(l,e){return I(r.stream(a,u,e==null?void 0:e.signal,e==null?void 0:e.timeoutMs,e==null?void 0:e.headers,l,e==null?void 0:e.contextValues),e)}}function I(r,a){const u=(function(){var l,e;return E(this,arguments,function*(){const n=yield _(r);(l=a==null?void 0:a.onHeader)===null||l===void 0||l.call(a,n.header),yield _(yield*j(S(n.message))),(e=a==null?void 0:a.onTrailer)===null||e===void 0||e.call(a,n.trailer)})})()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>u.next()})}}export{O as createPromiseClient};
