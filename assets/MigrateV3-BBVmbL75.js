import{__toESM as _t}from"./chunk-DgAfPHQg.js";import"./preload-helper-CaakwtpC.js";import"./i18next-DD3sT7R5.js";import{require_react as kt}from"./react-CNoFhWkx.js";import{Button as Tt,INTERFACE_NAV_HEIGHT as St,Trans as W}from"./src-DOOtfpHS.js";import{useTranslation as Pt}from"./useTranslation-BotBuoJf.js";import"./index.web-BqgtOHN3.js";import"./constants-CrXoXfFH.js";import{useDispatch as At}from"./es-Iwj7vF3u.js";import"./react-dom-xovCOntK.js";import"./react-is-BJXMVkew.js";import{ReactQueryCacheKey as Ct}from"./cache-BFZkIToX.js";import"./dist-Q7olfaoJ.js";import"./tslib.es6-Dbpxy1u8.js";import"./dist-QCpUvRkJ.js";import{useLocation as bt,useNavigate as jt,useParams as K}from"./chunk-QMGIS6GS-B91ZVkXt.js";import{require_jsx_runtime as Et}from"./jsx-runtime-D7bMTQeG.js";import{useUniswapContext as Rt}from"./useEnabledChains-DuB86c95.js";import{logger as Z}from"./hooks-BXO4d1DJ.js";import"./dist-ceZDlR1V.js";import"./analytics.web-DLc1_wTk.js";import"./redux-toolkit.esm-BnRUBto_.js";import"./utils-CK6a47NA.js";import{CurrencyAmount as J,ZERO_ADDRESS as Y,init_sdk_core_esm as wt}from"./utils-BX1Fu73x.js";import"./bn-D7somgUb.js";import"./lib-DPFIyRke.js";import"./misc-BMnlqqV4.js";import{currencyId as tt,currencyIdToAddress as rt}from"./currencyId-Ci6selsx.js";import"./constants-vVZBLDwL.js";import"./constants-CZ9iND_H.js";import"./slice-DimuiOR8.js";import"./config-C4KrHqHG.js";import{ONE_SECOND_MS as it}from"./time-D_OqcZ4M.js";import"./wallet-gHLp87c6.js";import"./features-yACC1hVw.js";import{InterfaceEventName as Lt}from"./interface-BdpC4qOF.js";import"./TokenSelector-CNVK2itZ.js";import"./element-Wnp4RkdY.js";import{ModalName as qt}from"./modal-Dvm06CN4.js";import{InterfacePageName as Mt}from"./page-zDkoCQe4.js";import"./uniswap-Bm-6KILn.js";import"./isAddress-P2vaZgmG.js";import"./chain-ghiO403o.js";import"./slice-cfC6NcyN.js";import"./node-C_BraYgX.js";import"./formatUnits-DkyMpOD7.js";import"./_u64-b_viZRi_.js";import"./sha2-Jt0E41S_.js";import"./sha256-BqbhXHGu.js";import"./call-CTDbaN-t.js";import"./parseAccount-CRyN5swV.js";import"./encodeFunctionData-CD63gkvM.js";import"./public-fap09Zv6.js";import"./stringify-B82RFruy.js";import"./rpc-nQR4Ijs4.js";import"./dist-CBK-d0jO.js";import"./hmac-D-QTodfL.js";import"./linking-D29RyAR8.js";import"./lib-CKG8APVv.js";import"./lib-XGdDYWzD.js";import"./V3DutchOrderTrade-Cl7yELmp.js";import"./v3-sdk.esm-CHH6GWR1.js";import"./hash-05APZTFm.js";import"./inherits_browser-Dqx8HagI.js";import{useQuery as Vt}from"./useQuery-D_ZCw8XG.js";import"./lib-CWHZrl0T.js";import"./v2-sdk.esm-CIiDMO7F.js";import"./lib-BncBk3QF.js";import"./utils-7WDx1QGa.js";import"./lib-CgeiDO5B.js";import"./lib-Dj-AwQVD.js";import"./types-DbOmsKtk.js";import"./getCurrencyAmount-vvZpAzIm.js";import{isSameAddress as Nt}from"./addresses-D56PBUHX.js";import"./currency-DIOEzjz2.js";import"./ms-BqmEYo6j.js";import"./configs-B4dDdw82.js";import"./hooks-Bp0VtWbX.js";import"./statsig-B7I9iQRf.js";import"./usePollingIntervalByChain-YBOfXXzb.js";import"./providers-BELGpWsr.js";import"./erc20-CdGGKIp0.js";import"./getContract-CMwwszTa.js";import"./objects-DlLkJwrJ.js";import{sendAnalyticsEvent as Dt}from"./send.web-CrSXW2rw.js";import{UniversalRouterVersion as Ot,migrateLpPosition as Ut}from"./TradingApiClient-Cp_0ez5S.js";import"./useDependentAmountFallback-CjPCh_wT.js";import{ProtocolItems as z}from"./ProtocolItems-DhZWSiXS.js";import"./selectors-BwkayGDl.js";import{useUSDCValue as ot}from"./useUSDCPrice-HO7Wgroz.js";import"./balances-DV0Wvmri.js";import"./getCurrencySafetyInfo-BHD1ohD-.js";import"./mutation-CRQvRc5_.js";import"./infiniteQueryBehavior-C10I_UVS.js";import"./connector-Cw8HJLtm.js";import"./queryOptions-P48mrm5X.js";import"./connect-transport-9OnIgPz5.js";import"./proto3-DkSQZto4.js";import"./embeddedWallet-BdHUTaHg.js";import"./use-query-8AOGtvlP.js";import"./promise-client-BYLTs0DC.js";import{uniswapUrls as Bt}from"./urls-kwiZbYPW.js";import"./createApiClient-BjXZMbEB.js";import"./constants-D9cStT7K.js";import"./base-DVpWJ4NW.js";import{PositionStatus as Ft,ProtocolVersion as s}from"./types_pb-yZxlo4b1.js";import"./hooks-Dhx5teK4.js";import"./transactionDetails-BsNW_jus.js";import"./types-JuyYLR0O.js";import"./LocalizationContext-B31peW1_.js";import"./getAlertColor-J5DrJWHv.js";import"./currency-xm5i4cH7.js";import"./ethers-D2SIY1xg.js";import"./useSupportedChainId-DskHoisQ.js";import{useWallet as $t}from"./useWallet-CL5owP9P.js";import{useTrace as It}from"./TraceContext-Ddfk7zjz.js";import{TransactionStepType as et}from"./types-7DAoWLTI.js";import{getLPBaseAnalyticsProperties as Wt}from"./analytics-UE3_EENu.js";import"./types-BSmAADNJ.js";import"./eventemitter3-DFes51ku.js";import"./eventemitter3-BHLpX1jX.js";import"./dist-BWRHWQ_J.js";import"./readContract-Cae4hIjn.js";import"./recoverAddress-oPdWABRo.js";import"./getBalance-TsPVbzB5.js";import"./localBatchGatewayRequest-CdT4Kija.js";import"./createBatchScheduler-BJBpfhFD.js";import"./createTransport-WEDNYdh5.js";import"./useEthersProvider-CBgc_azi.js";import"./http-CIklBnX8.js";import"./wagmiConfig-0BYSDqyO.js";import"./hashMessage-DdzTBpWL.js";import"./multicall-BYS6jvE9.js";import"./secp256k1-fbKD5lyl.js";import"./getAction-BBhbL9mE.js";import{useAccount as Q}from"./useAccount-C5hwiBwN.js";import"./config-CDfnfyHL.js";import"./useCurrencyBalance-BuHM_Z2M.js";import"./useReadContracts-Orb8TypL.js";import"./wagmi-CsUiFCSO.js";import"./useSwitchChain-CY8eYAUF.js";import"./query-qNZtVuxH.js";import"./constants-CGJJmXwV.js";import"./utils-CDaPKk14.js";import"./zIndex-CmEE31Ab.js";import"./passkey.web-DakcatU3.js";import"./hex-njd-4N-2.js";import"./slice-qANrfSbi.js";import"./noop-BDbB2pLB.js";import"./walletMeta-DaLhfhet.js";import"./signing-DH5GfhKu.js";import"./i18n-CroUvoJw.js";import"./v4-D6Rlvprs.js";import"./errors-BaezSPLl.js";import"./swapErrorToUserReadableMessage-DgHZMHU-.js";import{LiquidityTransactionType as nt,getErrorMessageToDisplay as gt,isSignerMnemonicAccountDetails as zt,isValidLiquidityTxContext as Ht,liquiditySaga as Kt,parseErrorMessageTitle as at,validatePermit as Qt,validateTransactionRequest as mt}from"./AccountDetails-pkaz6EG4.js";import{Flex as st,Text as H,styled as Gt,useMedia as Xt}from"./Loader-D83W8G1W.js";import"./client-BlU1ozBP.js";import"./Anchor-B1nkrQbP.js";import"./Input-ClKbNpxm.js";import"./Checkbox-Id3GDHn8.js";import{Main as Zt}from"./esm-yo3h-xhx.js";import"./AnimatePresencePager-Dk43KD9E.js";import"./HeightAnimator-DF8znv78.js";import{ProgressIndicator as Jt}from"./getTradeSettingsDeadline-B3uZN4NF.js";import"./CurrencyInputPanel-CJ-UCFJ3.js";import"./urls-aCnKF23w.js";import"./useNewChainIds-CIAogFpa.js";import"./encode-utf8-DiSL6KQ9.js";import"./dijkstra-6umg7ymP.js";import"./UniconSVGs-CVEtuhJW.js";import"./NetworkFilter-ZFjNguMa.js";import"./AlertTriangleFilled-C9tf2eUJ.js";import{ArrowDown as Yt}from"./ArrowDown-B8kFPZPX.js";import{LiquidityPositionCard as tr}from"./LiquidityPositionCard-BpA_IBXB.js";import"./Blocked-BNx3Epiv.js";import"./CheckmarkCircle-Znmo2ojy.js";import"./CoinConvert-D8dLJ8GW.js";import{Container as rr,CreateLiquidityContextProvider as ir,DEFAULT_DEPOSIT_STATE as or,DEFAULT_PRICE_RANGE_STATE as er,SelectTokensStep as nr,useCreateLiquidityContext as vt,useLiquidityUrlState as ar}from"./SelectTokenStep-D9-QE57B.js";import"./CopyAlt-CU_LJNbN.js";import"./LpIncentivesAprDisplay-DAZ9W112.js";import{EditSelectTokensStep as mr,PoolProgressIndicator as sr,SelectPriceRangeStep as pr,SharedCreateModals as cr}from"./CreatePosition-B-Q_0Pom.js";import"./Eye-D482ahgC.js";import"./EyeOff-BiBJTOh0.js";import"./LiquidityPositionRangeChart-CJw3rPyq.js";import"./InfoCircleFilled-CBAL5Wj0.js";import"./Minus-CNfbH3_0.js";import"./MoreHorizontal-BC-VtLFW.js";import"./index.esm-CLP40SHA.js";import"./Passkey-Bey7xD4Z.js";import"./Person-B27R6hM-.js";import"./Plus-_LmEFxOC.js";import"./Pools-DKYxZO3F.js";import"./ReceiveAlt-nuO9D5GJ.js";import{ErrorCallout as pt,RotateLeft as ur}from"./ErrorCallout-YxcfJphA.js";import"./clipboard.web-CNSIHgMi.js";import"./SplitLogo-Ct--07LT.js";import{LoadingRow as x}from"./LiquidityPositionInfo-Cs-PVI1A.js";import"./AnimatedFlex-BgzbJK30.js";import"./reducer-CcXO4HTO.js";import{useSelectChain as dr}from"./useSelectChain-CA5zoRWi.js";import"./tokens-Dxd89cHj.js";import"./prices-BzyZhpWW.js";import"./timing-DsWr56iv.js";import"./experiments-rc6XUB0U.js";import"./SwapFormStoreContext-3NrPQE3L.js";import"./useSwapFormStore-D1oVGbBf.js";import{PermitMethod as lr}from"./swapTxAndGasInfo-DxVAGFqc.js";import"./types-NWGai6aQ.js";import"./useCurrencyInfo-Bxa3J04d.js";import"./createEthersProvider-B5AW2bpJ.js";import"./reducer-1kwGyyVS.js";import"./actions-Budqlwp-.js";import"./slice-DoLbOto3.js";import"./slice-Crjw990S.js";import"./slice-CI92BTuM.js";import"./slice-CaJcHsUP.js";import"./usePrevious-CggM0Zir.js";import"./hooks-Muz170pO.js";import{useChainIdFromUrlParam as xr}from"./chainParams-DIOvplzi.js";import"./useContract-CKZ4cOLX.js";import"./UniswapInterfaceMulticall-DLE8QJ-2.js";import"./TokenLogo-JlSSDr3Q.js";import"./types-DhBONJgE.js";import"./use-transport-CPomNX05.js";import"./Tokens-HEKZ8edJ.js";import"./types-OmNOta2_.js";import"./useMultichainContext-BVmgxqO2.js";import"./UnitagsApiClient-CvShPRCK.js";import"./Identicon-SnsLMqUD.js";import"./api-u3dxy1Uz.js";import"./showSwitchNetworkNotification-C9hFtpTD.js";import"./useIsWindowVisible-CtuFA8fK.js";import"./useBlockNumber-BeCJLIMW.js";import"./mitt-Cj0YfnqU.js";import"./ErrorBoundary-oYzyK_hY.js";import"./useIsMobile-Cq3RSgOi.js";import"./styled-components-DbVO3u5J.js";import"./text-CK4eXdYc.js";import"./index.esm-D6PJCa7X.js";import"./CopyHelper-DOhhKKQB.js";import"./copy-bNdbH7uS.js";import"./prop-types-BL9JsGr9.js";import{chevron_right_default as ct}from"./chevron-right-fNEOKcTd.js";import{ClickableTamaguiStyle as _r}from"./clickable-D5qUCIhr.js";import"./ellipsis-DjwAKJIh.js";import"./Links-Xomrvpth.js";import"./Column-ekA0cfjc.js";import"./useIsPage-CCVcHkKr.js";import"./testIDs-CxYpwoP6.js";import"./useCommonTokensOptionsWithFallback-7qZUIHia.js";import{Trace_default as gr}from"./Trace-DgHN3Ak9.js";import{Modal as vr}from"./Modal.web-DHbL39pN.js";import"./WarningModal-f8Gfhd_G.js";import"./InfoTooltip.web-CkgGEmd3.js";import"./assets-D-uPpcBZ.js";import"./LearnMoreLink-CrJtGK7U.js";import"./react-virtualized-auto-sizer.esm-5JBVmqYi.js";import{MultichainContextProvider as fr}from"./MultichainContext-CEAgN3e0.js";import"./useGetPasskeyAuthStatus-QVLoUPch.js";import"./types-Ds0gKmju.js";import"./dismissNativeKeyboard.web-99F1bxCR.js";import"./TextInput-3sqL_9ZJ.js";import"./useDynamicFontSizing-DOxjEhTh.js";import"./pools-5GjP-hMy.js";import"./ContextMenuV2.web-DtsTwCPj.js";import"./useBooleanState-QNOWYlXb.js";import"./service-ExploreStatsService_connectquery-YoP81iJ5.js";import"./useDeviceDimensions-iftoqxuy.js";import"./types-Ctc23WnH.js";import"./styles-nntGSkOP.js";import"./Row-D0lmZ56K.js";import"./Badge-vnMif72r.js";import"./bundle.esm-B4P3X753.js";import"./api-PoolsService_connectquery-N1pfS4Yc.js";import"./currencyKey-B-LQIyOE.js";import"./EnvelopeHeart-DxsgNuRq.js";import"./GetHelpHeader-DB6Sgdgo.js";import"./Dialog-DZrFRjU_.js";import"./tryParseCurrencyAmount-Bt3FPZDG.js";import"./PortfolioLogo-C-reBpb6.js";import"./CurrencyLogo-CvvmRzOI.js";import"./DoubleLogo-D40dQ2P7.js";import{LoadingRows as yr}from"./styled-qLLlrMEu.js";import"./NumericalInput-wkthWxek.js";import"./CurrencySearchModal-CHoQ3krb.js";import"./shared-EXoQIK7V.js";import"./useOnClickOutside-B5O2_6zc.js";import"./Tooltip-DPNhKWF2.js";import"./useInterval-7f86mkEJ.js";import"./polished.es-BASfrnSv.js";import"./useHoverProps-BdQsOXMz.js";import"./DetailLineItem-d-0mcMrN.js";import"./AdaptiveDropdown-Cv1C9ooR.js";import"./util-CfowgtYu.js";import{getCurrencyForProtocol as V,getTokenOrZeroAddress as ut}from"./currency-Brc-ymXr.js";import"./protocolVersion-Djp_Gxjw.js";import"./networkSupportsV4-CXcYAtrx.js";import"./usePools-Bz9FGvMj.js";import"./getTickToPrice-BudeFeQp.js";import{isInvalidPrice as hr,isInvalidRange as kr}from"./priceRangeInfo-DbHE3vOq.js";import"./LPIncentiveFeeStatTooltip-CknsSvzz.js";import"./useLpIncentivesFormattedEarnings-Cp8RbAci.js";import{DEFAULT_POSITION_STATE as Tr,PositionFlowStep as M}from"./feeTiers-D9BvLkmt.js";import"./LiquidityPositionInfoBadges-DdjNrqYk.js";import{parseRestPosition as Sr}from"./parseFromRest-Dp36Fdyo.js";import{BreadcrumbNavContainer as Pr,BreadcrumbNavLink as dt}from"./BreadcrumbNav-lC3fgSsx.js";import"./DropdownSelector-CYN_6AdC.js";import{LPTransactionSettingsStoreContextProvider as Ar,useCheckLpApprovalQuery as Cr,useLPSlippageValue as br}from"./LPTransactionSettingsStoreContextProvider-DlM9rbYL.js";import"./useV2Pairs-CQkQtDF2.js";import"./hasLPFoTTransferError-Co-P2mPd.js";import"./LoadingState-4OstYjDu.js";import"./utils-s6RXdTyR.js";import"./BaseQuoteFiatAmount-B6onp17b.js";import"./dist-BxQUC-sk.js";import"./useSwapTaxes-CDZk7xg5.js";import"./hooks-BCKOZK7U.js";import"./hooks-SFdPlDvR.js";import"./useNetworkSupportsV2-BFYJkGkx.js";import"./PercentInput-R6KfjzCN.js";import{LiquidityModalHeader as jr,TokenInfo as lt}from"./TokenInfo-B8OkTNxp.js";import{unwrappedToken as Er}from"./unwrappedToken-BclHT9I4.js";import{useGetPositionQuery as Rr}from"./getPosition-BPf_Aea4.js";function wr({params:i,...r}){const n=[Ct.TradingApi,Bt.tradingApiPaths.migrate,i];return Vt({queryKey:n,queryFn:async()=>{if(!i)throw{name:"Params are required"};return await Ut(i)},...r})}wt();var p=_t(kt()),t=_t(Et());const ft=(0,p.createContext)(void 0);function Lr(){const i=(0,p.useContext)(ft);if(!i)throw new Error("useMigrateV3TxContext must be used within a MigrateV3PositionTxContextProvider");return i}function qr({children:i,positionInfo:r}){var n,u;const _=Q(),[C,h]=(0,p.useState)(!1),{creatingPoolOrPair:c,protocolVersion:k,positionState:T,currentTransactionStep:d,poolOrPair:m,ticks:g,price:S}=vt(),v=(n=(u=Rt()).getCanSignPermits)===null||n===void 0?void 0:n.call(u,r.chainId),f=(0,p.useMemo)(()=>{if(_.address)return{simulateTransaction:!0,walletAddress:_.address,chainId:r.currency0Amount.currency.chainId,protocol:z.V3,positionToken:r.tokenId,generatePermitAsTransaction:v}},[r,_.address,v]),{data:o,isLoading:P,error:l,refetch:U}=Cr({params:f,headers:{"x-universal-router-version":Ot._2_0},staleTime:5*it,enabled:!!f});if(l){const e=at(l,{defaultTitle:"unknown CheckLpApprovalQuery"});Z.error(e,{tags:{file:"MigrateV3LiquidityTxContext",function:"useEffect"}})}const{permitData:G,positionTokenPermitTransaction:B}=o??{},y=!P&&!!(G||B),b=(0,p.useMemo)(()=>{var e;if(!r.tokenId||!_.address||k!==s.V4||!r.poolOrPair||!r.liquidity)return;const a=m;if(!a)return;const R=g[0],A=g[1];if(!(R===void 0||A===void 0||!r.liquidity))return{simulateTransaction:!y,inputProtocol:z.V3,tokenId:Number(r.tokenId),inputPosition:{pool:{token0:r.currency0Amount.currency.isNative?Y:r.currency0Amount.currency.address,token1:r.currency1Amount.currency.isNative?Y:r.currency1Amount.currency.address,fee:(e=r.feeTier)===null||e===void 0?void 0:e.feeAmount,tickSpacing:r.tickSpacing?Number(r.tickSpacing):void 0},tickLower:r.tickLower!==void 0?r.tickLower:void 0,tickUpper:r.tickUpper!==void 0?r.tickUpper:void 0},inputPoolLiquidity:r.poolOrPair.liquidity.toString(),inputCurrentTick:r.poolOrPair.tickCurrent,inputSqrtRatioX96:r.poolOrPair.sqrtRatioX96.toString(),inputPositionLiquidity:r.liquidity,outputProtocol:z.V4,outputPosition:{pool:{token0:ut(a.currency0),token1:ut(a.currency1),fee:T.fee.feeAmount,hooks:T.hook,tickSpacing:a.tickSpacing},tickLower:R??void 0,tickUpper:A??void 0},outputPoolLiquidity:c?void 0:a.liquidity.toString(),outputSqrtRatioX96:c?void 0:a.sqrtRatioX96.toString(),outputCurrentTick:c?void 0:a.tickCurrent,initialPrice:c?a.sqrtRatioX96.toString():void 0,chainId:r.currency0Amount.currency.chainId,walletAddress:_.address,expectedTokenOwed0RawAmount:r.token0UncollectedFees??"0",expectedTokenOwed1RawAmount:r.token1UncollectedFees??"0",amount0:r.currency0Amount.quotient.toString(),amount1:r.currency1Amount.quotient.toString()}},[k,c,r,_,m,g,T.fee.feeAmount,T.hook,y]),w=hr(S),N=kr(g[0],g[1]),F=k!==s.V2&&!w&&!N,$=!((d==null?void 0:d.step.type)===et.MigratePositionTransaction||(d==null?void 0:d.step.type)===et.MigratePositionTransactionAsync)&&!P&&!l&&!!b&&F,{data:j,error:E,refetch:D}=wr({params:b,refetchInterval:C?!1:5*it,retry:!1,enabled:$});if((0,p.useEffect)(()=>{h(gt({calldataError:E,approvalError:l}))},[E,l]),E){const e=at(E,{defaultTitle:"unknown MigrateLpPositionCalldataQuery"});Z.error(e,{tags:{file:"MigrateV3LiquidityTxContext",function:"useEffect"}}),Dt(Lt.MigrateLiquidityFailed,{message:e})}const q=(0,p.useMemo)(()=>{if(!j)return;const e=Qt(o==null?void 0:o.permitData);if(o!=null&&o.permitData&&!e)return;const a=mt(o==null?void 0:o.positionTokenPermitTransaction);if(o!=null&&o.positionTokenPermitTransaction&&!a)return;const R=mt(j.migrate);if(!R)return;const A=J.fromRawAmount(V(r.currency0Amount.currency,s.V4),r.currency0Amount.quotient),O=J.fromRawAmount(V(r.currency1Amount.currency,s.V4),r.currency1Amount.quotient);return{type:nt.Migrate,unsigned:!!(o!=null&&o.permitData),migratePositionRequestArgs:b,approveToken0Request:void 0,approveToken1Request:void 0,permit:e?{method:lr.TypedData,typedData:e}:void 0,protocolVersion:s.V3,approvePositionTokenRequest:void 0,revokeToken0Request:void 0,revokeToken1Request:void 0,token0PermitTransaction:void 0,token1PermitTransaction:void 0,positionTokenPermitTransaction:a,txRequest:R,action:{type:nt.Migrate,currency0Amount:A,currency1Amount:O}}},[j,b,o,r.currency0Amount,r.currency1Amount]);return(0,t.jsx)(ft.Provider,{value:{txInfo:q,transactionError:C,setTransactionError:h,refetch:l?U:C?D:void 0},children:i})}function Mr(i){return(0,p.useMemo)(()=>{if(!i||i.status!==Ft.OUT_OF_RANGE||i.version!==s.V3||!i.poolOrPair)return;const r=Number(i.tickLower),n=Number(i.tickUpper),u=Er(i.poolOrPair.token1).isNative;return{tickLower:u?-n:r,tickUpper:u?-r:n,isOutOfRange:!0}},[i])}const Vr="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap1573 _pr-t-space-pad1331704925 _pl-t-space-pad1331704925 _mt-t-space-spa94665593 _mb-t-space-spa94665593 ",Nr="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _pr-t-space-spa94665593 _pl-t-space-spa94665593 _pt-t-space-spa1360334080 _pb-t-space-spa94665593 _gap-t-space-spa1360334047 ",Dr="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _mb-t-space-spa1360334051 ",Or="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-1 _flexDirection-column _backgroundColor-surface2 _borderTopLeftRadius-t-radius-ro291586453 _borderTopRightRadius-t-radius-ro291586453 _borderBottomRightRadius-t-radius-ro291586453 _borderBottomLeftRadius-t-radius-ro291586453 _pt-t-space-pad1331704929 _pr-t-space-pad1331704929 _pb-t-space-pad1331704929 _pl-t-space-pad1331704929 ",Ur="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _justifyContent-center _alignItems-center ",Br="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap1573 _maxWidth-calcmin580p890974940 ",Fr="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _gap-32px _width-10037 ",$r="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _justifyContent-space-betwe3241 _alignItems-center _gap-t-space-gap1598 _width-10037 ",Ir="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _mt-t-space-spa1360333981 _gap-t-space-gap1635 ",Wr=Gt(Zt,{backgroundColor:"$surface1",display:"flex",flexDirection:"row",gap:60,mt:"1rem",mx:"auto",width:"100%",zIndex:"$default",p:24});function zr({initialPosition:i,positionInfo:r,currencyInputs:n,setCurrencyInputs:u}){const{chainName:_,tokenId:C}=K(),h=It(),{t:c}=Pt(),{positionState:k,setPositionState:T,setStep:d,setPriceRangeState:m,setDepositState:g,step:S,currentTransactionStep:v,setCurrentTransactionStep:f}=vt(),{protocolVersion:o}=k,[P,l]=(0,p.useState)([]),U=dr(),B=Q().chainId,y=$t().evmAccount,b=At(),{txInfo:w,transactionError:N,refetch:F,setTransactionError:L}=Lr(),$=Xt(),j=jt(),[E,D]=(0,p.useState)(!1),q=(0,p.useCallback)(()=>{D(!1),L(!1)},[D,L]),{currency0Amount:e,currency1Amount:a,owner:R}=r,A=ot(e),O=ot(a);Nt(y==null?void 0:y.address,R)||j("/positions");const yt=(0,p.useCallback)(()=>{var I;L(!1);const ht=Ht(w);!y||!zt(y)||!ht||b(Kt.actions.trigger({selectChain:U,startChainId:B,account:y,liquidityTxContext:w,setCurrentStep:f,setSteps:l,onSuccess:()=>{q(),j("/positions")},onFailure:X=>{X&&L(gt({calldataError:X})),f(void 0)},analytics:{...Wt({trace:h,fee:(I=r.feeTier)===null||I===void 0?void 0:I.feeAmount,tickSpacing:r.tickSpacing,tickLower:r.tickLower,tickUpper:r.tickUpper,hook:void 0,currency0:e.currency,currency1:a.currency,currency0AmountUsd:A,currency1AmountUsd:O,poolId:r.poolId,version:s.V3}),action:"V3->V4"}}))},[y,b,U,B,w,h,r,A,O,q,j,f,l,L,e.currency,a.currency]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Ir,children:[(0,t.jsxs)(Pr,{"aria-label":"breadcrumb-nav",children:[(0,t.jsxs)(dt,{to:"/positions",children:[(0,t.jsx)(W,{i18nKey:"pool.positions.title"})," ",(0,t.jsx)(ct,{size:14})]}),(0,t.jsxs)(dt,{to:`/positions/v3/${_}/${C}`,children:[e.currency.symbol," / ",a.currency.symbol," ",(0,t.jsx)(ct,{size:14})]})]}),(0,t.jsxs)("div",{className:$r,children:[(0,t.jsx)(H,{width:"100%",variant:"heading2",children:(0,t.jsx)(W,{i18nKey:"common.migrate.position"})}),(0,t.jsxs)(st,{row:!0,backgroundColor:"$surface2",borderRadius:"$rounded12",alignItems:"center",justifyContent:"center",gap:"$gap4",py:"$padding8",px:"$padding12",..._r,onPress:()=>{T({...Tr,initialPosition:i,protocolVersion:o}),u({tokenA:V(e.currency,o),tokenB:V(a.currency,o)}),m(er),g(or),d(M.SELECT_TOKENS_AND_FEE_TIER)},children:[(0,t.jsx)(ur,{color:"$neutral1",size:16}),(0,t.jsx)(H,{variant:"buttonLabel4",color:"$neutral2",children:(0,t.jsx)(W,{i18nKey:"common.button.reset"})})]})]}),(0,t.jsxs)("div",{className:Fr,children:[!$.xl&&(0,t.jsx)(st,{width:360,alignSelf:"flex-start","$platform-web":{position:"sticky",top:St+25},children:(0,t.jsx)(sr,{steps:[{label:c("migrate.selectFeeTier"),active:S===M.SELECT_TOKENS_AND_FEE_TIER},{label:c("migrate.setRange"),active:S===M.PRICE_RANGE}]})}),(0,t.jsxs)("div",{className:Br,children:[(0,t.jsx)(tr,{liquidityPosition:r,disabled:!0}),(0,t.jsx)("div",{className:Ur,children:(0,t.jsx)("div",{className:Or,children:(0,t.jsx)(Yt,{size:20,color:"$neutral1"})})}),S===M.SELECT_TOKENS_AND_FEE_TIER?(0,t.jsx)(nr,{width:"100%",maxWidth:"unset",tokensLocked:!0,currencyInputs:n,setCurrencyInputs:u,onContinue:()=>{d(M.PRICE_RANGE)}}):(0,t.jsx)(mr,{width:"100%",maxWidth:"unset"}),S===M.PRICE_RANGE&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(rr,{width:"100%",maxWidth:"unset",children:(0,t.jsx)(pr,{positionInfo:r,onDisableContinue:!w||!!N,onContinue:()=>D(!0)})}),!E&&(0,t.jsx)("div",{className:Dr,children:(0,t.jsx)(pt,{errorMessage:N,onPress:F})})]})]})]})]}),(0,t.jsx)(vr,{name:qt.MigrateLiquidity,onClose:q,isDismissible:!0,isModalOpen:E,padding:"$none",children:(0,t.jsxs)("div",{className:Nr,children:[(0,t.jsx)(jr,{title:c("pool.migrateLiquidity"),closeModal:q}),(0,t.jsxs)("div",{className:Vr,children:[(0,t.jsx)(lt,{currencyAmount:e,currencyUSDAmount:A,isMigrating:!0}),(0,t.jsx)(H,{variant:"body3",color:"$neutral2",children:c("common.and")}),(0,t.jsx)(lt,{currencyAmount:a,currencyUSDAmount:O,isMigrating:!0})]}),(0,t.jsx)(pt,{errorMessage:N}),v&&P.length>1?(0,t.jsx)(Jt,{steps:P,currentStep:v}):(0,t.jsx)(Tt,{size:"large",variant:"branded",fill:!1,onPress:yt,loading:!!v,children:c(v?"common.confirmWallet":"common.migrate")})]})})]})}function xt(i){var r,n;return(i==null?void 0:i.version)!==s.V3?{tokenA:void 0,tokenB:void 0}:{tokenA:V((r=i.poolOrPair)===null||r===void 0?void 0:r.token0,s.V4),tokenB:V((n=i.poolOrPair)===null||n===void 0?void 0:n.token1,s.V4)}}function Km(){const{tokenId:i}=K(),{pairAddress:r}=K(),n=xr(),u=Q(),_=br({version:s.V3}),{pathname:C}=bt(),h=C.includes("v2")?s.V2:s.V3,c=ar(),{data:k,isLoading:T}=Rr(u.address?{owner:u.address,protocolVersion:h,tokenId:h===s.V3?i:void 0,pairAddress:h===s.V2?r:void 0,chainId:n??u.chainId}:void 0),d=k==null?void 0:k.position,m=(0,p.useMemo)(()=>Sr(d),[d]),g=Mr(m),S=(0,p.useMemo)(()=>xt(m),[m]),[v,f]=(0,p.useState)(S);if((0,p.useEffect)(()=>{f(xt(m))},[m]),T||!d||!m||m.version!==s.V3)return(0,t.jsx)(Wr,{children:(0,t.jsxs)(yr,{children:[(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{}),(0,t.jsx)(x,{})]})});const{currency0Amount:o,currency1Amount:P,feeTier:l}=m;return(0,t.jsx)(gr,{logImpression:!0,page:Mt.MigrateV3,properties:{pool_address:m.poolId,chain_id:n??u.chainId,label:[o.currency.symbol,P.currency.symbol].join("/"),fee_tier:l,token0Address:rt(tt(o.currency)),token1Address:rt(tt(P.currency))},children:(0,t.jsx)(fr,{initialChainId:n,children:(0,t.jsx)(Ar,{autoSlippageTolerance:_,children:(0,t.jsxs)(ir,{initialPositionState:{initialPosition:g},currencyInputs:v,setCurrencyInputs:f,initialFlowStep:c.flowStep,children:[(0,t.jsx)(qr,{positionInfo:m,children:(0,t.jsx)(zr,{initialPosition:g,positionInfo:m,currencyInputs:v,setCurrencyInputs:f})}),(0,t.jsx)(cr,{})]})})})})}export{Km as default};
