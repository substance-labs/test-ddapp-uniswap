import{__toESM as Y}from"./chunk-DgAfPHQg.js";import"./preload-helper-CaakwtpC.js";import"./i18next-DD3sT7R5.js";import{require_react as lo}from"./react-CNoFhWkx.js";import{Button as uo,Switch as vo,Trans as fo}from"./src-DOOtfpHS.js";import{useTranslation as _o}from"./useTranslation-BotBuoJf.js";import"./index.web-BqgtOHN3.js";import"./constants-CrXoXfFH.js";import"./es-Iwj7vF3u.js";import"./react-dom-xovCOntK.js";import"./react-is-BJXMVkew.js";import{ReactQueryCacheKey as xo}from"./cache-BFZkIToX.js";import"./dist-Q7olfaoJ.js";import"./tslib.es6-Dbpxy1u8.js";import"./dist-QCpUvRkJ.js";import"./chunk-QMGIS6GS-B91ZVkXt.js";import{require_jsx_runtime as yo}from"./jsx-runtime-D7bMTQeG.js";import"./useEnabledChains-DuB86c95.js";import{logger as ho}from"./hooks-BXO4d1DJ.js";import"./dist-ceZDlR1V.js";import"./analytics.web-DLc1_wTk.js";import"./redux-toolkit.esm-BnRUBto_.js";import"./utils-CK6a47NA.js";import{CurrencyAmount as q,PollingInterval as z,ZERO_ADDRESS as E,init_sdk_core_esm as go}from"./utils-BX1Fu73x.js";import"./bn-D7somgUb.js";import"./lib-DPFIyRke.js";import"./misc-BMnlqqV4.js";import{currencyId as W}from"./currencyId-Ci6selsx.js";import"./config-C4KrHqHG.js";import"./time-D_OqcZ4M.js";import"./features-yACC1hVw.js";import{InterfaceEventName as bo}from"./interface-BdpC4qOF.js";import"./element-Wnp4RkdY.js";import{ModalName as H}from"./modal-Dvm06CN4.js";import"./isAddress-P2vaZgmG.js";import"./chain-ghiO403o.js";import"./slice-cfC6NcyN.js";import"./node-C_BraYgX.js";import"./formatUnits-DkyMpOD7.js";import"./_u64-b_viZRi_.js";import"./sha2-Jt0E41S_.js";import"./sha256-BqbhXHGu.js";import"./call-CTDbaN-t.js";import"./parseAccount-CRyN5swV.js";import"./encodeFunctionData-CD63gkvM.js";import"./public-fap09Zv6.js";import"./stringify-B82RFruy.js";import"./rpc-nQR4Ijs4.js";import"./dist-CBK-d0jO.js";import"./hmac-D-QTodfL.js";import"./lib-CKG8APVv.js";import"./lib-XGdDYWzD.js";import"./V3DutchOrderTrade-Cl7yELmp.js";import"./v3-sdk.esm-CHH6GWR1.js";import"./hash-05APZTFm.js";import"./inherits_browser-Dqx8HagI.js";import{useQuery as ko}from"./useQuery-D_ZCw8XG.js";import"./lib-CWHZrl0T.js";import"./v2-sdk.esm-CIiDMO7F.js";import"./lib-BncBk3QF.js";import"./utils-7WDx1QGa.js";import"./lib-CgeiDO5B.js";import"./lib-Dj-AwQVD.js";import"./types-DbOmsKtk.js";import"./getCurrencyAmount-vvZpAzIm.js";import"./addresses-D56PBUHX.js";import"./currency-DIOEzjz2.js";import"./ms-BqmEYo6j.js";import"./configs-B4dDdw82.js";import"./hooks-Bp0VtWbX.js";import"./statsig-B7I9iQRf.js";import"./usePollingIntervalByChain-YBOfXXzb.js";import"./erc20-CdGGKIp0.js";import{nativeOnChain as So}from"./objects-DlLkJwrJ.js";import{sendAnalyticsEvent as Co}from"./send.web-CrSXW2rw.js";import{claimLpFees as Ao}from"./TradingApiClient-Cp_0ez5S.js";import"./ProtocolItems-DhZWSiXS.js";import"./selectors-BwkayGDl.js";import{useUSDCValue as V}from"./useUSDCPrice-HO7Wgroz.js";import"./balances-DV0Wvmri.js";import"./getCurrencySafetyInfo-BHD1ohD-.js";import"./mutation-CRQvRc5_.js";import"./infiniteQueryBehavior-C10I_UVS.js";import"./connector-Cw8HJLtm.js";import"./queryOptions-P48mrm5X.js";import"./connect-transport-9OnIgPz5.js";import"./proto3-DkSQZto4.js";import"./embeddedWallet-BdHUTaHg.js";import"./promise-client-BYLTs0DC.js";import{uniswapUrls as oo}from"./urls-kwiZbYPW.js";import"./createApiClient-BjXZMbEB.js";import"./constants-D9cStT7K.js";import"./base-DVpWJ4NW.js";import{ProtocolVersion as j}from"./types_pb-yZxlo4b1.js";import"./hooks-Dhx5teK4.js";import"./transactionDetails-BsNW_jus.js";import{NumberType as $}from"./types-JuyYLR0O.js";import{useLocalizationContext as wo}from"./LocalizationContext-B31peW1_.js";import"./getAlertColor-J5DrJWHv.js";import"./currency-xm5i4cH7.js";import"./ethers-D2SIY1xg.js";import"./useSupportedChainId-DskHoisQ.js";import{useWallet as jo}from"./useWallet-CL5owP9P.js";import{useTrace as Io}from"./TraceContext-Ddfk7zjz.js";import"./types-7DAoWLTI.js";import{getLPBaseAnalyticsProperties as To}from"./analytics-UE3_EENu.js";import"./types-BSmAADNJ.js";import"./eventemitter3-DFes51ku.js";import"./eventemitter3-BHLpX1jX.js";import"./dist-BWRHWQ_J.js";import"./readContract-Cae4hIjn.js";import"./recoverAddress-oPdWABRo.js";import"./getBalance-TsPVbzB5.js";import"./localBatchGatewayRequest-CdT4Kija.js";import"./createBatchScheduler-BJBpfhFD.js";import"./createTransport-WEDNYdh5.js";import"./useEthersProvider-CBgc_azi.js";import"./http-CIklBnX8.js";import"./wagmiConfig-0BYSDqyO.js";import"./hashMessage-DdzTBpWL.js";import"./multicall-BYS6jvE9.js";import"./secp256k1-fbKD5lyl.js";import"./getAction-BBhbL9mE.js";import{useAccount as Uo}from"./useAccount-C5hwiBwN.js";import"./config-CDfnfyHL.js";import"./useSwitchChain-CY8eYAUF.js";import"./query-qNZtVuxH.js";import"./constants-CGJJmXwV.js";import"./utils-CDaPKk14.js";import"./zIndex-CmEE31Ab.js";import"./passkey.web-DakcatU3.js";import"./hex-njd-4N-2.js";import"./slice-qANrfSbi.js";import"./noop-BDbB2pLB.js";import"./walletMeta-DaLhfhet.js";import"./signing-DH5GfhKu.js";import"./i18n-CroUvoJw.js";import"./v4-D6Rlvprs.js";import"./errors-BaezSPLl.js";import"./swapErrorToUserReadableMessage-DgHZMHU-.js";import{LiquidityTransactionType as O,getErrorMessageToDisplay as Fo,isSignerMnemonicAccountDetails as Lo,isValidLiquidityTxContext as No,liquiditySaga as Ro,parseErrorMessageTitle as Po,validateTransactionRequest as Bo}from"./AccountDetails-pkaz6EG4.js";import{Text as d,concatClassName as Do,iconSizes as Q}from"./Loader-D83W8G1W.js";import"./client-BlU1ozBP.js";import"./urls-aCnKF23w.js";import"./encode-utf8-DiSL6KQ9.js";import"./dijkstra-6umg7ymP.js";import"./UniconSVGs-CVEtuhJW.js";import"./AlertTriangleFilled-C9tf2eUJ.js";import{Passkey as Mo}from"./Passkey-Bey7xD4Z.js";import{ErrorCallout as qo}from"./ErrorCallout-YxcfJphA.js";import"./reducer-CcXO4HTO.js";import{useSelectChain as zo}from"./useSelectChain-CA5zoRWi.js";import"./timing-DsWr56iv.js";import"./experiments-rc6XUB0U.js";import"./types-NWGai6aQ.js";import{useCurrencyInfo as K}from"./useCurrencyInfo-Bxa3J04d.js";import"./createEthersProvider-B5AW2bpJ.js";import"./reducer-1kwGyyVS.js";import{useAppDispatch as Eo,useAppSelector as Wo}from"./hooks-Muz170pO.js";import{CurrencyLogo as G}from"./TokenLogo-JlSSDr3Q.js";import{useModalState as Ho}from"./useModalState-BcPI2EiQ.js";import"./styled-components-DbVO3u5J.js";import"./clickable-D5qUCIhr.js";import{TestID as Vo}from"./testIDs-CxYpwoP6.js";import"./Trace-DgHN3Ak9.js";import{Modal as $o}from"./Modal.web-DHbL39pN.js";import{useGetPasskeyAuthStatus as Oo}from"./useGetPasskeyAuthStatus-QVLoUPch.js";import"./EnvelopeHeart-DxsgNuRq.js";import{GetHelpHeader as Qo}from"./GetHelpHeader-DB6Sgdgo.js";import{canUnwrapCurrency as Z,getCurrencyWithOptionalUnwrap as J}from"./currency-Brc-ymXr.js";import{getProtocolItems as Ko}from"./protocolVersion-Djp_Gxjw.js";function Go({params:s,...l}){const n=[xo.TradingApi,oo.tradingApiPaths.claimLpFees,s];return ko({queryKey:n,queryFn:async()=>{if(!s)throw{name:"Params are required"};return await Ao(s)},...l})}go();var h=Y(lo()),i=Y(yo());const Zo="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row ",g="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _gap-t-space-gap56 _alignItems-center ",X="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _alignItems-center _justifyContent-space-betwe3241 ",Jo="  _borderBottomLeftRadius-t-radius-ro291586453 _borderBottomRightRadius-t-radius-ro291586453",Xo=" _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _backgroundColor-surface2 _borderTopLeftRadius-t-radius-ro291586453 _borderTopRightRadius-t-radius-ro291586453 _pt-t-space-pad1331704925 _pr-t-space-pad1331704925 _pb-t-space-pad1331704925 _pl-t-space-pad1331704925 _gap-t-space-gap1569  ",Yo="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap52 ",oi="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap1573 ",ii="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _backgroundColor-surface2 _borderBottomLeftRadius-t-radius-ro291586453 _borderBottomRightRadius-t-radius-ro291586453 _justifyContent-space-betwe3241 _alignItems-center _pt-t-space-pad95589114 _pb-t-space-pad95589114 _pr-t-space-pad1331704925 _pl-t-space-pad1331704925 ";function ri({unwrapNativeCurrency:s,setUnwrapNativeCurrency:l,chainId:n}){const u=n?So(n):void 0;return(0,i.jsxs)("div",{className:ii,children:[(0,i.jsx)(d,{variant:"body3",color:"$neutral2",children:(0,i.jsx)(fo,{i18nKey:"pool.collectAs",values:{nativeWrappedSymbol:u==null?void 0:u.symbol}})}),(0,i.jsx)(vo,{id:"collect-as-weth",checked:s,onCheckedChange:()=>l(f=>!f),variant:"default"})]})}function de(){var s,l;const{t:n}=_o(),u=Io(),{formatCurrencyAmount:f,convertFiatAmountFormatted:I}=wo(),o=(s=Wo(r=>r.application.openModal))===null||s===void 0?void 0:s.initialState,c=jo().evmAccount,[b,T]=(0,h.useState)(),[v,io]=(0,h.useState)(!0),{currency0Amount:k,currency1Amount:S,chainId:U}=o||{},F=Z(k==null?void 0:k.currency,o==null?void 0:o.version),L=Z(S==null?void 0:S.currency,o==null?void 0:o.version),N=o&&U&&(F||L),{closeModal:C}=Ho(H.ClaimFee),{fee0Amount:t,fee1Amount:e,token0UncollectedFees:R,token1UncollectedFees:P}=o??{},A=V(t,z.Slow),w=V(e,z.Slow),m=J({currency:t==null?void 0:t.currency,shouldUnwrap:v&&F}),p=J({currency:e==null?void 0:e.currency,shouldUnwrap:v&&L}),_=K(W(m)),x=K(W(p)),ro=Eo(),to=zo(),B=Uo(),eo=B.chainId,{isSignedInWithPasskey:no,isSessionAuthenticated:so,needsPasskeySignin:co}=Oo((l=B.connector)===null||l===void 0?void 0:l.id),D=(0,h.useMemo)(()=>{var r;if(!(!o||!m||!p))return{simulateTransaction:!0,protocol:Ko(o.version),tokenId:o.tokenId?Number(o.tokenId):void 0,walletAddress:c==null?void 0:c.address,chainId:o.currency0Amount.currency.chainId,position:{pool:{token0:m.isNative?E:m.address,token1:p.isNative?E:p.address,fee:(r=o.feeTier)===null||r===void 0?void 0:r.feeAmount,tickSpacing:o.tickSpacing?Number(o.tickSpacing):void 0,hooks:o.v4hook},tickLower:o.tickLower!==void 0?o.tickLower:void 0,tickUpper:o.tickUpper!==void 0?o.tickUpper:void 0},expectedTokenOwed0RawAmount:o.version!==j.V4?R:void 0,expectedTokenOwed1RawAmount:o.version!==j.V4?P:void 0,collectAsWETH:o.version!==j.V4?!v:void 0}},[c==null?void 0:c.address,m,p,o,R,P,v]),{data:a,isLoading:ao,error:y,refetch:mo}=Go({params:D,enabled:!!D});if(y&&Object.keys(y).length>0){const r=Po(y,{defaultTitle:"unknown ClaimLPFeesCalldataQuery"});ho.error(r,{tags:{file:"ClaimFeeModal",function:"useEffect"}}),Co(bo.CollectLiquidityFailed,{message:r})}const M=(0,h.useMemo)(()=>{const r=Bo(a==null?void 0:a.claim);if(!(!o||!r))return{type:O.Collect,protocolVersion:o.version,action:{type:O.Collect,currency0Amount:t||q.fromRawAmount(o.currency0Amount.currency,0),currency1Amount:e||q.fromRawAmount(o.currency1Amount.currency,0)},txRequest:r}},[a==null?void 0:a.claim,t,e,o]),po=async()=>{const r=No(M);!c||!Lo(c)||!r||ro(Ro.actions.trigger({selectChain:to,startChainId:eo,account:c,liquidityTxContext:M,setCurrentStep:T,setSteps:()=>{},onSuccess:()=>{C()},onFailure:()=>{T(void 0)},analytics:o&&(t!=null&&t.currency)&&(e!=null&&e.currency)?{...To({trace:u,tickSpacing:o.tickSpacing,tickLower:o.tickLower,tickUpper:o.tickUpper,hook:o.v4hook,poolId:o.poolId,currency0:(_==null?void 0:_.currency)??t.currency,currency1:(x==null?void 0:x.currency)??e.currency,currency0AmountUsd:A,currency1AmountUsd:w,version:o.version})}:void 0}))};return(0,i.jsx)($o,{name:H.ClaimFee,onClose:C,isDismissible:!0,children:(0,i.jsxs)("div",{className:oi,children:[(0,i.jsx)(Qo,{link:oo.helpRequestUrl,title:n("pool.collectFees"),closeModal:C,closeDataTestId:"ClaimFeeModal-close-icon"}),t&&e&&(0,i.jsxs)("div",{className:Yo,children:[(0,i.jsxs)("div",{className:Do(""+(Xo+(N?" ":Jo))),children:[(0,i.jsxs)("div",{className:X,children:[(0,i.jsxs)("div",{className:g,children:[(0,i.jsx)(G,{currencyInfo:_,size:Q.icon24}),(0,i.jsx)(d,{variant:"body1",color:"neutral1",children:m==null?void 0:m.symbol})]}),(0,i.jsxs)("div",{className:g,children:[(0,i.jsx)(d,{variant:"body1",color:"$neutral1",children:f({value:t})}),A&&(0,i.jsxs)(d,{variant:"body1",color:"$neutral2",children:["(",I(A.toExact(),$.FiatTokenPrice),")"]})]})]}),(0,i.jsxs)("div",{className:X,children:[(0,i.jsxs)("div",{className:g,children:[(0,i.jsx)(G,{currencyInfo:x,size:Q.icon24}),(0,i.jsx)(d,{variant:"body1",color:"neutral1",children:p==null?void 0:p.symbol})]}),(0,i.jsxs)("div",{className:g,children:[(0,i.jsx)(d,{variant:"body1",color:"$neutral1",children:f({value:e})}),w&&(0,i.jsxs)(d,{variant:"body1",color:"$neutral2",children:["(",I(w.toExact(),$.FiatTokenPrice),")"]})]})]})]}),N&&(0,i.jsx)(ri,{unwrapNativeCurrency:v,setUnwrapNativeCurrency:io,chainId:U})]}),(0,i.jsx)(qo,{errorMessage:Fo({calldataError:y}),onPress:mo}),(0,i.jsx)("div",{className:Zo,children:(0,i.jsx)(uo,{"data-testid":Vo.ClaimFees,isDisabled:!(a!=null&&a.claim)||!!b,loading:ao||!!b,size:"large",variant:"branded",onPress:po,icon:co?(0,i.jsx)(Mo,{size:"$icon.24"}):void 0,children:n(b?no?"swap.button.submitting.passkey":"common.confirmWallet":so?"common.confirm":"common.collect.button")},"LoaderButton-animation-ClaimFeeModal-button")})]})})}export{de as ClaimFeeModal};
