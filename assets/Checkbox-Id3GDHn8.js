import{__toESM as T}from"./chunk-DgAfPHQg.js";import{require_react as N}from"./react-CNoFhWkx.js";import{AnimatePresence as q,Check as G,ThemeableStack as A,getSize as H,useControllableState as X,useLabelContext as J,usePrevious as Q,useProps as Y}from"./src-DOOtfpHS.js";import{require_jsx_runtime as Z}from"./jsx-runtime-D7bMTQeG.js";import{isTestEnv as ee}from"./hooks-BXO4d1DJ.js";import{v4_default as te}from"./v4-D6Rlvprs.js";import{Flex as M,composeEventHandlers as w,createStyledContext as oe,getConfig as D,getTokenValue as ne,getVariable as re,getVariableValue as V,isVariable as se,isWeb as E,shouldRenderNativePlatform as ie,styled as U,useComposedRefs as le,useTheme as B,withStaticProperties as de}from"./Loader-D83W8G1W.js";const ae=(t,e)=>{const o=ce(t,e);return se(o)?+o.val:o?+o:16},ce=(t,e)=>{var o;const n=ue(t,e);if(!n)return t;const d=D();return(o=d.fontsParsed[(e==null?void 0:e.font)||d.defaultFontToken])===null||o===void 0?void 0:o.size[n]},ue=(t,e)=>{var o;if(typeof t=="number")return null;const n=(e==null?void 0:e.relativeSize)||0,d=D(),f=((o=d.fontsParsed[(e==null?void 0:e.font)||d.defaultFontToken])===null||o===void 0?void 0:o.size)||d.tokensParsed.size,a=(t==="$true"&&!("$true"in f)?"$4":t)??("$true"in f?"$true":"$4"),s=Object.keys(f);let i=s.indexOf(a);i===-1&&a.endsWith(".5")&&(i=s.indexOf(a.replace(".5","")));const C=Math.min(Math.max(0,i+n),s.length-1);return s[C]??a},be=t=>{var e,o;const n=B();return t?re(t):((e=n[t])===null||e===void 0?void 0:e.get())||((o=n.color)===null||o===void 0?void 0:o.get())};var l=T(N(),1);const he=t=>{const e=be(t.color);return o=>o&&(l.isValidElement(o)?l.cloneElement(o,{...t,color:e,...o.props}):l.createElement(o,t))},P=oe({size:"$true",scaleIcon:1}),fe="CheckboxIndicator",O=U(A,{name:fe,context:P,variants:{unstyled:{false:{}}},defaultVariants:{unstyled:{}.TAMAGUI_HEADLESS==="1"}}),Ce="Checkbox",W=U(A,{name:Ce,tag:"button",context:P,variants:{unstyled:{false:{size:"$true",backgroundColor:"$background",alignItems:"center",justifyContent:"center",pressTheme:!0,focusable:!0,borderWidth:1,borderColor:"$borderColor",hoverStyle:{borderColor:"$borderColorHover"},focusStyle:{borderColor:"$borderColorFocus"},focusVisibleStyle:{outlineStyle:"solid",outlineWidth:2,outlineColor:"$outlineColor"}}},disabled:{true:{pointerEvents:"none",userSelect:"none",cursor:"not-allowed",hoverStyle:{borderColor:"$borderColor",backgroundColor:"$background"},pressStyle:{borderColor:"$borderColor",backgroundColor:"$background"},focusStyle:{outlineWidth:0}}},size:{"...size":t=>({borderRadius:V(H(t))/8})}},defaultVariants:{unstyled:{}.TAMAGUI_HEADLESS==="1"}});function y(t){return t==="indeterminate"}function me(t){return y(t)?"indeterminate":t?"checked":"unchecked"}var h=T(Z(),1);const pe=t=>{const{checked:e,bubbles:o=!0,control:n,isHidden:d,...f}=t,a=l.useRef(null),s=Q(e);return l.useEffect(()=>{const i=a.current,C=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(C,"checked").set;if(s!==e&&b){const r=new Event("click",{bubbles:o});i.indeterminate=y(e),b.call(i,y(e)?!1:e),i.dispatchEvent(r)}},[s,e,o]),(0,h.jsx)("input",{type:"checkbox",defaultChecked:y(e)?!1:e,...f,tabIndex:-1,ref:a,"aria-hidden":d,style:{...d?{position:"absolute",pointerEvents:"none",opacity:0,margin:0}:{appearance:"auto",accentColor:"var(--color6)"},...t.style}})};function ve(t,[e,o],n){const{labelledBy:d,name:f,required:a,disabled:s,value:i="on",onCheckedChange:C,...b}=t,[r,$]=l.useState(null),v=le(n,$),x=l.useRef(!1),m=E?r?!!r.closest("form"):!0:!1,I=J(r),k=d||I,c=t.onKeyDown,p=(0,l.useMemo)(()=>w(c,u=>{u.key==="Enter"&&u.preventDefault()}),[c]),S=(0,l.useMemo)(()=>w(t.onPress,u=>{o(z=>y(z)?!0:!z),m&&"isPropagationStopped"in u&&(x.current=u.isPropagationStopped(),x.current||u.stopPropagation())}),[m]);return{bubbleInput:E&&m?(0,h.jsx)(pe,{isHidden:!0,control:r,bubbles:!x.current,name:f,value:i,checked:e,required:a,disabled:s}):null,checkboxRef:v,checkboxProps:{role:"checkbox","aria-labelledby":k,"aria-checked":y(e)?"mixed":e,...b,...E&&{type:"button",value:i,"data-state":me(e),"data-disabled":s?"":void 0,disabled:s,onKeyDown:s?void 0:p},onPress:s?void 0:S}}}const j=l.createContext({checked:!1,disabled:!1}),R=t=>{t.context||(t.context=j)};function xe(t){const{disableActiveTheme:e,Frame:o=W,Indicator:n=O}=t;R(o),R(n);const d=o.styleable(function(a,s){const{scaleSize:i=.45,sizeAdjust:C=0,scaleIcon:b,checked:r,defaultChecked:$,onCheckedChange:v,native:x,unstyled:m=!1,...I}=a,k=Y(I),c=l.useContext(P);let p=0,S=0;m||(p=V(H(k.size??(c==null?void 0:c.size)??"$true",{shift:C})),S=i?Math.round(p*i):p);const[u=!1,z]=X({prop:r,defaultProp:$,onChange:v}),{checkboxProps:g,checkboxRef:F,bubbleInput:L}=ve(k,[u,z],s);if(ie(x)==="web")return(0,h.jsx)("input",{type:"checkbox",defaultChecked:y(u)?!1:u,tabIndex:-1,ref:F,disabled:g.disabled,style:{appearance:"auto",accentColor:"var(--color6)",...g.style}});const K=(0,l.useMemo)(()=>({checked:u,disabled:g.disabled}),[u,g.disabled]);return(0,h.jsx)(j.Provider,{value:K,children:(0,h.jsxs)(P.Provider,{size:k.size??(c==null?void 0:c.size)??"$true",scaleIcon:b??(c==null?void 0:c.scaleIcon)??1,children:[(0,h.jsx)(o,{...!m&&{width:S,height:S},tag:"button",ref:F,unstyled:m,...m===!1&&{size:S,theme:u?"active":null},checked:u,disabled:g.disabled,...g,style:g.style,children:k.children}),L]})})}),f=n.styleable((a,s)=>{const{children:i,forceMount:C,disablePassStyles:b,unstyled:r=!1,...$}=a,v=l.useContext(P);let x=i;if(!r){const I=(typeof v.size=="number"?v.size*.65:ae(v.size))*v.scaleIcon,k=B(),c=he({size:I,color:k.color});x=l.Children.toArray(i).map(p=>b||!l.isValidElement(p)?p:c(p))}const m=l.useContext(j);return C||y(m.checked)||m.checked===!0?(0,h.jsx)(n,{pointerEvents:"none",...$,ref:s,children:x}):null});return de(d,{Indicator:f})}const _=xe({Frame:W,Indicator:O});function ke(t){const e=t?ne(t):20;return{FocusRing:Math.round(e*1.3),CheckboxButton:e,CheckSizeDefault:e-4,CheckSizePressed:e-2,UnselectedHoverIndicator:Math.round(e*.2),UnselectedPressedIndicator:Math.round(e*.3)}}const ye=ee()?void 0:{animation:"simple"};function Me({checked:t,variant:e="default",size:o="$icon.20",...n}){const[d,f]=(0,l.useState)(!1),[a,s]=(0,l.useState)(!1),[i,C]=(0,l.useState)(!1),b=ge(e,d),r=(0,l.useMemo)(()=>ke(o),[o]);return(0,h.jsx)(M,{alignItems:"center",...ye,borderColor:Se({variant:e,isFocused:a,isSelected:t,accentColor:b}),borderRadius:"$rounded6",borderWidth:"$spacing1",height:r.FocusRing,justifyContent:"center",width:r.FocusRing,testID:n.testID,children:(0,h.jsxs)(_,{...n,unstyled:!0,alignItems:"center",animation:"simple",backgroundColor:"transparent",borderColor:n.disabled?"$neutral3":t?b:"$neutral2",borderRadius:"$rounded4",borderWidth:"$spacing2",checked:t,cursor:"pointer",disabledStyle:{borderColor:"$neutral3"},height:r.CheckboxButton,hoverStyle:{borderColor:t?b:"$neutral2"},justifyContent:"center",pointerEvents:n.disabled?"none":"auto",width:r.CheckboxButton,onBlur:()=>s(!1),onFocus:()=>s(!0),onMouseDown:()=>C(!0),onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onMouseUp:()=>C(!1),children:[(0,h.jsx)(_.Indicator,{unstyled:!0,alignItems:"center",animation:"simple",backgroundColor:n.disabled?"$neutral3":b,height:r.CheckSizePressed,justifyContent:"center",width:r.CheckSizePressed,children:(0,h.jsx)(G,{color:n.disabled?"$neutral2":e==="branded"?"white":"$surface1",size:i?r.CheckSizePressed:r.CheckSizeDefault})}),!t&&(0,h.jsx)(q,{initial:!0,children:d&&!n.disabled&&(0,h.jsx)(M,{animation:"simple",backgroundColor:"$neutral2",borderRadius:"$roundedFull",enterStyle:{scale:0},exitStyle:{scale:0},height:i?r.UnselectedPressedIndicator:r.UnselectedHoverIndicator,position:"absolute",width:i?r.UnselectedPressedIndicator:r.UnselectedHoverIndicator},`UnselectedHoverIndicator-${te()}`)})]})})}function ge(t,e){return t==="branded"?e?"$accent1Hovered":"$accent1":e?"$accent3Hovered":"$accent3"}function Se({variant:t,isFocused:e,isSelected:o,accentColor:n}){return e?t==="branded"&&o?n:"$neutral3":"transparent"}export{Me as Checkbox};
